

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Footprint modelling &mdash; SUEWS v2018c documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 

  
  <script src="../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../index.html" class="icon icon-home"> SUEWS
          

          
          </a>

          
            
            
              <div class="version">
                v2018c
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../parameterisations-and-sub-models.html">2. Parameterisations and sub-models within SUEWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../prepare-to-run-the-model.html">3. Preparing to run the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../input_files/input_files.html">4. Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../output_files/output_files.html">5. Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../troubleshooting.html">6. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../recent-publications.html">7. Recent publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../suews_related_softwares.html">8. SUEWS-related Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials.html">9. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../development/development.html">10. Development, Suggestions and Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../benchmark/benchmark_report.html">Benchmark Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../version-history/version-history.html">11. Version History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../acknowledgement.html">12. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../notation.html">13. Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../references.html">14. References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">SUEWS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
      <li>Footprint modelling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../_sources/sub-tutorials/tutorials/docs/source/Tutorials/Footprint.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please report issues with the manual on the <a class="reference external" href="https://github.com/Urban-Meteorology-Reading/SUEWS-Docs/issues/new?template=issue-report.md">GitHub page</a>.</p>
</div>
<div class="section" id="footprint-modelling">
<span id="footprint"></span><h1>Footprint modelling<a class="headerlink" href="#footprint-modelling" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Each meteorological instrument has a ‘<em>source area</em>’ (sometimes
referred to as <em>footprint</em>), the area that influences the measurement.
The shape and location of that area is a function of the meteorological
variable the sensor measures and the method of operation of the sensor.</p>
<p>For turbulent heat fluxes measured with a sonic anemometer, extensive
effort has been directed to try and model the ‘probable source area
location’ (Leclerc and Foken 2014). Numerous models exist, but the
Kormann and Meixner (2001) and Kljun et al. (2015) models are used in
UMEP. Both models require input of information about the wind direction,
stability, turbulence characteristics (friction velocity, variance of
the lateral or crosswind wind velocity) and roughness parameters. Kljun
et al. (2015) requires the boundary layer height.</p>
<div class="figure" id="id1">
<a class="reference internal image-reference" href="../../../../../_images/Footprint_ReadingSourceArea.png"><img alt="Example result" src="../../../../../_images/Footprint_ReadingSourceArea.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Example result (click on image for larger image)</span></p>
</div>
</div>
<div class="section" id="initial-practical-steps">
<h2>Initial Practical steps<a class="headerlink" href="#initial-practical-steps" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>If <strong>QGIS</strong> is not on your computer you will <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/Getting_Started.html">need to install
it</a>.</li>
<li>Then install the <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/Getting_Started.html">UMEP</a> plugin.</li>
<li>Start the QGIS software</li>
<li>If not visible on the desktop use the <strong>Start</strong> button to find the
software (i.e. Find QGIS under your applications)</li>
<li>Select <strong>QGIS 2.18.x Desktop</strong> (or the latest version installed). Do not use QGIS3 at this point.</li>
</ul>
<p>When you open it on the top toolbar you will see <strong>UMEP</strong>.</p>
<div class="figure" id="id2">
<a class="reference internal image-reference" href="../../../../../_images/Footprint_UMEP_location.png"><img alt="none" src="../../../../../_images/Footprint_UMEP_location.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Location of footprint plugin (click on image for larger image)</span></p>
</div>
<ul class="simple">
<li>If UMEP is not on your machine, add the UMEP plugin by go to <em>Plugins&gt;Manage and Install Plugins</em> in QGIS
and search for UMEP. Click <strong>Install plugin</strong>. Here you can also see if there is newer versions of your added plugins.</li>
<li>Preferably, read through the section in the <a class="reference external" href="SourceArea(Point)">online manual</a>
BEFORE using the model, so you are familiar with it’s operation and terminology used.</li>
</ul>
<div class="section" id="data-for-tutorial">
<h3>Data for Tutorial<a class="headerlink" href="#data-for-tutorial" title="Permalink to this headline">¶</a></h3>
<p>Use the appropriate data:</p>
<ul class="simple">
<li>Reading: <a class="reference external" href="https://github.com/Urban-Meteorology-Reading/Urban-Meteorology-Reading.github.io/tree/master/other%20files/DataReading.zip">download</a></li>
<li>London: <a class="reference external" href="https://github.com/Urban-Meteorology-Reading/Urban-Meteorology-Reading.github.io/tree/master/other%20files/DataSmallAreaLondon.zip">download</a></li>
</ul>
</div>
<div class="section" id="prior-to-starting">
<h3>Prior to Starting<a class="headerlink" href="#prior-to-starting" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Download the <strong>Data needed for the Tutorial</strong>. You can use either Reading of the London dataset.</li>
<li>Load the Raster data (<a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/Abbreviations.html">DEM, DSM,
CDSM</a>)
<em>files – DOES A CDSM EXIST? Yes for London, No for Reading</em><ul>
<li>Go to: <em>Layer &gt; Add layer &gt; Add Raster Layer</em>. Locate downloaded files add add them to your QGIS project.</li>
</ul>
</li>
</ol>
<div class="figure" id="id3">
<a class="reference internal image-reference" href="../../../../../_images/Footprint_Add_Raster_Layer.png"><img alt="none" src="../../../../../_images/Footprint_Add_Raster_Layer.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Loading a raster layer to QGIS (click on image for larger image)</span></p>
</div>
<ul class="simple">
<li>Have a look at the <strong>layers</strong> (see lower left) - if you untick the
box layer names from the top you can see the different layers.</li>
</ul>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="../../../../../_images/Footprint_ReadingMap.png"><img alt="none" src="../../../../../_images/Footprint_ReadingMap.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">The Reading data loaded into QGIS (click on image for larger image)</span></p>
</div>
</div>
</div>
<div class="section" id="source-area-modelling">
<h2>Source Area Modelling<a class="headerlink" href="#source-area-modelling" title="Permalink to this headline">¶</a></h2>
<p>To access the Source area model or Footprint model, go to <em>UMEP -&gt; Pre-processor &gt; Urban Morphology &gt; Source Area Model (Point)</em>.</p>
<ol class="arabic">
<li><p class="first">Click on Select Point on Canvas – then select a point (e.g. where an Eddy Covariance (EC) tower site is located)</p>
</li>
<li><p class="first">Select the appropriate surface elevation data file names</p>
</li>
<li><p class="first">Choose the model you wish to run (Kormann and Meixner 2001 or Kljun et al. 2015)</p>
</li>
<li><p class="first">Some initial parameters values are given - think about what would be appropriate values for your site and period   of interest. The manual has   more information (e.g. definitions) of the input variables.</p>
<blockquote>
<div><ul class="simple">
<li>The values are dependent on the meteorological conditions and the surface surrounding the site. The former   obviously vary on an hour to hour basis (or shorter time periods), whereas the others are dependent on the wind direction and the fetch characteristics.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Add a prefix and an output folder.</p>
</li>
<li><p class="first">Tick “add the integrated source area to your project”. This will provide visual information of the location of the source area (footprint)</p>
</li>
<li><p class="first">Click <strong>Run</strong>. If you get an error/warning message (model is unable to execute your request, as the maximum fetch exceeds the extent of your grid for your point of interest. measure the distance to the limit of your raster maps</p>
<blockquote>
<div><ul class="simple">
<li>To allow the model to work for the dataset with your point of interest you need to adjust the maximum fetch distance.</li>
<li>Locate the Measure tool.</li>
<li>Measure the distance to the point of interest to the boundary of the DSM data set.</li>
<li>Adjust the maximum fetch.</li>
<li>Click Run and wait for the calculations to finish.</li>
</ul>
</div></blockquote>
</li>
</ol>
<div class="figure" id="id5">
<a class="reference internal image-reference" href="../../../../../_images/Footprint_SourceAreaModel.png"><img alt="none" src="../../../../../_images/Footprint_SourceAreaModel.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Snapshot of the Footprint plugin using Reading data (click on image for larger image)</span></p>
</div>
<p>The <strong>output is a source area</strong> grid showing the cumulative percentage of source area influencing the flux at the point of interest.</p>
<ul class="simple">
<li>To display the legend correctly in the layer window: Double-click on the source area grid and then click OK without doing any changes. The source area display is showing up to 98% of the cumulative area.</li>
<li>Other output: A text file giving both the input setting variables and the output morphometric parameters calculated based on the source area generated. More information is provided in the manual, row titled: “Output”</li>
</ul>
<p>It is possible to input a text file to generate a source area based on morphometric parameters (e.g. an hourly dataset). However, for now you can moodify the input variables set in the interface. Format of file is given in the manual.</p>
</div>
<div class="section" id="iterative-process">
<h2>Iterative process<a class="headerlink" href="#iterative-process" title="Permalink to this headline">¶</a></h2>
<p>To work with a site with no value known <em>a priori</em>.</p>
<ol class="arabic simple">
<li>Use the <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/pre-processor/Urban%20Morphology%20Morphometric%20Calculator%20(Point).html">MorphometricCalculator(Point)</a> tool in the UMEP plugin to select a
point to get the initial parameter values:<ol class="arabic">
<li>UMEP-&gt; Pre-Processor -&gt; Urban Morphology -&gt; Image Morphometric
Calculator (Point)</li>
<li>Open the output files</li>
</ol>
</li>
<li><strong>Anisotropic</strong> file – has the values in, e.g., 5 degree <strong>sectors</strong>
– i.e. what you selected. This is appropriate if the area is very
inhomogeneous.</li>
<li><strong>Isotropic</strong> file - has the <strong>average value</strong> for the area</li>
<li>Use these values to populate the source area model window.</li>
</ol>
<div class="section" id="roughness-parameters">
<h3>Roughness parameters<a class="headerlink" href="#roughness-parameters" title="Permalink to this headline">¶</a></h3>
<p>In the UMEP plugin the roughness length and zero plane displacement
length can be calculated with a morphometric method based on the Rule of
Thumb (Grimmond and Oke 1999) as the default. There are other methods
available: Bottema (1995), Kanda et al. (2013), Macdonald et al. (1998),
Millward-Hopkins et al. (2011) and Raupach (1994, 1995). Many of these
have been developed for urban roughness elements. The Raupach method was
originally intended for forested areas but has also been found to
perform well for urban areas.</p>
<p>With wind profile and eddy covariance anemometric data and the source
area model, appropriate parameters can be determined and morphometric
methods assessed (e.g. Kent et al. 2017).</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Bottema M 1995: Parameterisation of aerodynamic roughness parameters
in relation to air pollutant removal ef?ciency of streets. Air
Pollution Engineering and Management, H. Power et al., Eds.,
Computational Mechanics, 235–242.</li>
<li>Grimmond CSB and TR Oke 1999: Aerodynamic properties of urban areas
derived, from analysis of surface form. <a class="reference external" href="http://journals.ametsoc.org/doi/full/10.1175/1520-0450%281999%29038%3C1262%3AAPOUAD%3E2.0.CO%3B2">Journal of Applied
Climatology 38:9,
1262-1292</a></li>
<li>Kanda M, Inagaki A, Miyamoto T, Gryschka M, Raasch S 2013: A new
aerodynamic parameterization for real urban surfaces. <a class="reference external" href="http://link.springer.com/article/10.1007/s10546-013-9818-x?no-access=true">Boundary-
Layer Meteorol 148:357–377.
doi:10.1007/s10546-013-9818-x</a></li>
<li>Kent CW, Grimmond CSB, Barlow J, Gatey D, Kotthaus S, Lindberg F,
Halios CH 2017: Evaluation of Urban Local-Scale Aerodynamic
Parameters: Implications for the Vertical Profile of Wind Speed and
for Source Areas. Boundary-Layer Meteorol 164:183-213.</li>
<li>Kljun N, Calanca P, Rotach MW, Schmid HP 2015: A simple
two-dimensional parameterisation for Flux Footprint Prediction (FFP).
<a class="reference external" href="http://www.geosci-model-dev.net/8/3695/2015/">Geoscientific Model
Development.8(11):3695-713.</a></li>
<li>Kormann R, Meixner FX 2001: An analytical footprint model for
non-neutral stratification. Bound.-Layer Meteorol., 99, 207–224
<a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S2212095513000497#b0145">http://www.sciencedirect.com/science/article/pii/S2212095513000497#b0145</a></li>
<li>Kotthaus S and Grimmond CSB 2014: Energy exchange in a dense urban
environment – Part II: Impact of spatial heterogeneity of the
surface. Urban Climate 10, 281–307
<a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S2212095513000497">http://www.sciencedirect.com/science/article/pii/S2212095513000497</a></li>
<li>Leclerc MY and Foken TK 2014: Footprints in Micrometeorology and
Ecology. <a class="reference external" href="http://www.springer.com/us/book/9783642545443">Springer, xix, 239 p.
E-book</a></li>
<li>Macdonald, R. W., R. F. Griffiths, and D. J. Hall, 1998: An improved
method for estimation of surface roughness of obstacle arrays.
<a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S1352231097004032">Atmos. Environ., 32,
1857–1864</a></li>
<li>Millward-Hopkins JT, Tomlin AS, Ma L, Ingham D, Pourkashanian M 2011:
Estimating aerodynamic parameters of urban-like surfaces with
heterogeneous building heights. <a class="reference external" href="http://link.springer.com/article/10.1007%2Fs10546-011-9640-2">Boundary-Layer Meteorol 141:443–465.
doi:10.1007/s10546-011-9640-2</a></li>
<li>Raupach MR 1994: Simpli?ed expressions for vegetation roughness
length and zero-plane displacement as functions of canopy height and
area index. <a class="reference external" href="http://link.springer.com/article/10.1007%2FBF00709229">Bound.-Layer Meteor., 71, 211–216.
doi:10.1007/BF0070922</a></li>
<li>Raupach MR 1995: Corrigenda. <a class="reference external" href="http://link.springer.com/article/10.1007/BF00709356">Bound.-Layer Meteor., 76,
303–304.</a></li>
</ul>
<div class="section" id="contributors-to-the-material-covered">
<h3>Contributors to the material covered<a class="headerlink" href="#contributors-to-the-material-covered" title="Permalink to this headline">¶</a></h3>
<p><strong>University of Reading:</strong> Christoph Kent, Simone Kotthaus, Sue Grimmond
<strong>University of Gothenburg:</strong> Fredrik Lindberg Background work also
comes from: UBC (Andreas Christen); Germany: Kormann and Meixner (2001);
Japan: Kanda et al. (2013); UK: Millward-Hopkins et al. (2011),
Macdonald et al. (1998); Australia: Raupach (1994, 1995); Netherlands:
Bottema (1995)</p>
<p>Authors of this document: Kent, Grimmond (2016). Lindberg</p>
<p><a class="reference external" href="https://bitbucket.org/fredrik_ucg/umep/">UMEP Repository</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018 – 2019, micromet@University of Reading, led by Prof Sue Grimmond

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>