

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9.3. Urban Energy Balance - SUEWS Spatial &mdash; SUEWS v2018c documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="9.4. Urban Energy Balance - SUEWS and WUDAPT" href="SuewsWUDAPT.html" />
    <link rel="prev" title="9.2. Urban Energy Balance - SUEWS Advanced" href="SuewsAdvanced.html" /> 

  
  <script src="../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../index.html" class="icon icon-home"> SUEWS
          

          
          </a>

          
            
            
              <div class="version">
                v2018c
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../parameterisations-and-sub-models.html">2. Parameterisations and sub-models within SUEWS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../prepare-to-run-the-model.html">3. Preparing to run the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../input_files/input_files.html">4. Input files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../output_files/output_files.html">5. Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../troubleshooting.html">6. Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../recent-publications.html">7. Recent publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../suews_related_softwares.html">8. SUEWS-related Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials.html">9. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../development/development.html">10. Development, Suggestions and Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../benchmark/benchmark_report.html">Benchmark Report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../version-history/version-history.html">11. Version History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../acknowledgement.html">12. Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../notation.html">13. Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../references.html">14. References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">SUEWS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../tutorials.html">9. Tutorials</a> &raquo;</li>
        
      <li>9.3. Urban Energy Balance - SUEWS Spatial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../_sources/sub-tutorials/tutorials/docs/source/Tutorials/SuewsSpatial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please report issues with the manual on the <a class="reference external" href="https://github.com/Urban-Meteorology-Reading/SUEWS-Docs/issues/new?template=issue-report.md">GitHub page</a>.</p>
</div>
<div class="section" id="urban-energy-balance-suews-spatial">
<span id="suewsspatial"></span><h1>9.3. Urban Energy Balance - SUEWS Spatial<a class="headerlink" href="#urban-energy-balance-suews-spatial" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>9.3.1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial you will generate input data for the
<a class="reference external" href="http://suews-docs.readthedocs.io">SUEWS</a> model and simulate spatial
(and temporal) variations of energy exchanges within a small area on Manhattan
(New York City) with regards to a heat wave event.</p>
<p>Tools such as this, once appropriately assessed for an area, can be used
for a broad range of applications. For example, for climate services
(e.g. <a class="reference external" href="http://www.wmo.int/gfcs/">http://www.wmo.int/gfcs/</a> , <a class="reference external" href="https://doi.org/10.1016/j.uclim.2017.05.004">Baklanov et al. 2018</a>). Running a model can allow analyses,
assessments, and long-term projections and scenarios. Most applications
require not only meteorological data but also information about the
activities that occur in the area of interest (e.g. agriculture,
population, road and infrastructure, and socio-economic variables).</p>
<p>This tutorial makes use of local high resolution detailed spatial data. If this kind of data are unavailable, other datasets such as local climate zones (LCZ) from the <a class="reference external" href="http://www.wudapt.org/">WUDAPT</a> database could be used. The tutorial <a class="reference internal" href="SuewsWUDAPT.html#suewswudapt"><span class="std std-ref">Urban Energy Balance - SUEWS and WUDAPT</span></a> is available if you want to know more about using LCZs in SUEWS. However, it is strongly recommended to go through this tutorial before moving on to the WUDAPT/SUEWS tutorial.</p>
<p>Model output may be needed in many formats depending on a users’ needs.
Thus, the format must be useful, while ensuring the science included
within the model is appropriate. <a class="reference internal" href="#ref-f1"><span class="std std-numref">Fig. 9.13</span></a> shows the overall structure of
<a class="reference external" href="http://umep-docs.readthedocs.io">UMEP</a>, a city based climate service tool (CBCST) used in this tutorial. Within UMEP there are a number
of models which can predict and diagnose a range of meteorological processes.</p>
<div class="figure" id="id1">
<span id="ref-f1"></span><img alt="../../../../../_images/SUEWSIntro_UMEP_overview.png" src="../../../../../_images/SUEWSIntro_UMEP_overview.png" />
<p class="caption"><span class="caption-number">Fig. 9.13 </span><span class="caption-text">Overview of the climate service tool UMEP (from Lindberg et al. 2018)</span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This tutorial is currently designed to work with QGIS 2.18. It is recommended that you have a look at the tutorials <a class="reference internal" href="IntroductionToSuews.html#introductiontosuews"><span class="std std-ref">Urban Energy Balance - SUEWS Introduction</span></a> and <a class="reference internal" href="SuewsAdvanced.html#suewsadvanced"><span class="std std-ref">Urban Energy Balance - SUEWS Advanced</span></a> before you go through this tutorial.</p>
</div>
</div>
<div class="section" id="objectives">
<h2>9.3.2. Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h2>
<p>To perform and analyse energy exchanges within a small area on Manhattan, NYC.</p>
<div class="section" id="steps-to-be-preformed">
<h3>9.3.2.1. Steps to be preformed<a class="headerlink" href="#steps-to-be-preformed" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Pre-process the data and create input datasets for the SUEWS model</li>
<li>Run the model</li>
<li>Analyse the results</li>
<li>Perform simple mitigation measures to see how it affects the model results (optional)</li>
</ol>
</div>
</div>
<div class="section" id="initial-steps">
<h2>9.3.3. Initial Steps<a class="headerlink" href="#initial-steps" title="Permalink to this headline">¶</a></h2>
<p>UMEP is a Python plugin used in conjunction with
<a class="reference external" href="http://www.qgis.org">QGIS</a>. To install the software and the UMEP
plugin see the <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/Getting_Started.html">getting started</a> section in the UMEP manual.</p>
<p>As UMEP is under development, some documentation may be missing and/or
there may be instability. Please report any issues or suggestions to our
<a class="reference external" href="https://bitbucket.org/fredrik_ucg/umep/">repository</a>.</p>
<div class="section" id="loading-and-analyzing-the-spatial-data">
<h3>9.3.3.1. Loading and analyzing the spatial data<a class="headerlink" href="#loading-and-analyzing-the-spatial-data" title="Permalink to this headline">¶</a></h3>
<p>All the geodata used in this tutorial are from open access sources, primarily from the New York City. Information about the data are found in the table below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can download the all the data from <a class="reference external" href="https://github.com/Urban-Meteorology-Reading/Urban-Meteorology-Reading.github.io/blob/master/other%20files/SUEWSSpatial_Tutorialdata.zip">here</a>. Unzip and place in a folder that you have read and write access to.</p>
</div>
<span id="ref-t-data"></span><table border="1" class="colwidths-given docutils" id="id2">
<caption><span class="caption-number">Table 9.1 </span><span class="caption-text">Spatial data used in this tutorial</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="40%" />
<col width="40%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Geodata</strong></td>
<td><strong>Year</strong></td>
<td><strong>Source</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td>Digital surface model (<a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/Abbreviations.html">DSM</a>)</td>
<td>2013 (Lidar), 2016 (building polygons)</td>
<td>United States Geological Survey (USGS). New York CMGP Sandy 0.7m NPS Lidar and NYC Open Data Portal. <a class="reference external" href="https://data.cityofnewyork.us">link</a></td>
<td>A <a class="reference external" href="http://desktop.arcgis.com/en/arcmap/10.3/manage-data/raster-and-images/what-is-raster-data.htm">raster</a> grid including both buildings and ground given in meter above sea level.</td>
</tr>
<tr class="row-odd"><td>Digital elevation model (<a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/Abbreviations.html">DEM</a>)</td>
<td>2013</td>
<td>United States Geological Survey (USGS). New York CMGP Sandy 0.7m NPS Lidar. <a class="reference external" href="https://data.cityofnewyork.us">link</a></td>
<td>A raster grid including only ground heights given in meter above sea level.</td>
</tr>
<tr class="row-even"><td>Digital canopy model (<a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/Abbreviations.html">CDSM</a>)</td>
<td>2013 (August)</td>
<td>United States Geological Survey (USGS). New York CMGP Sandy 0.7m NPS Lidar. <a class="reference external" href="https://coast.noaa.gov/htdata/lidar1_z/geoid12b/data/4920/">link</a></td>
<td>A vegetation raster grid where vegetation heights is given in meter above ground level. Vegetation lower than 2.5 meter pixels with no vegetation should be zero.</td>
</tr>
<tr class="row-odd"><td>Land cover (UMEP formatted)</td>
<td>2010</td>
<td>New York City Landcover 2010 (3ft version). University of Vermont Spatial Analysis Laboratory and New York City Urban Field Station. <a class="reference external" href="https://opendata.cityofnewyork.us/">link</a></td>
<td>A raster grid including: 1. Paved surfaces, 2. Building surfaces, 3. Evergreen trees and shrubs, 4. Deciduous trees and shrubs, 5. Grass surfaces, 6. Bare soil, 7. Open water</td>
</tr>
<tr class="row-even"><td>Population density (residential)</td>
<td>2010</td>
<td>2010 NYC Population by Census Tracts, Department of City Planning (DCP). <a class="reference external" href="https://data.cityofnewyork.us">link</a>)</td>
<td>People per census tract converted to pp/ha. Converted from vector to raster.</td>
</tr>
<tr class="row-odd"><td>Land use</td>
<td>2018</td>
<td>NYC Department of City Planning, Technical Review Division. <a class="reference external" href="https://zola.planning.nyc.gov">link</a></td>
<td>Used to redistribute population during daytime (see text). Converted from vector to raster</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Start by loading all the raster datasets into an empty QGIS project.</li>
</ul>
<p>The order in the <em>Layers Panel</em> determines what layer is visible. You can choose to show a layer (or not) with the tick box. You can modify layers by right-clicking on a layer in the Layers Panel and choose <em>Properties</em>. Note for example that that CDSM (vegetation) is given as height above ground (meter) and that all non-vegetated pixels are set to zero. This makes it hard to get an overview of all 3D objects (buildings and trees). QGIS default styling for a raster is using the 98 percentile of the values. Therefore, not all the range of the data is shown in the layer window to the left.</p>
<ul class="simple">
<li>Right-click on your <strong>CDSM</strong> layer and go to <em>Properties &gt; Style</em> and choose <strong>Singleband pseudocolor</strong> with a min value of 0 and max of 35. Choose a colour scheme of your liking.</li>
<li>Go to <em>Transparency</em> and add an additional no data value of 0. Click ok.</li>
<li>Now put your <strong>CDSM</strong> layer at the top and your <strong>DSM</strong> layer second in your <em>Layers Panel</em>. Now you can see both buildings and vegetation 3D object in your map canvas.</li>
</ul>
<div class="figure" id="id3">
<a class="reference internal image-reference" href="../../../../../_images/SUEWSSpatial_dataview.png"><img alt="none" src="../../../../../_images/SUEWSSpatial_dataview.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.14 </span><span class="caption-text">DSM and CDSM visible at the same time (click for larger image)</span></p>
</div>
<p>The land cover grid comes with a specific QGIS style file.</p>
<ul class="simple">
<li>Right-click on the land cover layer (<strong>landcover_2010_nyc</strong>) and choose <em>Properties</em>. Down to the left you see a <em>Style</em>-button. Choose <em>Load Style</em> and open <strong>landcoverstyle.qml</strong> and click OK.</li>
<li>Make only your land cover class layer visible to examine the spatial variability of the different land cover classes.</li>
</ul>
<p>The land cover grid has already been classified into the seven different classes used in most UMEP applications (see <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/pre-processor/Urban%20Land%20Cover%20Land%20Cover%20Reclassifier.html">Land Cover Reclassifier</a>). If you have a land cover dataset that is not UMEP formatted you can use the <em>Land Cover Reclassifier</em> found at <em>UMEP &gt; Pre-processor &gt; Urban Land Cover &gt; Land Cover Reclassifier</em> in the menubar to reclassify your data.</p>
<p>Furthermore, a polygon grid (500 m x 500 m) to define the study area and individual grids is included (Grid_500m.shp). Such a grid can be produced directly in QGIS (e.g. <em>Vector &gt; Research Tools &gt; Vector Grid</em>) or an external grid can be used.</p>
<ul class="simple">
<li>Load the vector layer <strong>Grid_500m.shp</strong> into your QGIS project.</li>
<li>In the <em>Style</em> tab in layer <em>Properties</em>, choose a <em>Simple fill</em> with a <em>No Brush</em> fill style to be able to see the spatial data within each grid.</li>
<li>Also, add the label IDs for the grid to the map canvas in <em>Properties &gt; Labels</em> to make it easier to identify the different grid squares later on in this tutorial.</li>
</ul>
<p>As you can see the grid does not cover the whole extent of the raster grids. This is to reduce computation time during the tutorial. One grid cell takes ~20 s to model with SUEWS with meteorological forcing data for a full year.</p>
</div>
<div class="section" id="meteorological-forcing-data">
<h3>9.3.3.2. Meteorological forcing data<a class="headerlink" href="#meteorological-forcing-data" title="Permalink to this headline">¶</a></h3>
<p>Meteorological forcing data are mandatory for most of the models within UMEP. The UMEP specific format is given in <a class="reference internal" href="#ref-t-met"><span class="std std-numref">Table 9.2</span></a>. Some of the variables are optional and if not available or needed should be set to -999. The columns can not be empty.  The needed data for this tutorial are discussed below.</p>
<span id="ref-t-met"></span><table border="1" class="colwidths-given docutils" id="id4">
<caption><span class="caption-number">Table 9.2 </span><span class="caption-text">Variables included in UMEP meteorological input file.</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="3%" />
<col width="6%" />
<col width="25%" />
<col width="18%" />
<col width="48%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">No.</th>
<th class="head">Header</th>
<th class="head">Description</th>
<th class="head">Accepted  range</th>
<th class="head">Comments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>iy</td>
<td>Year [YYYY]</td>
<td>Not applicable</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>id</td>
<td>Day of year [DOY]</td>
<td>1 to 365 (366 if leap year)</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>3</td>
<td>it</td>
<td>Hour [H]</td>
<td>0 to 23</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>imin</td>
<td>Minute [M]</td>
<td>0 to 59</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>5</td>
<td>qn</td>
<td>Net all-wave radiation [W m<sup>-2</sup>]</td>
<td>-200 to 800</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>qh</td>
<td>Sensible heat flux [W m<sup>-2</sup>]</td>
<td>-200 to 750</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>7</td>
<td>qe</td>
<td>Latent heat flux [W m<sup>-2</sup>]</td>
<td>-100 to 650</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>qs</td>
<td>Storage heat flux [W m<sup>-2</sup>]</td>
<td>-200 to 650</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>9</td>
<td>qf</td>
<td>Anthropogenic heat flux [W m<sup>-2</sup>]</td>
<td>0 to 1500</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>10</td>
<td>U</td>
<td>Wind speed [m s<sup>-1</sup>]</td>
<td>0.001 to 60</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>11</td>
<td>RH</td>
<td>Relative Humidity [%]</td>
<td>5 to 100</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>12</td>
<td>Tair</td>
<td>Air temperature [°C]</td>
<td>-30 to 55</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>13</td>
<td>pres</td>
<td>Surface barometric pressure [kPa]</td>
<td>90 to 107</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>14</td>
<td>rain</td>
<td>Rainfall [mm]</td>
<td>0 to 30</td>
<td>(per 5 min) this should be scaled based on time step used</td>
</tr>
<tr class="row-even"><td>15</td>
<td>kdown</td>
<td>Incoming shortwave radiation [W m<sup>-2</sup>]</td>
<td>0 to 1200</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>16</td>
<td>snow</td>
<td>Snow [mm]</td>
<td>0 to 300</td>
<td>(per 5 min) this should be scaled based on time step used</td>
</tr>
<tr class="row-even"><td>17</td>
<td>ldown</td>
<td>Incoming longwave radiation [W m<sup>-2</sup>]</td>
<td>100 to 600</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>18</td>
<td>fcld</td>
<td>Cloud fraction [tenths]</td>
<td>0 to 1</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>19</td>
<td>wuh</td>
<td>External water use [m<sup>3</sup>]</td>
<td>0 to 10</td>
<td>(per 5 min) scale based on time step being used</td>
</tr>
<tr class="row-odd"><td>20</td>
<td>xsmd</td>
<td>(Observed) soil moisture</td>
<td>0.01 to 0.5</td>
<td>[m<sup>3</sup> m<sup>-3</sup> or kg kg<sup>-1</sup>]</td>
</tr>
<tr class="row-even"><td>21</td>
<td>lai</td>
<td>(Observed) leaf area index [m<sup>2</sup> m<sup>-2</sup>]</td>
<td>0 to 15</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>22</td>
<td>kdiff</td>
<td>Diffuse shortwave radiation [W m<sup>-2</sup>]</td>
<td>0 to 600</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>23</td>
<td>kdir</td>
<td>Direct shortwave radiation [W m<sup>-2</sup>]</td>
<td>0 to 1200</td>
<td>Should be perpendicular to the Sun beam. One way to check this is to compare direct and global radiation and see if kdir is higher than global radiation during clear weather. Then kdir is measured perpendicular to the solar beam.</td>
</tr>
<tr class="row-odd"><td>24</td>
<td>wdir</td>
<td>Wind direction [°]</td>
<td>0 to 360</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>The meteorological dataset used in this tutorial (<strong>MeteorologicalData_NYC_2010.txt</strong>) is from NOAA (most of the meteorological variables) and NREL (solar radiation data). It consists of <em>tab-separated</em> hourly air temperature, relative humidity, incoming shortwave radiation, pressure, precipitation and wind speed for 2010. There are other possibilities within UMEP to acquire meteorological forcing data. The pre-processor plugin <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/pre-processor/Meteorological%20Data%20Download%20data%20(WATCH).html">WATCH</a> can be used to download the variables needed from the global <a class="reference external" href="http://www.eu-watch.org/">WATCH</a> forcing datasets (Weedon et al. 2011, 2014).</p>
<ul class="simple">
<li>Open the meteorological dataset (<strong>MeteorologicalData_NYC_2010.txt</strong>) in a text editor of your choice. As you can see it does not include all the variables shown in <a class="reference internal" href="#ref-t-met"><span class="std std-numref">Table 9.2</span></a>. However, these variables are the mandatory ones that are required to run SUEWS. In order to format (and make a quality check) the data provided into UMEP standard, you will use the <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/pre-processor/Meteorological%20Data%20MetPreprocessor.html">MetPreProcessor</a>.</li>
<li>Open MetDataPreprocessor (<em>UMEP&gt; Pre-Processor -&gt; Meteorological Data &gt; Prepare existing data</em>).</li>
<li>Load <strong>MeteorologicalData_NYC_2010.txt</strong> and make the settings as shown below. Name your new dataset <strong>NYC_metdata_UMEPformatted.txt</strong>.</li>
</ul>
<div class="figure" id="id5">
<a class="reference internal image-reference" href="../../../../../_images/SUEWSSpatial_MetPreprocessor.png"><img alt="none" src="../../../../../_images/SUEWSSpatial_MetPreprocessor.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.15 </span><span class="caption-text">The settings for formatting met data into UMEP format (click for a larger image)</span></p>
</div>
<ul class="simple">
<li>Close the Metdata preprocessor and open your newly fomatted datset in a text editor of your choice. Now you see that the forcing data is structured into the UMEP pre-defined format.</li>
<li>Close your text file and move on to the next section of this tutorial.</li>
</ul>
</div>
</div>
<div class="section" id="preparing-input-data-for-the-suews-model">
<h2>9.3.4. Preparing input data for the SUEWS model<a class="headerlink" href="#preparing-input-data-for-the-suews-model" title="Permalink to this headline">¶</a></h2>
<p>A key capability of UMEP is to facilitate preparation of input data for the various models. SUEWS requires input information to model the urban energy balance. The plugin <em>SUEWS Prepare</em> is for this purpose. This tutorial makes use of high resolution data but <a class="reference external" href="http://www.wudapt.org/">WUDAPT</a> datasets in-conjuction with the <em>LCZ Converter</em> can be used (<em>UMEP &gt; Pre-Processor &gt; Spatial data &gt; LCZ Converter</em>).</p>
<ul class="simple">
<li>Open SUEWS Prepare (<em>UMEP &gt; Pre-Processor &gt; SUEWS prepare</em>).</li>
</ul>
<div class="figure" id="id6">
<a class="reference internal image-reference" href="../../../../../_images/SUEWSSpatial_Prepare1.png"><img alt="none" src="../../../../../_images/SUEWSSpatial_Prepare1.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.16 </span><span class="caption-text">The dialog for the SUEWS Prepare plugin (click for a larger image).</span></p>
</div>
<p>Here you can see the various settings that can be modified. You will focus on the <em>Main Settings</em> tab where the mandatory settings are chosen. The other tabs include the settings for e.g. different land cover classes, human activities etc.</p>
<p>There are 10 frames included in the <em>Main Settings</em> tab where 8 need to be filled in for this tutorial:</p>
<ol class="arabic simple">
<li><strong>Polygon grid</strong></li>
<li><strong>Building morphology</strong></li>
<li><strong>Tree morphology</strong></li>
<li><strong>Land cover fractions</strong></li>
<li><strong>Meteorological data</strong></li>
<li><strong>Population density</strong></li>
<li><strong>Daylight savings and UTC</strong></li>
<li><strong>Initial conditions</strong></li>
</ol>
<p>The two optional frames (<em>Land use fractions</em> and <em>Wall area</em>) should be used if the ESTM model is used to estimate the storage energy term (Delta Q<sub>S</sub>). In this tutorial we use the <em>OHM</em> modelling scheme so these two tabs can be ignored for now.</p>
<ul class="simple">
<li>Close <em>SUEWS Prepare</em></li>
</ul>
<div class="section" id="building-morphology">
<h3>9.3.4.1. Building morphology<a class="headerlink" href="#building-morphology" title="Permalink to this headline">¶</a></h3>
<p>First you will calculate roughness parameters based on the building geometry within your grids.</p>
<ul class="simple">
<li>Open <em>UMEP &gt; Pre-Processor &gt; Urban Morphology &gt; Morphometric Calculator (Grid)</em>.</li>
<li>Use the settings as in the figure below and press <em>Run</em>.</li>
<li>When calculation ids done, close the plugin.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For mac users, use this workaround: manually create a directory, go into the folder above and type the folder name. It will give a warning <em>“—folder name–” already exists. Do you want to replace it?</em> Click <em>replace</em>.</p>
</div>
<div class="figure" id="id7">
<img alt="none" src="../../../../../_images/SUEWSSpatial_IMCGBuilding.png" />
<p class="caption"><span class="caption-number">Fig. 9.17 </span><span class="caption-text">The settings for calculating building morphology.</span></p>
</div>
<p>This operation should have produced 17 different text files; 16 (<em>anisotrophic</em>) that include morphometric parameters from each 5 degree section for each grid and one file (<em>isotropic</em>) that includes averaged values for each of the 16 grids. You can open <strong>build_IMPGrid_isotropic.txt</strong> and compare the different values for a park grid (3054) and an urban grid (3242). Header abbreviations are explained <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/Abbreviations.html">here</a>.</p>
</div>
<div class="section" id="tree-morphology">
<h3>9.3.4.2. Tree morphology<a class="headerlink" href="#tree-morphology" title="Permalink to this headline">¶</a></h3>
<p>Now you will calculate roughness parameters based on the vegetation (trees and bushes) within your grids. As you noticed there is only one surface dataset for vegetation present (<strong>CDSM_nyc</strong>) and if you examine your land cover grid (<strong>landcover_2010_nyc</strong>) you can see that there is only one class of high vegetation (<em>Deciduous trees</em>) present with our model domain. Therefore, you will not separate between evergreen and deciduous vegetation in this tutorial. As shown in  <a class="reference internal" href="#ref-t-data"><span class="std std-numref">Table 9.1</span></a>, the tree surface model represents height above ground.</p>
<ul class="simple">
<li>Again, Open <em>UMEP &gt; Pre-Processor &gt; Urban Morphology &gt; Morphometric Calculator (Grid)</em>.</li>
<li>Use the settings as in the figure below and press <em>Run</em>.</li>
<li>When calculation is done, close the plugin.</li>
</ul>
<div class="figure" id="id8">
<img alt="../../../../../_images/SUEWSSpatial_IMCGVeg.png" src="../../../../../_images/SUEWSSpatial_IMCGVeg.png" />
<p class="caption"><span class="caption-number">Fig. 9.18 </span><span class="caption-text">The settings for calculating vegetation morphology.</span></p>
</div>
</div>
<div class="section" id="land-cover-fractions">
<h3>9.3.4.3. Land cover fractions<a class="headerlink" href="#land-cover-fractions" title="Permalink to this headline">¶</a></h3>
<p>Moving on to land cover fraction calculations for each grid.</p>
<ul class="simple">
<li>Open <em>UMEP &gt; Pre-Processor &gt; Urban Land Cover &gt; Land Cover Fraction (Grid)</em>.</li>
<li>Use the settings as in the figure below and press <em>Run</em>.</li>
<li>When calculation is done, close the plugin.</li>
</ul>
<div class="figure" id="id9">
<img alt="../../../../../_images/SUEWSSpatial_LCF.png" src="../../../../../_images/SUEWSSpatial_LCF.png" />
<p class="caption"><span class="caption-number">Fig. 9.19 </span><span class="caption-text">The settings for calculating land cover fractions</span></p>
</div>
</div>
<div class="section" id="population-density">
<h3>9.3.4.4. Population density<a class="headerlink" href="#population-density" title="Permalink to this headline">¶</a></h3>
<p>Population density will be used to estimate the anthropogenic heat release (Q<sub>F</sub>) in SUEWS. There is a possibility to use both night-time and daytime population densities to make the model more dynamic. You have two different raster grids for night-time (<strong>pop_nighttime_perha</strong>) and daytime (<strong>pop_daytime_perha</strong>), respectively. This time you will make use of QGIS built-in function to to acquire the population density for each grid.</p>
<ul class="simple">
<li>Go to <em>Plugins &gt; Manage and Install Plugins</em> and make sure that the <em>Zonal statistics plugin</em> is ticked. This is a build-in plugin which comes with the QGIS installation.</li>
<li>Close the <em>Plugin manager</em> and open <em>Raster &gt; Zonal Statistics &gt; Zonal Statistics</em>.</li>
<li>Choose your <strong>pop_daytime_perha</strong> layer as <strong>Raster layer</strong> and your <strong>Grid_500m</strong> and polygon layer. Use a <em>Output column prefix</em> of <strong>PPday</strong> and chose only to calculate <em>Mean</em>. Click OK.</li>
<li>Run the tool again but this time use the night-time dataset.</li>
</ul>
</div>
<div class="section" id="suews-prepare">
<h3>9.3.4.5. SUEWS Prepare<a class="headerlink" href="#suews-prepare" title="Permalink to this headline">¶</a></h3>
<p>Now you are ready to organise all the input data into the SUEWS input format.</p>
<ul class="simple">
<li>Open <em>SUEWS Prepare</em></li>
<li>In the <em>Polygon grid</em> frame, choose your polygon grid (<strong>Grid_500m</strong>) and choose <strong>id</strong> as your <em>ID field</em></li>
<li>In the <em>Building morphology</em> frame, fetch the file called <strong>build_IMPGrid_isotropic.txt</strong>.</li>
<li>In the <em>Land cover fractions</em> frame, fetch the file called <strong>lc_LCFG_isotropic.txt</strong>.</li>
<li>In the <em>Tree morphology</em> frame, fetch the file called <strong>veg_IMPGrid_isotropic.txt</strong>.</li>
<li>In the <em>Meteorological data</em> frame, fetch your UMEP formatted met forcing data text file.</li>
<li>In the <em>Population density</em> frame, choose the appropriate attributes created in the previous section for daytime and night-time population density.</li>
<li>In the <em>Daylight savings and UTC</em> frame, set start and end of the daylight saving to 87 and 304, respectively and choose <em>-5</em> (i.e. the time zone).</li>
<li>In the <em>Initial conditions</em> frame, choose <strong>Winter (0%)</strong> in the <em>Leaf Cycle</em>, 100% <em>Soil moisture state</em> and <strong>nyc</strong> as a <em>File code</em>.</li>
<li>In the <em>Anthropogenic</em> tab, change the code to 771. This will make use of settings adjusted for NYC according to <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1352231015302156">Sailor et al. 2015</a>.</li>
<li>Choose an empty directory as your <em>Output folder</em> in the main tab.</li>
<li>Press <em>Generate</em></li>
<li>When processing is finished, close <em>SUEWS Prepare</em>.</li>
</ul>
</div>
</div>
<div class="section" id="running-the-suews-model-in-umep">
<h2>9.3.5. Running the SUEWS model in UMEP<a class="headerlink" href="#running-the-suews-model-in-umep" title="Permalink to this headline">¶</a></h2>
<p>To perform modelling energy fluxes for multiple grids, <a class="reference internal" href="SuewsAdvanced.html#suewsadvanced"><span class="std std-ref">Urban Energy Balance - SUEWS Advanced</span></a> can be used.</p>
<ul class="simple">
<li>Open <em>UMEP &gt; Processor &gt; Urban Energy Balance &gt; SUEWS/BLUEWS, Advanced</em>. Here you can change some of the run control settings in SUEWS. SUEWS can also be executed outside of UMEP and QGIS (see <a class="reference external" href="http://suews-docs.readthedocs.io">SUEWS Manual</a>. This is recommended when modelling long time series (multiple years) of large model domains (many grid points).</li>
<li>Change the OHM option to [1]. This allows the anthropogenic energy to be partitioned also into the storage energy term.</li>
<li>Leave the rest of the combobox settings at the top as default and tick both the <em>Use snow module</em> and the <em>Obtain temporal resolution…</em> box.</li>
<li>Set the <em>Temporal resolution of output (minutes) to 60.</em></li>
<li>Locate the directory where you saved your output from <em>SUEWSPrepare</em> earlier and choose an output folder of your choice.</li>
<li>Also, Tick the box <em>Apply spin-up using…</em>. This will force the model to run twice using the conditions from the first run as initial conditions for the second run.</li>
<li>Click <em>Run</em>. This computation will take a while so be patient.</li>
</ul>
</div>
<div class="section" id="analysing-model-reults">
<h2>9.3.6. Analysing model reults<a class="headerlink" href="#analysing-model-reults" title="Permalink to this headline">¶</a></h2>
<p>UMEP has a tool for basic analysis of any modelling performed with the SUEWS model. The <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/post_processor/Urban%20Energy%20Balance%20SUEWS%20Analyser.html">SUEWSAnalyser</a> tool is available from the post-processing section in UMEP.</p>
<ul class="simple">
<li>Open <em>UMEP &gt; Post-Processor &gt; Urban Energy Balance &gt; SUEWS Analyzer</em>. There are two main sections in this tool. The <em>Plot data</em>-section can be used to make temporal analysis as well as making simple comparisins between two grids or variables. This <em>Spatial data</em>-section can be used to make aggregated maps of the output variables from the SUEWS model. This requires that you have loaded the same polygon grid into your QGIS project that was used when you prepared the input data for SUEWS using <em>SUEWS Prepare</em> earlier in this tutorial.</li>
</ul>
<div class="figure" id="id10">
<a class="reference internal image-reference" href="../../../../../_images/SUEWSAnalyzer.png"><img alt="none" src="../../../../../_images/SUEWSAnalyzer.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.20 </span><span class="caption-text">The dialog for the SUEWS Analyzer tool.</span></p>
</div>
<p>To access the output data from the a model run, the <strong>RunControl.nml</strong> file for that particular run must be located. If your run has been made through UMEP, this file can be found in your output folder. Otherwise, this file can be located in the same folder from where the model was executed.</p>
<ul class="simple">
<li>In the top panel of <em>SUEWS Analyzer</em>, load the <strong>RunControl.nml</strong> located in the output folder.</li>
</ul>
<p>You will start by plotting basic data for grid 3242 which is one of the most dense urban area in the World.</p>
<ul class="simple">
<li>In the left panel, choose grid <em>3242</em> and year <em>2010</em>. Tick <em>plot basic data</em> and click <em>Plot</em>. This will display some of the most essential variables such as radiation balance and budget etc. You can use the tools such as the zoom to examine a shorter time period more in detail.</li>
</ul>
<div class="figure" id="id11">
<a class="reference internal image-reference" href="../../../../../_images/SUEWSSpatial_basicplot_grid3242.png"><img alt="none" src="../../../../../_images/SUEWSSpatial_basicplot_grid3242.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.21 </span><span class="caption-text">Basic plot for grid 3242. Click on image for enlargement.</span></p>
</div>
<p>Notice e.g. the high Q<sub>F</sub> values during winter as well as the low Q<sub>E</sub> values throughout the year.</p>
<ul class="simple">
<li>Close the plot and make the same kind of plot for grid 3054 which is a grid mainly within Central Park. Consider the differences between the plot generated for grid 3242. Close the plot when you are done.</li>
</ul>
<p>In the left panel, there is also possibilities to examine two different variables in time, either from the same grid or between two different grid points. There is also possible to examine different parameters through scatterplots.</p>
<p>The right panel in SUEWS Analyzer can be used to perform basic spatial analysis on your model results by producing aggragated maps etc. using different variables and time spans. Sensible heat (Q<sub>H</sub>) is one variable to visualise warm areas as it is a variable that show the amount of the available energy that will be partitioned into heat.</p>
<ul class="simple">
<li>Make the settings as shown in the figure below but change the location where you will save your data on your own system.</li>
</ul>
<div class="figure" id="id12">
<a class="reference internal image-reference" href="../../../../../_images/SUEWSSpatial_Analyzer.png"><img alt="none" src="../../../../../_images/SUEWSSpatial_Analyzer.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 9.22 </span><span class="caption-text">The dialog for the SUEWS Analyzer tool to produce a mean Q<sub>H</sub> for each grid. Click on image for enlargement.</span></p>
</div>
<p>Note that the warmest areas are located in the most dense urban environments and the coolest are found where either vegetation and/or water bodies are present. During 2010 there was a 3-day heat-wave event in the region around NYC that lasted from 5 to 8 July 2010 (Day of Year: 186-189).</p>
<ul class="simple">
<li>Make a similar average map but this time of 2m air temperature and choose only the heat wave period. Save it as a separate geoTiff.</li>
</ul>
</div>
<div class="section" id="the-influence-of-mitigation-measures-on-the-urban-energy-balance-optional">
<h2>9.3.7. The influence of mitigation measures on the urban energy balance (optional)<a class="headerlink" href="#the-influence-of-mitigation-measures-on-the-urban-energy-balance-optional" title="Permalink to this headline">¶</a></h2>
<p>There are different ways of manipulating the data using UMEP as well directly changing the input data in SUEWS to examine the influence of mitigation measures on the UEB. The most detailed way would be to directly changing the surface data by e.g. increasing the number of street trees. This can be done by e.g. using the <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/pre-processor/Spatial%20Data%20Tree%20Generator.html">TreeGenerator</a>-plugin in UMEP. This method would require that you go through the workflow of this tutorial again before you do your new model run. Another way is to directly manipulate input data to SUEWS at grid point level. This can done by e.g. changing the land cover fractions in <strong>SUEWS_SiteSelect.txt</strong>, the file that includes all grid-specific information used in SUEWS.</p>
<ul class="simple">
<li>Make a copy of your whole input folder created from SUEWSPRepare earlier and rename it to e.g. <em>Input_mitigation</em>.</li>
<li>In that folder remove all the files beginning with <em>InitialConditions</em> <strong>except</strong> the one called <strong>InitialConditionsnyc_2010.nml</strong>.</li>
<li>Open <strong>SUEWS_SiteSelect.txt</strong> in Excel (or similar software).</li>
<li>Now increace the fraction of decidious trees (<em>Fr_DecTr</em>) for grid 3242 and 3243 by 0.2. As the total land cover fraction has to be 1 you also need to reduce the paved fraction (<em>Fr_Paved</em>) by the same amount.</li>
<li>Save and close. Remember to keep the format (tab-separated text).</li>
<li>Create an empty folder called <em>Output_mitigation</em></li>
<li>Open <a class="reference external" href="http://umep-docs.readthedocs.io/en/latest/processor/Urban%20Energy%20Balance%20Urban%20Energy%20Balance%20(SUEWS.BLUEWS,%20advanced).html">SuewsAdvanced</a> and make the same settings as before but change the input and output folders.</li>
<li>Run the model.</li>
<li>When finished, create a similar average air temperature map for the heat event and compare the two maps. You can do a difference map by using the Raster Calculator in QGIS (<em>Raster&gt;Raster Calculator…</em>).</li>
</ul>
<p>Tutorial finished.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="SuewsWUDAPT.html" class="btn btn-neutral float-right" title="9.4. Urban Energy Balance - SUEWS and WUDAPT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="SuewsAdvanced.html" class="btn btn-neutral" title="9.2. Urban Energy Balance - SUEWS Advanced" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018 – 2019, micromet@University of Reading, led by Prof Sue Grimmond

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>