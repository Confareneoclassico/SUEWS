<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SUEWS-AnOHM: SUEWS_ESTM_functions.f95 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SUEWS-AnOHM
   &#160;<span id="projectnumber">0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SUEWS_ESTM_functions.f95</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_s_u_e_w_s___e_s_t_m__functions_8f95.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">! HCW - No longer needed as error handling done by SUEWS_error.f95 instead</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!module mod_error</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!implicit none</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!contains</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">! subroutine error(fname,ios,nostop)</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">! integer ::ios</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">! character (len=*)::fname</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">! integer,optional::nostop</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">! print*,&quot;file error: iostat=&quot;,ios, trim(fname)</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">! if (.not.present(nostop)) stop</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">! return</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">! end subroutine error</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!end module</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!==============================================================================</span></div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="namespacemod__interp.html">   20</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacemod__interp.html">mod_interp</a></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">!     Created on Thu Jan 22 00:06:32 2004</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">CONTAINS</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keyword">ELEMENTAL FUNCTION </span><a class="code" href="namespacemod__interp.html#aa2652ff1ded2f432b31108bd81c6dbd6">interp1d</a>(x1,x2,y1,y2,xi) <span class="keyword">RESULT</span>(yi)</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="namespacemod__interp.html#aa2652ff1ded2f432b31108bd81c6dbd6">   26</a></span>&#160;    <span class="keywordtype">REAL(8)</span>,<span class="keywordtype">INTENT(in)</span> ::x1,x2,xi</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">REAL(8)</span>,<span class="keywordtype">INTENT(in)</span> ::y1,y2</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">REAL (KIND(1D0))</span>::b0,b1</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">REAL(8)</span>         ::yi</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">!integer         ::ny                 !!!!!FO!!!!!</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    b1=(y2-y1)/(x2-x1)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    b0=y1-b1*x1</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    yi=b0+b1*xi</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemod__interp.html#aa2652ff1ded2f432b31108bd81c6dbd6">interp1d</a></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacemod__interp.html">mod_interp</a></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!=============================================================================</span></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="namespacemod__solver.html">   38</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacemod__solver.html">mod_solver</a></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">!     Created on Thu Jan 22 07:50:01 2004</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">!     Copyright (c) 2001 MyCompany. All rights reserved.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">CONTAINS</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="namespacemod__solver.html#a7906d5a56feebc123a09f0898a0a54e5">newtonpolynomial</a>(x0,Pcoeff,conv,maxiter) <span class="keyword">RESULT</span>(x)</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespacemod__solver.html#a7906d5a56feebc123a09f0898a0a54e5">   47</a></span>&#160;    <span class="comment">!Solves Newton&#39;s Method for a polynomial of the form</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">!f(x)=Pcoeff(1)*x^n+Pcoeff(2)*x^n-1+...+Pcoeff(n+1)</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">!                f(x(i))</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">! x(i+1) = x(i)- -------</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">!                f&#39;(x(i))</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">!</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">!conv is the level required for convergence</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">!maxiter is the maximum allowed iterations</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">!----------------------------------------------------</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">REAL(8)</span> ::x0,x,conv</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">REAL(8)</span> ::Pcoeff(:)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">REAL(8)</span> ::e, xprev</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">REAL (KIND(1D0))</span>::f,fp</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">INTEGER</span> ::maxiter</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">INTEGER</span> ::niter</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">LOGICAL</span> ::converged=.false.</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordtype">INTEGER</span> ::n,i,j</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    e=huge(1.)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    n=<span class="keyword">SIZE</span>(pcoeff)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    x=x0</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">DO</span> i=1,maxiter</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;       <span class="keywordflow">IF</span> (abs(e)&lt;conv) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          converged=.true.</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          <span class="keywordflow">EXIT</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordflow">       ENDIF</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;       f=0; fp = 0</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;       <span class="keywordflow">DO</span> j=1,n-1</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          f = f+pcoeff(j)*x**(n-j)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          fp = fp + pcoeff(j)*(n-j)*x**(n-j-1)                              <span class="comment">!!FO!! derivative</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keywordflow">       ENDDO</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;       f = f + pcoeff(n)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       xprev = x</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       <span class="keywordflow">IF</span> (fp==0.) fp=tiny(1.)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       x = xprev - f/fp</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;       e = x-xprev</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordflow">    ENDDO</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    niter=i-1</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">IF</span> (.NOT.converged) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       print*, <span class="stringliteral">&quot;Solution did not converge. Niter=&quot;</span>, niter, <span class="stringliteral">&quot; Error=&quot;</span>, e</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       x=x0</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemod__solver.html#a7906d5a56feebc123a09f0898a0a54e5">newtonpolynomial</a></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacemod__solver.html">mod_solver</a></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">!==============================================================================</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">!==============================================================================</span></div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html">   95</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacemodsolarcalc.html">modsolarcalc</a></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacemathconstants.html">mathconstants</a></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">CONTAINS</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#adfed66792e245bded2293250a0436520">min_zenith</a>(lat,doy) <span class="keyword">RESULT</span>(zmin)</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#adfed66792e245bded2293250a0436520">  102</a></span>&#160;    <span class="comment">!returns max zenith</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">!returns zenith in radians for lat, lng in degrees</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">REAL(8)</span> ::lat,dectime,zmin</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">REAL(8)</span> ::latr,decl</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordtype">INTEGER</span> :: doy</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    dectime=float(doy)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    latr=lat*<a class="code" href="namespacemathconstants.html#a3260b589a8581f09677797307607cbbf">dtr</a></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    decl=0.409*cos(2*<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>*(dectime-173)/365.25)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    zmin=<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>/2.-asin(sin(latr)*sin(decl)-cos(latr)*cos(decl)*(-1))</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#adfed66792e245bded2293250a0436520">min_zenith</a></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#a9ea53ee8fa5b7be8f0e7d919cc846182">local_apparent_time</a>(lng,dectime) <span class="keyword">RESULT</span>(la_time)</div><div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#a9ea53ee8fa5b7be8f0e7d919cc846182">  116</a></span>&#160;    <span class="comment">!Oke, 1989, equation of time elsewhere</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">REAL(8)</span> ::lng,dectime,la_time</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">REAL(8)</span> ::gamma,eqtime,lmst</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    lmst=dectime-4.*lng/60./1440.</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    gamma=2.*<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>/365.*(lmst-1.)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    eqtime=229.18*(7.5e-5+1.868e-3*cos(gamma)-0.032077*sin(gamma)&amp;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;         &amp;    -0.014615*cos(2.*gamma)-0.040849*sin(2.*gamma))</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    la_time=lmst+eqtime/1440.</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#a9ea53ee8fa5b7be8f0e7d919cc846182">local_apparent_time</a></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="namespacemodsolarcalc.html#a6f49f02608586154b6a3b3cddcd6aa5e">solar_angles</a>(lat,lng,timezone,dectime,decl,zenith,azimuth)</div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#a6f49f02608586154b6a3b3cddcd6aa5e">  129</a></span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">REAL</span>, <span class="keywordtype">INTENT(in)</span>  ::lat,lng,timezone,dectime</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">INTEGER</span>                 ::doy,hour,mn</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">REAL(8)</span>, <span class="keywordtype">INTENT(out)</span>  ::decl,zenith,azimuth</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">REAL (KIND(1d0))</span>  ::ha,latr,eqtime,tst,&amp;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;         time_offset,gamma           <span class="comment">!!!!!FO!!!!! lngr, phi, theta</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    latr=lat*<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>/180.</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    doy=floor(dectime)</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    hour=floor((dectime-doy)*24.)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    mn=floor((dectime-doy-hour/24.)*60.)   <span class="comment">!!!Check this</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    gamma=2.*<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>/365.25463*(doy-1.+(hour-12.)/24.)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    eqtime=229.18*(7.5e-5+1.868e-3*cos(gamma)-0.032077*sin(gamma)&amp;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         &amp;    -0.014615*cos(2.*gamma)-0.040849*sin(2.*gamma))</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    decl=6.918e-3-0.399912*cos(gamma)+0.070257*sin(gamma)&amp;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         &amp;    -0.006758*cos(2.*gamma)+9.07e-4*sin(2.*gamma)-2.697e-3*cos(3.*gamma)&amp;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;         &amp;    +1.48e-3*sin(3.*gamma)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    time_offset=eqtime-4.*lng+60.*timezone</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    tst=hour*60.+mn+time_offset</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    ha=(tst/4.)-180.</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    ha=ha*<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>/180.</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    zenith=acos(sin(latr)*sin(decl)+cos(latr)*cos(decl)*cos(ha))</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    azimuth=<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>+acos((sin(latr)*cos(zenith)-sin(decl))/(cos(latr)*sin(zenith)))</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="namespacemodsolarcalc.html#a6f49f02608586154b6a3b3cddcd6aa5e">solar_angles</a></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">!=========================== SolarTimes ==================================</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="namespacemodsolarcalc.html#a2fbd1d33b3bd03fd930a2a3d93b83599">solar_times</a>(lat,lng,timezone,dectime,sunrise,sunset,snoon)</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#a2fbd1d33b3bd03fd930a2a3d93b83599">  160</a></span>&#160;    <span class="comment">!  for sunrise and sunset ha = ha(zenith=90)</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">!  timezone is offset to GMT e.g. -5 for EST</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">REAL(8)</span>, <span class="keywordtype">INTENT(in)</span>  ::lat,lng,timezone,dectime</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">INTEGER</span>                 ::doy</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">REAL(8)</span>, <span class="keywordtype">INTENT(out)</span>  ::sunrise, sunset, snoon</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">REAL(8)</span>  :: ha, latr, eqtime, gamma, zenith, decl</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    latr = lat*<a class="code" href="namespacemathconstants.html#a3260b589a8581f09677797307607cbbf">dtr</a></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    zenith=90.833*<a class="code" href="namespacemathconstants.html#a3260b589a8581f09677797307607cbbf">dtr</a></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    doy=floor(dectime)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    gamma=2.*<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>/365.*(float(doy)-0.5) <span class="comment">!fractional year</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    eqtime=229.18*(7.5e-5+1.868e-3*cos(gamma)-0.032077*sin(gamma)&amp;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;         &amp;    -0.014615*cos(2.*gamma)-0.040849*sin(2.*gamma))</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    decl=6.918e-3-0.399912*cos(gamma)+0.070257*sin(gamma)&amp;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         &amp;    -0.006758*cos(2.*gamma)+9.07e-4*sin(2.*gamma)-2.697e-3*cos(3.*gamma)&amp;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         &amp;    +1.48e-3*sin(3.*gamma)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    ha=acos(cos(zenith)/(cos(latr)*cos(decl))-tan(latr)*tan(decl))</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    ha=ha*<a class="code" href="namespacemathconstants.html#a9e7d0779306b0fa5ccd63d7c7fea37c0">rtd</a></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    sunrise = (720.-4.*(lng-ha)-eqtime)/60.-timezone</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    sunset = (720.-4.*(lng+ha)-eqtime)/60.-timezone</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    snoon = (720.-4.*lng-eqtime)/60.-timezone</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="namespacemodsolarcalc.html#a2fbd1d33b3bd03fd930a2a3d93b83599">solar_times</a></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#af8c3c752c506d880efae84070a189a71">kdown_surface</a>(doy,zenith) <span class="keyword">RESULT</span>(Isurf)</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#af8c3c752c506d880efae84070a189a71">  185</a></span>&#160;    <span class="comment">! Calculates ground level solar irradiance clear sky</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">! assuming transmissivity = 1</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">! let it report zero if zenith &gt;= 90</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">REAL(8)</span>    ::zenith,Isurf</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">INTEGER</span>    ::doy</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">REAL (KIND(1d0))</span>::Rmean, Rse, cosZ,Itoa</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    rmean = 149.6   <span class="comment">!Stull 1998</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    rse=<a class="code" href="namespacemodsolarcalc.html#a17e233516e1b3514fd9d46a9ebe44e5e">solar_esdist</a>(doy)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">IF</span>(zenith&lt;<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>/2.) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;       cosz = cos(zenith)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;       itoa = 1370*(rmean/rse)**2    <span class="comment">!top of the atmosphere</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;       isurf = itoa*cosz      <span class="comment">!ground level solar irradiance in W/m2</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;       isurf = 0.</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#af8c3c752c506d880efae84070a189a71">kdown_surface</a></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#abf0aac3f480ad1b6dbfdac598c453fa5">smithlambda</a>(lat) <span class="keyword">RESULT</span>(G)</div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#abf0aac3f480ad1b6dbfdac598c453fa5">  206</a></span>&#160;    <span class="comment">!read kriged data based on Smith 1966 (JAM)</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">INTEGER</span> :: lat,ios</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">REAL</span>,<span class="keywordtype">DIMENSION(365)</span>:: G</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">OPEN</span>(99,file=<span class="stringliteral">&quot;Smith1966.grd&quot;</span>,access=<span class="stringliteral">&quot;direct&quot;</span>,action=<span class="stringliteral">&quot;read&quot;</span>,recl=365*4,iostat=ios)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">IF</span> (ios/=0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;       print*, <span class="stringliteral">&quot;Iostat=&quot;</span>,ios,<span class="stringliteral">&quot; reading Smith1966.grd&quot;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;       stop</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">READ</span>(99,rec=lat+1,iostat=ios) g</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">IF</span> (ios/=0) print*, <span class="stringliteral">&quot;Iostat=&quot;</span>, ios, <span class="stringliteral">&quot; reading Smith1966.grd&quot;</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">CLOSE</span>(99)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#abf0aac3f480ad1b6dbfdac598c453fa5">smithlambda</a></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#ad567772df0c379c013b1bec090be214a">transmissivity_cd</a>(P,Td,G,zenith) <span class="keyword">RESULT</span>(trans)           <span class="comment">!!!!!FO!!!!! ,doy</span></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#ad567772df0c379c013b1bec090be214a">  221</a></span>&#160;    <span class="comment">! bulk atmospheric transmissivity (Crawford and Duchon, 1999)</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">! P = pressure (hPa)</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">! Td = dewpoint (C)</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">! G parameter is empirical value from Smith 1966 (JAM)</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">! zenith in radians</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">! if zenith &gt; 80 use the value for 80?</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">!        integer         ::doy           !!!!!FO!!!!!</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">REAL(8)</span>    ::P,Td,zenith,G,trans</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">REAL (KIND(1d0))</span>::m,TrTpg,u,Tw,Ta,cosZ</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">REAL (KIND(1d0))</span>::Tdf</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">IF</span> (zenith&gt;80.*<a class="code" href="namespacemathconstants.html#a3260b589a8581f09677797307607cbbf">dtr</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;       cosz=cos(80.*<a class="code" href="namespacemathconstants.html#a3260b589a8581f09677797307607cbbf">dtr</a>)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;       cosz=cos(zenith)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    tdf = td*1.8+32. <span class="comment">!celsius to fahrenheit</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">!  Transmission coefficients</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    m = 35*cosz/sqrt(1224.*cosz*cosz+1) <span class="comment">!optical air mass at p=1013 mb</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    trtpg = 1.021-0.084*sqrt(m*(0.000949*p+0.051)) <span class="comment">!first two trans coeff</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    u = exp(0.113-log(g+1)+0.0393*tdf) <span class="comment">!precipitable water</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    tw = 1-0.077*(u*m)**0.3    <span class="comment">!vapor transmission coe3ff.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    ta = 0.935**m        <span class="comment">!4th trans coeff</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    trans = trtpg*tw*ta              <span class="comment">!bulk atmospherics transmissivity</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#ad567772df0c379c013b1bec090be214a">transmissivity_cd</a></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#aaddec454c9882fef35b57ee1fa6206b2">kdown_niemala</a>(S0,vap_press,Tk) <span class="keyword">RESULT</span>(kdown)           <span class="comment">!!!!!FO!!!!! ,albedo</span></div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#aaddec454c9882fef35b57ee1fa6206b2">  250</a></span>&#160;    <span class="comment">!from Niemala et al. 2001. Atmospheric Research 58:141-154</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">! using generalized formula only, no empirical data from site</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">!11 October 2001</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">! S0=base solar insolation at the surface</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">! albedo = surface albedo (required for multireflection diffuse)</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">! vap_press=screen level vapor pressure (Pa)</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">! Tk=screen level air temperature (K)</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">! ta=aerosol transmissivity</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">! tR=Rayleigh scattering transmissivity</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">! tg=uniformly mixed gas transmissivity</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">! tw=water vapor transmissivity</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">! toz=ozone transmissivity</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">!!!!!!!INCOMPLETE</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordtype">REAL</span>  ::S0,vap_press,Tk,kdown           <span class="comment">!!!!!FO!!!!! ,albedo</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordtype">REAL</span>  ::Sdir,Diffuse,Diffuse_R,Diffuse_a,Diffuse_m</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">REAL</span>  ::tr,tg,tw,ta,toz, theta</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keyword">CALL </span><a class="code" href="namespacemodsolarcalc.html#a8e5e61f1a3537693aa4ca5527f74233e">transmissivity</a>(vap_press,tk,theta,tr,tg,tw,ta,toz)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    sdir=0.9751*s0*tr*tg*tw*ta*toz</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    diffuse_r=0.</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    diffuse_a=0.</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    diffuse_m=0.</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    diffuse=diffuse_r+diffuse_a+diffuse_m</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    kdown=sdir+diffuse</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#aaddec454c9882fef35b57ee1fa6206b2">kdown_niemala</a></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="namespacemodsolarcalc.html#a8e5e61f1a3537693aa4ca5527f74233e">transmissivity</a>(vap_press,Tk,theta,tr,tg,tw,ta,toz)</div><div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#a8e5e61f1a3537693aa4ca5527f74233e">  276</a></span>&#160;    <span class="comment">!calculates atmospheric transmissivities for</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">! ta=aerosol transmissivity</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">! tR=Rayleigh scattering transmissivity</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">! tg=uniformly mixed gas transmissivity</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">! tw=water vapor transmissivity</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">! toz=ozone transmissivity</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">! from Iqbal (1983) and Niemala(2001)</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">! vap_press (Pa)</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">! Tk air temp (K)</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">! w=precipitable water content (cm)</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">!!!!!!!INCOMPLETE</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">REAL</span>  ::Tk, vap_press,theta</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">REAL</span>  ::tr,tg,tw,ta,toz,w</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    w=0.493*vap_press/tk</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    ta=0.59+0.012*theta-1.336e-4*theta*theta</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="namespacemodsolarcalc.html#a8e5e61f1a3537693aa4ca5527f74233e">transmissivity</a></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">!=======================================================</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#a17e233516e1b3514fd9d46a9ebe44e5e">solar_esdist</a>(doy) <span class="keyword">RESULT</span>(Rse)</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="namespacemodsolarcalc.html#a17e233516e1b3514fd9d46a9ebe44e5e">  295</a></span>&#160;    <span class="comment">!from Stull, 1998</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordtype">INTEGER</span>  ::doy</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">REAL(8)</span>  ::Rse</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">REAL (KIND(1d0))</span> ::MA,nu,e,a</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    e = 0.0167</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    a = 146.457</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    ma = 2.*<a class="code" href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">pi</a>*(doy-3)/365.25463 <span class="comment">!Mean anomaly</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    nu=ma+0.0333988*sin(ma)+.0003486*sin(2.*ma)+5e-6*sin(3.*ma) <span class="comment">!true anomaly</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    rse = a*(1-e*e)/(1+e*cos(nu))</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemodsolarcalc.html#a17e233516e1b3514fd9d46a9ebe44e5e">solar_esdist</a></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacemodsolarcalc.html">modsolarcalc</a></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">!=====================================================================================</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">!=====================================================================================</span></div><div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="namespaceheatflux.html">  313</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespaceheatflux.html">heatflux</a></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keyword">CONTAINS</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="namespaceheatflux.html#a44a99e2a4ba173804ec1adf16608a8b2">heatcond1d</a>(T,Qs,dx,dt,k,rhocp,bc,bctype)</div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="namespaceheatflux.html#a44a99e2a4ba173804ec1adf16608a8b2">  318</a></span>&#160;    <span class="keywordtype">REAL(8)</span>,<span class="keywordtype">INTENT(inout)</span>::T(:)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">REAL(8)</span>,<span class="keywordtype">INTENT(in)</span>::dx(:),dt,k(:),rhocp(:),bc(2)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordtype">REAL(8)</span>,<span class="keywordtype">INTENT(out)</span>::Qs</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">LOGICAL</span>,<span class="keywordtype">INTENT(in)</span>::bctype(2)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">INTEGER</span>         ::i,n<span class="comment">!,j       !!!!!FO!!!!!</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">REAL(8)</span>,<span class="keywordtype">ALLOCATABLE</span>::w(:),a(:),T1(:)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    n=<span class="keyword">SIZE</span>(t)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">ALLOCATE</span>(w(0:n),a(n),t1(n))</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">!w = interface tempea</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    w(1:n)=t</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    w(0)=bc(1); w(n)=bc(2)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">!convert from flux to equivalent temperature, not exact</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">! F = k dT/dX =&gt; dx*F/k + Ti = Ti</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">IF</span> (bctype(1)) w(0)=bc(1)*0.5*dx(1)/k(1)+w(1)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">IF</span> (bctype(2)) w(n)=bc(2)*0.5*dx(n)/k(n)+w(n)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    a=k/dx</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">DO</span> i=1,n-1</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;       w(i)=(t(i+1)*a(i+1)+t(i)*a(i))/(a(i)+a(i+1))</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordflow">    ENDDO</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">!!FO!! print*, &#39;w: &#39;, w</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">DO</span> i=1,n</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;       t1(i) = (dt/rhocp(i))*(w(i-1)-2*t(i) + w(i))*2*a(i)/dx(i) + t(i)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keywordflow">    ENDDO</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">!!FO!! print*, &#39;T1: &#39;, T1</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">!for storage the internal distribution of heat should not be important</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    qs = (w(0)-t(1))*2*a(1) + (w(n)-t(n))*2*a(n)                           <span class="comment">!!FO!! k*d(dT/dx)/dx = rhoCp*(dT/dt) -- rhoCp*(dT/dt)*dx = dQs -- dQs = k*d(dT/dx)</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">! Qs=sum((T1-T)*rhocp*dx)/dt!</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    t=t1</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="namespaceheatflux.html#a44a99e2a4ba173804ec1adf16608a8b2">heatcond1d</a></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespaceheatflux.html">heatflux</a></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">!==================================================================================</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">!===================================================================================</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="namespacemeteo.html">  352</a></span>&#160;<span class="keyword">MODULE</span> <a class="code" href="namespacemeteo.html">meteo</a></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacemathconstants.html">mathconstants</a></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">! REAL (KIND(1d0)),PARAMETER ::  PI=3.141592654</span></div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="namespacemeteo.html#ae4e33b320117dc89986bd1d37a18ae74">  358</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#ae4e33b320117dc89986bd1d37a18ae74">rad2deg</a>=57.29577951</div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a6acb74c9a7ddfe85ba69112897754791">  359</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#a6acb74c9a7ddfe85ba69112897754791">deg2rad</a>=0.017453292</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a54b7cd84df1d97cb79965d43460ad694">  361</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#a54b7cd84df1d97cb79965d43460ad694">molmass_air</a>=0.028965             <span class="comment">! kg for 1 mol dry air</span></div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="namespacemeteo.html#acb7ea078c76c3b3d8eed2c1f1df3f6ba">  362</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#acb7ea078c76c3b3d8eed2c1f1df3f6ba">molmass_co2</a>=0.04401              <span class="comment">! kg for 1 mol CO2</span></div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="namespacemeteo.html#aae3f90f9d5c4581ccb0a05acee54f2ac">  363</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#aae3f90f9d5c4581ccb0a05acee54f2ac">molmass_h2o</a>=0.0180153            <span class="comment">! kg for 1 mol water vapor</span></div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="namespacemeteo.html#ac6780e7f2432c338fc92d3ef2eca5089">  364</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#ac6780e7f2432c338fc92d3ef2eca5089">mu_h2o</a>=<a class="code" href="namespacemeteo.html#a54b7cd84df1d97cb79965d43460ad694">molmass_air</a>/<a class="code" href="namespacemeteo.html#aae3f90f9d5c4581ccb0a05acee54f2ac">molmass_h2o</a>   <span class="comment">! mol air/mol H2O</span></div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a5e25bc167da1551976c0f934a28b9c41">  365</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#a5e25bc167da1551976c0f934a28b9c41">mu_co2</a>=<a class="code" href="namespacemeteo.html#a54b7cd84df1d97cb79965d43460ad694">molmass_air</a>/<a class="code" href="namespacemeteo.html#acb7ea078c76c3b3d8eed2c1f1df3f6ba">molmass_co2</a>   <span class="comment">! mol air/mol CO2</span></div><div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a6b0124b140e3a372291310b9c292ceda">  366</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#a6b0124b140e3a372291310b9c292ceda">r_dry_mol</a>=8.31451                <span class="comment">! J/K/mol gas constant</span></div><div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="namespacemeteo.html#aeb38e2ee75a5100806164ecfd458a956">  367</a></span>&#160;  <span class="keywordtype">REAL (KIND(1D0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#aeb38e2ee75a5100806164ecfd458a956">r_dry_mass</a>=<a class="code" href="namespacemeteo.html#a6b0124b140e3a372291310b9c292ceda">r_dry_mol</a>/<a class="code" href="namespacemeteo.html#a54b7cd84df1d97cb79965d43460ad694">molmass_air</a> <span class="comment">! J/K/kg GAS CONSTANT</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">!REAL (KIND(1d0)),PARAMETER ::  SIGMA_SB=5.67051e-8              ! Stefan-Boltzmann constant</span></div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a63de0dfce55a22ba48600ea13d0e216d">  369</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#a63de0dfce55a22ba48600ea13d0e216d">epsil</a>=0.62197</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a4ac27cf4384cebc39c7c0ec998ec5579">  370</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#a4ac27cf4384cebc39c7c0ec998ec5579">kb</a>=1.3807e-25                    <span class="comment">! BOLTZMANN&#39;S CONSTANT (m^3 MB K^-1)=R/A</span></div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="namespacemeteo.html#aaf725e1853e17e82e0db242dcf619c15">  371</a></span>&#160;  <span class="keywordtype">REAL (KIND(1d0))</span>,<span class="keywordtype">PARAMETER</span> ::  <a class="code" href="namespacemeteo.html#aaf725e1853e17e82e0db242dcf619c15">avogadro</a>=6.02252e23              <span class="comment">! AVOGADRO&#39;S NUMBER (molecules/mol)</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keyword">CONTAINS</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">!============================================================================</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="_l_u_m_p_s__atmos__functions__moist_8f95.html#a634f4cc5a636b7b311a16a1eb64e133e">sat_vap_press</a>(TK,P) <span class="keyword">RESULT</span>(es)</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a6777852efdfd10f05bb7467fd99f03ec">  377</a></span>&#160;    <span class="comment">!c sg sept 99 f90</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">!c     This uses eqns from Buck (1981) JAM 20, 1527-1532</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">!c     units T (K) e (mb) P (mb)</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">!c     f corrects for the fact that we are not dealing with pure water</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">REAL(8)</span>    :: TK,P,TC,es,e,f</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    tc=tk-273.15</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">IF</span>(tc.EQ.0)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;       tc=0.001</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">!Valid for 50&gt;T&gt;-40</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    e=6.1121*exp(((18.729-tc/227.3)*tc)/(tc+257.87))</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    f=1.00072+p*(3.2e-6+5.9e-10*tc**2)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    es=e*f</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="_l_u_m_p_s__atmos__functions__moist_8f95.html#a634f4cc5a636b7b311a16a1eb64e133e">sat_vap_press</a></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a799c55d98d43606ee55dfcb2ed973c02">sos_dryair</a>(TK)</div><div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a799c55d98d43606ee55dfcb2ed973c02">  393</a></span>&#160;    <span class="comment">!SPEED OF SOUND IN DRY AIR, BEER (1991)</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="namespacemeteo.html#a799c55d98d43606ee55dfcb2ed973c02">sos_dryair</a>=sqrt(1.4*<a class="code" href="namespacemeteo.html#a6b0124b140e3a372291310b9c292ceda">r_dry_mol</a>*tk/(<a class="code" href="namespacemeteo.html#a54b7cd84df1d97cb79965d43460ad694">molmass_air</a>*1000.))</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a799c55d98d43606ee55dfcb2ed973c02">sos_dryair</a></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">!============================================================================</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a537068a2255cff524747621cd522b93a">potential_temp</a>(TK,P)</div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a537068a2255cff524747621cd522b93a">  399</a></span>&#160;    <span class="comment">!TK = ABSOLUTE TEMPERATURE</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">!P  = PRESS (hPa)</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordtype">REAL(8)</span>    ::TK,P</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <a class="code" href="namespacemeteo.html#a537068a2255cff524747621cd522b93a">potential_temp</a>=tk*(1000./p)**0.286</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a537068a2255cff524747621cd522b93a">potential_temp</a></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#afaaf9cd39b3f9994813ea6197d3a74bf">latentheat_v</a>(TK)</div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="namespacemeteo.html#afaaf9cd39b3f9994813ea6197d3a74bf">  406</a></span>&#160;    <span class="comment">!LATENT HEAT OF VAPORIZATION (J/kg) BOLTON(1980)</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">!TK = ABSOLUTE TEMPERATURE</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="namespacemeteo.html#afaaf9cd39b3f9994813ea6197d3a74bf">latentheat_v</a>=2.501e6-2370.*(tk-273.15)</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#afaaf9cd39b3f9994813ea6197d3a74bf">latentheat_v</a></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a57634c251a493116d57d49865d95c7a6">latentheat_m</a>(TK)</div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a57634c251a493116d57d49865d95c7a6">  413</a></span>&#160;    <span class="comment">!LATENT HEAT OF MELTING (J/kg) VALID BELOW 0C BOLTON(1980)</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">!TK = ABSOLUTE TEMPERATURE</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK,TC</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    tc=tk-273.15</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="namespacemeteo.html#a57634c251a493116d57d49865d95c7a6">latentheat_m</a>=3.3358e5+tc*(2030.-10.46*tc)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a57634c251a493116d57d49865d95c7a6">latentheat_m</a></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a1db0e89d35e5eae20acb839111603927">spec_heat_dryair</a>(TK)</div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a1db0e89d35e5eae20acb839111603927">  421</a></span>&#160;    <span class="comment">! BEER (1991) APPLIED ENVIRONMETRICS METEOROLOGICAL TABLES</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK,TC</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    tc=tk-273.15</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="namespacemeteo.html#a1db0e89d35e5eae20acb839111603927">spec_heat_dryair</a>=1005.+((tc+23.15)**2)/3364.</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a1db0e89d35e5eae20acb839111603927">spec_heat_dryair</a></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a2458549db90b31c67886950a36fe2370">spec_heat_vapor</a>(TK,RH)</div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a2458549db90b31c67886950a36fe2370">  428</a></span>&#160;    <span class="comment">! BEER (1991) APPLIED ENVIRONMETRICS METEOROLOGICAL TABLES</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK,TC_100,RH</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    tc_100=(tk-273.15)/100.</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="namespacemeteo.html#a2458549db90b31c67886950a36fe2370">spec_heat_vapor</a>=1859.+0.13*rh+(19.3+0.569*rh)*tc_100+(10.+0.5*rh)*tc_100**2</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a2458549db90b31c67886950a36fe2370">spec_heat_vapor</a></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a1c0a3877fc85ffd63bbf91b3e710b602">heatcapacity_air</a>(TK,RH,P)</div><div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a1c0a3877fc85ffd63bbf91b3e710b602">  435</a></span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK,RH,P</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordtype">REAL(8)</span> ::RHO_D,RHO_V</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">REAL(8)</span> ::CPD,CPV</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    rho_d=<a class="code" href="namespacemeteo.html#a2d3b6838da7330c4e146845991c0bc8a">density_dryair</a>(tk,p)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    rho_v=<a class="code" href="namespacemeteo.html#a4a51e0e5cdc190c3e5eccdb69c267382">density_vapor</a>(tk,rh,p)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    cpd=<a class="code" href="namespacemeteo.html#a1db0e89d35e5eae20acb839111603927">spec_heat_dryair</a>(tk)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    cpv=<a class="code" href="namespacemeteo.html#a2458549db90b31c67886950a36fe2370">spec_heat_vapor</a>(tk,rh)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="namespacemeteo.html#a1c0a3877fc85ffd63bbf91b3e710b602">heatcapacity_air</a>=rho_d*cpd+rho_v*cpv</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a1c0a3877fc85ffd63bbf91b3e710b602">heatcapacity_air</a></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#afeb4cd9d5827418a587e1b78093b08f5">density_moist</a>(TVK,P)</div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="namespacemeteo.html#afeb4cd9d5827418a587e1b78093b08f5">  446</a></span>&#160;    <span class="comment">! density of moist air FROM VIRTUAL TEMPERATURE</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">!TVK = VIRTUAL TEMPERATURE (K)</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">!= = PRESSURE (hPa)</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TVK,P</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="namespacemeteo.html#afeb4cd9d5827418a587e1b78093b08f5">density_moist</a>=p*100./(<a class="code" href="namespacemeteo.html#aeb38e2ee75a5100806164ecfd458a956">r_dry_mass</a>*tvk)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#afeb4cd9d5827418a587e1b78093b08f5">density_moist</a></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a4a51e0e5cdc190c3e5eccdb69c267382">density_vapor</a>(TK,RH,P)</div><div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a4a51e0e5cdc190c3e5eccdb69c267382">  454</a></span>&#160;    <span class="comment">!WATER VAPOR DENSITY</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordtype">REAL(8)</span>    ::TK,P,RH,EA</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    ea=<a class="code" href="_l_u_m_p_s__atmos__functions__moist_8f95.html#a634f4cc5a636b7b311a16a1eb64e133e">sat_vap_press</a>(tk,p)*rh/100.</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="namespacemeteo.html#a4a51e0e5cdc190c3e5eccdb69c267382">density_vapor</a>=(ea*100.*<a class="code" href="namespacemeteo.html#a63de0dfce55a22ba48600ea13d0e216d">epsil</a>)/(<a class="code" href="namespacemeteo.html#aeb38e2ee75a5100806164ecfd458a956">r_dry_mass</a>*tk)</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a4a51e0e5cdc190c3e5eccdb69c267382">density_vapor</a></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a2d3b6838da7330c4e146845991c0bc8a">density_dryair</a>(TK,P)</div><div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a2d3b6838da7330c4e146845991c0bc8a">  461</a></span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK,P</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="namespacemeteo.html#a2d3b6838da7330c4e146845991c0bc8a">density_dryair</a>=p*100./(<a class="code" href="namespacemeteo.html#aeb38e2ee75a5100806164ecfd458a956">r_dry_mass</a>*tk)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a2d3b6838da7330c4e146845991c0bc8a">density_dryair</a></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a5c26a948b622d4d5ffd1f16f755e3c96">density_gas</a>(TK,PP,MOLMASS)</div><div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a5c26a948b622d4d5ffd1f16f755e3c96">  466</a></span>&#160;    <span class="comment">!DENSITY FOR IDEAL GAS SPECIES GIVEN ITS PARTIAL PRESSURE (hPa) AND MOLAR MASS (kg)</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK,PP,MOLMASS</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="namespacemeteo.html#a5c26a948b622d4d5ffd1f16f755e3c96">density_gas</a>=pp*molmass/(<a class="code" href="namespacemeteo.html#a6b0124b140e3a372291310b9c292ceda">r_dry_mol</a>*tk)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a5c26a948b622d4d5ffd1f16f755e3c96">density_gas</a></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a0171c7d6a68810bdaa89cb39c92ee96f">partial_pressure</a>(TK,N)</div><div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a0171c7d6a68810bdaa89cb39c92ee96f">  472</a></span>&#160;    <span class="comment">!PARTIAL PRESSURE OF IDEAL GAS (hPa)</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK,N <span class="comment">!N IS THE NUMBER DENSITY IN mol/m3</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="namespacemeteo.html#a0171c7d6a68810bdaa89cb39c92ee96f">partial_pressure</a>=n*<a class="code" href="namespacemeteo.html#a4ac27cf4384cebc39c7c0ec998ec5579">kb</a>*tk</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a0171c7d6a68810bdaa89cb39c92ee96f">partial_pressure</a></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#ad07039dc16c44b421a37a93ec073d7ac">scale_height</a>(TK)</div><div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="namespacemeteo.html#ad07039dc16c44b421a37a93ec073d7ac">  478</a></span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">!SCALE HEIGHT FOR DRY ATMOSPHERE IN km BEER (1991)</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="namespacemeteo.html#ad07039dc16c44b421a37a93ec073d7ac">scale_height</a>=<a class="code" href="namespacemeteo.html#a6b0124b140e3a372291310b9c292ceda">r_dry_mol</a>*tk/(<a class="code" href="namespacemeteo.html#a54b7cd84df1d97cb79965d43460ad694">molmass_air</a>*9.81)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#ad07039dc16c44b421a37a93ec073d7ac">scale_height</a></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keyword">  REAL(8) </span><span class="keyword">FUNCTION </span><a class="code" href="namespacemeteo.html#a60b3a3a3f1d7b40ed8b9fd4b55a9e06b">vaisala_brunt_f</a>(TK)</div><div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="namespacemeteo.html#a60b3a3a3f1d7b40ed8b9fd4b55a9e06b">  484</a></span>&#160;    <span class="comment">!BEER (1991)</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordtype">REAL(8)</span> ::TK</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="namespacemeteo.html#a60b3a3a3f1d7b40ed8b9fd4b55a9e06b">vaisala_brunt_f</a>=sqrt(0.4/1.4*9.81/<a class="code" href="namespacemeteo.html#ad07039dc16c44b421a37a93ec073d7ac">scale_height</a>(tk))</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="namespacemeteo.html#a60b3a3a3f1d7b40ed8b9fd4b55a9e06b">vaisala_brunt_f</a></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="namespacemeteo.html">meteo</a></div><div class="ttc" id="namespacemeteo_html_ad07039dc16c44b421a37a93ec073d7ac"><div class="ttname"><a href="namespacemeteo.html#ad07039dc16c44b421a37a93ec073d7ac">meteo::scale_height</a></div><div class="ttdeci">real(8) function scale_height(TK)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00478">SUEWS_ESTM_functions.f95:478</a></div></div>
<div class="ttc" id="namespacemeteo_html_acb7ea078c76c3b3d8eed2c1f1df3f6ba"><div class="ttname"><a href="namespacemeteo.html#acb7ea078c76c3b3d8eed2c1f1df3f6ba">meteo::molmass_co2</a></div><div class="ttdeci">real(kind(1d0)), parameter molmass_co2</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00362">SUEWS_ESTM_functions.f95:362</a></div></div>
<div class="ttc" id="namespaceheatflux_html"><div class="ttname"><a href="namespaceheatflux.html">heatflux</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00313">SUEWS_ESTM_functions.f95:313</a></div></div>
<div class="ttc" id="namespacemeteo_html_afaaf9cd39b3f9994813ea6197d3a74bf"><div class="ttname"><a href="namespacemeteo.html#afaaf9cd39b3f9994813ea6197d3a74bf">meteo::latentheat_v</a></div><div class="ttdeci">real(8) function latentheat_v(TK)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00406">SUEWS_ESTM_functions.f95:406</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_af8c3c752c506d880efae84070a189a71"><div class="ttname"><a href="namespacemodsolarcalc.html#af8c3c752c506d880efae84070a189a71">modsolarcalc::kdown_surface</a></div><div class="ttdeci">real(8) function kdown_surface(doy, zenith)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00185">SUEWS_ESTM_functions.f95:185</a></div></div>
<div class="ttc" id="namespacemeteo_html_a54b7cd84df1d97cb79965d43460ad694"><div class="ttname"><a href="namespacemeteo.html#a54b7cd84df1d97cb79965d43460ad694">meteo::molmass_air</a></div><div class="ttdeci">real(kind(1d0)), parameter molmass_air</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00361">SUEWS_ESTM_functions.f95:361</a></div></div>
<div class="ttc" id="namespacemeteo_html_a799c55d98d43606ee55dfcb2ed973c02"><div class="ttname"><a href="namespacemeteo.html#a799c55d98d43606ee55dfcb2ed973c02">meteo::sos_dryair</a></div><div class="ttdeci">real(8) function sos_dryair(TK)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00393">SUEWS_ESTM_functions.f95:393</a></div></div>
<div class="ttc" id="namespacemeteo_html_a6acb74c9a7ddfe85ba69112897754791"><div class="ttname"><a href="namespacemeteo.html#a6acb74c9a7ddfe85ba69112897754791">meteo::deg2rad</a></div><div class="ttdeci">real(kind(1d0)), parameter deg2rad</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00359">SUEWS_ESTM_functions.f95:359</a></div></div>
<div class="ttc" id="namespacemathconstants_html_a31c67c4b97732eec2768d395e451a82c"><div class="ttname"><a href="namespacemathconstants.html#a31c67c4b97732eec2768d395e451a82c">mathconstants::pi</a></div><div class="ttdeci">real(kind(1d0)), parameter pi</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l02109">LUMPS_Module_constants.f95:2109</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_a2fbd1d33b3bd03fd930a2a3d93b83599"><div class="ttname"><a href="namespacemodsolarcalc.html#a2fbd1d33b3bd03fd930a2a3d93b83599">modsolarcalc::solar_times</a></div><div class="ttdeci">subroutine solar_times(lat, lng, timezone, dectime, sunrise, sunset, snoon)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00160">SUEWS_ESTM_functions.f95:160</a></div></div>
<div class="ttc" id="namespacemeteo_html_afeb4cd9d5827418a587e1b78093b08f5"><div class="ttname"><a href="namespacemeteo.html#afeb4cd9d5827418a587e1b78093b08f5">meteo::density_moist</a></div><div class="ttdeci">real(8) function density_moist(TVK, P)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00446">SUEWS_ESTM_functions.f95:446</a></div></div>
<div class="ttc" id="namespacemeteo_html_a63de0dfce55a22ba48600ea13d0e216d"><div class="ttname"><a href="namespacemeteo.html#a63de0dfce55a22ba48600ea13d0e216d">meteo::epsil</a></div><div class="ttdeci">real(kind(1d0)), parameter epsil</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00369">SUEWS_ESTM_functions.f95:369</a></div></div>
<div class="ttc" id="namespacemod__solver_html_a7906d5a56feebc123a09f0898a0a54e5"><div class="ttname"><a href="namespacemod__solver.html#a7906d5a56feebc123a09f0898a0a54e5">mod_solver::newtonpolynomial</a></div><div class="ttdeci">real(8) function newtonpolynomial(x0, Pcoeff, conv, maxiter)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00047">SUEWS_ESTM_functions.f95:47</a></div></div>
<div class="ttc" id="namespacemeteo_html_a2458549db90b31c67886950a36fe2370"><div class="ttname"><a href="namespacemeteo.html#a2458549db90b31c67886950a36fe2370">meteo::spec_heat_vapor</a></div><div class="ttdeci">real(8) function spec_heat_vapor(TK, RH)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00428">SUEWS_ESTM_functions.f95:428</a></div></div>
<div class="ttc" id="namespacemod__interp_html"><div class="ttname"><a href="namespacemod__interp.html">mod_interp</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00020">SUEWS_ESTM_functions.f95:20</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html"><div class="ttname"><a href="namespacemodsolarcalc.html">modsolarcalc</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00095">SUEWS_ESTM_functions.f95:95</a></div></div>
<div class="ttc" id="namespacemeteo_html_a57634c251a493116d57d49865d95c7a6"><div class="ttname"><a href="namespacemeteo.html#a57634c251a493116d57d49865d95c7a6">meteo::latentheat_m</a></div><div class="ttdeci">real(8) function latentheat_m(TK)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00413">SUEWS_ESTM_functions.f95:413</a></div></div>
<div class="ttc" id="namespacemeteo_html_a5c26a948b622d4d5ffd1f16f755e3c96"><div class="ttname"><a href="namespacemeteo.html#a5c26a948b622d4d5ffd1f16f755e3c96">meteo::density_gas</a></div><div class="ttdeci">real(8) function density_gas(TK, PP, MOLMASS)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00466">SUEWS_ESTM_functions.f95:466</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_a17e233516e1b3514fd9d46a9ebe44e5e"><div class="ttname"><a href="namespacemodsolarcalc.html#a17e233516e1b3514fd9d46a9ebe44e5e">modsolarcalc::solar_esdist</a></div><div class="ttdeci">real(8) function solar_esdist(doy)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00295">SUEWS_ESTM_functions.f95:295</a></div></div>
<div class="ttc" id="namespacemod__solver_html"><div class="ttname"><a href="namespacemod__solver.html">mod_solver</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00038">SUEWS_ESTM_functions.f95:38</a></div></div>
<div class="ttc" id="namespacemeteo_html_a537068a2255cff524747621cd522b93a"><div class="ttname"><a href="namespacemeteo.html#a537068a2255cff524747621cd522b93a">meteo::potential_temp</a></div><div class="ttdeci">real(8) function potential_temp(TK, P)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00399">SUEWS_ESTM_functions.f95:399</a></div></div>
<div class="ttc" id="namespacemeteo_html_aae3f90f9d5c4581ccb0a05acee54f2ac"><div class="ttname"><a href="namespacemeteo.html#aae3f90f9d5c4581ccb0a05acee54f2ac">meteo::molmass_h2o</a></div><div class="ttdeci">real(kind(1d0)), parameter molmass_h2o</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00363">SUEWS_ESTM_functions.f95:363</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_aaddec454c9882fef35b57ee1fa6206b2"><div class="ttname"><a href="namespacemodsolarcalc.html#aaddec454c9882fef35b57ee1fa6206b2">modsolarcalc::kdown_niemala</a></div><div class="ttdeci">real function kdown_niemala(S0, vap_press, Tk)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00250">SUEWS_ESTM_functions.f95:250</a></div></div>
<div class="ttc" id="namespacemeteo_html_a60b3a3a3f1d7b40ed8b9fd4b55a9e06b"><div class="ttname"><a href="namespacemeteo.html#a60b3a3a3f1d7b40ed8b9fd4b55a9e06b">meteo::vaisala_brunt_f</a></div><div class="ttdeci">real(8) function vaisala_brunt_f(TK)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00484">SUEWS_ESTM_functions.f95:484</a></div></div>
<div class="ttc" id="namespacemod__interp_html_aa2652ff1ded2f432b31108bd81c6dbd6"><div class="ttname"><a href="namespacemod__interp.html#aa2652ff1ded2f432b31108bd81c6dbd6">mod_interp::interp1d</a></div><div class="ttdeci">elemental real(8) function interp1d(x1, x2, y1, y2, xi)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00026">SUEWS_ESTM_functions.f95:26</a></div></div>
<div class="ttc" id="namespacemeteo_html"><div class="ttname"><a href="namespacemeteo.html">meteo</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00352">SUEWS_ESTM_functions.f95:352</a></div></div>
<div class="ttc" id="namespacemeteo_html_a2d3b6838da7330c4e146845991c0bc8a"><div class="ttname"><a href="namespacemeteo.html#a2d3b6838da7330c4e146845991c0bc8a">meteo::density_dryair</a></div><div class="ttdeci">real(8) function density_dryair(TK, P)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00461">SUEWS_ESTM_functions.f95:461</a></div></div>
<div class="ttc" id="namespacemathconstants_html"><div class="ttname"><a href="namespacemathconstants.html">mathconstants</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l02107">LUMPS_Module_constants.f95:2107</a></div></div>
<div class="ttc" id="namespacemeteo_html_a4ac27cf4384cebc39c7c0ec998ec5579"><div class="ttname"><a href="namespacemeteo.html#a4ac27cf4384cebc39c7c0ec998ec5579">meteo::kb</a></div><div class="ttdeci">real(kind(1d0)), parameter kb</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00370">SUEWS_ESTM_functions.f95:370</a></div></div>
<div class="ttc" id="namespacemeteo_html_aaf725e1853e17e82e0db242dcf619c15"><div class="ttname"><a href="namespacemeteo.html#aaf725e1853e17e82e0db242dcf619c15">meteo::avogadro</a></div><div class="ttdeci">real(kind(1d0)), parameter avogadro</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00371">SUEWS_ESTM_functions.f95:371</a></div></div>
<div class="ttc" id="namespacemeteo_html_a6b0124b140e3a372291310b9c292ceda"><div class="ttname"><a href="namespacemeteo.html#a6b0124b140e3a372291310b9c292ceda">meteo::r_dry_mol</a></div><div class="ttdeci">real(kind(1d0)), parameter r_dry_mol</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00366">SUEWS_ESTM_functions.f95:366</a></div></div>
<div class="ttc" id="namespacemathconstants_html_a9e7d0779306b0fa5ccd63d7c7fea37c0"><div class="ttname"><a href="namespacemathconstants.html#a9e7d0779306b0fa5ccd63d7c7fea37c0">mathconstants::rtd</a></div><div class="ttdeci">real(kind(1d0)), parameter rtd</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l02110">LUMPS_Module_constants.f95:2110</a></div></div>
<div class="ttc" id="namespaceheatflux_html_a44a99e2a4ba173804ec1adf16608a8b2"><div class="ttname"><a href="namespaceheatflux.html#a44a99e2a4ba173804ec1adf16608a8b2">heatflux::heatcond1d</a></div><div class="ttdeci">subroutine heatcond1d(T, Qs, dx, dt, k, rhocp, bc, bctype)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00318">SUEWS_ESTM_functions.f95:318</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_a9ea53ee8fa5b7be8f0e7d919cc846182"><div class="ttname"><a href="namespacemodsolarcalc.html#a9ea53ee8fa5b7be8f0e7d919cc846182">modsolarcalc::local_apparent_time</a></div><div class="ttdeci">real(8) function local_apparent_time(lng, dectime)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00116">SUEWS_ESTM_functions.f95:116</a></div></div>
<div class="ttc" id="namespacemeteo_html_a5e25bc167da1551976c0f934a28b9c41"><div class="ttname"><a href="namespacemeteo.html#a5e25bc167da1551976c0f934a28b9c41">meteo::mu_co2</a></div><div class="ttdeci">real(kind(1d0)), parameter mu_co2</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00365">SUEWS_ESTM_functions.f95:365</a></div></div>
<div class="ttc" id="namespacemeteo_html_a0171c7d6a68810bdaa89cb39c92ee96f"><div class="ttname"><a href="namespacemeteo.html#a0171c7d6a68810bdaa89cb39c92ee96f">meteo::partial_pressure</a></div><div class="ttdeci">real(8) function partial_pressure(TK, N)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00472">SUEWS_ESTM_functions.f95:472</a></div></div>
<div class="ttc" id="namespacemeteo_html_a4a51e0e5cdc190c3e5eccdb69c267382"><div class="ttname"><a href="namespacemeteo.html#a4a51e0e5cdc190c3e5eccdb69c267382">meteo::density_vapor</a></div><div class="ttdeci">real(8) function density_vapor(TK, RH, P)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00454">SUEWS_ESTM_functions.f95:454</a></div></div>
<div class="ttc" id="namespacemathconstants_html_a3260b589a8581f09677797307607cbbf"><div class="ttname"><a href="namespacemathconstants.html#a3260b589a8581f09677797307607cbbf">mathconstants::dtr</a></div><div class="ttdeci">real(kind(1d0)), parameter dtr</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l02110">LUMPS_Module_constants.f95:2110</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_adfed66792e245bded2293250a0436520"><div class="ttname"><a href="namespacemodsolarcalc.html#adfed66792e245bded2293250a0436520">modsolarcalc::min_zenith</a></div><div class="ttdeci">real(8) function min_zenith(lat, doy)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00102">SUEWS_ESTM_functions.f95:102</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_ad567772df0c379c013b1bec090be214a"><div class="ttname"><a href="namespacemodsolarcalc.html#ad567772df0c379c013b1bec090be214a">modsolarcalc::transmissivity_cd</a></div><div class="ttdeci">real(8) function transmissivity_cd(P, Td, G, zenith)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00221">SUEWS_ESTM_functions.f95:221</a></div></div>
<div class="ttc" id="namespacemeteo_html_ac6780e7f2432c338fc92d3ef2eca5089"><div class="ttname"><a href="namespacemeteo.html#ac6780e7f2432c338fc92d3ef2eca5089">meteo::mu_h2o</a></div><div class="ttdeci">real(kind(1d0)), parameter mu_h2o</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00364">SUEWS_ESTM_functions.f95:364</a></div></div>
<div class="ttc" id="_l_u_m_p_s__atmos__functions__moist_8f95_html_a634f4cc5a636b7b311a16a1eb64e133e"><div class="ttname"><a href="_l_u_m_p_s__atmos__functions__moist_8f95.html#a634f4cc5a636b7b311a16a1eb64e133e">sat_vap_press</a></div><div class="ttdeci">real(kind(1d0)) function sat_vap_press(Temp_c, PRESS_hPa, from, dectime)</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s__atmos__functions__moist_8f95_source.html#l00110">LUMPS_atmos_functions_moist.f95:110</a></div></div>
<div class="ttc" id="namespacemeteo_html_a1db0e89d35e5eae20acb839111603927"><div class="ttname"><a href="namespacemeteo.html#a1db0e89d35e5eae20acb839111603927">meteo::spec_heat_dryair</a></div><div class="ttdeci">real(8) function spec_heat_dryair(TK)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00421">SUEWS_ESTM_functions.f95:421</a></div></div>
<div class="ttc" id="namespacemeteo_html_aeb38e2ee75a5100806164ecfd458a956"><div class="ttname"><a href="namespacemeteo.html#aeb38e2ee75a5100806164ecfd458a956">meteo::r_dry_mass</a></div><div class="ttdeci">real(kind(1d0)), parameter r_dry_mass</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00367">SUEWS_ESTM_functions.f95:367</a></div></div>
<div class="ttc" id="namespacemeteo_html_a1c0a3877fc85ffd63bbf91b3e710b602"><div class="ttname"><a href="namespacemeteo.html#a1c0a3877fc85ffd63bbf91b3e710b602">meteo::heatcapacity_air</a></div><div class="ttdeci">real(8) function heatcapacity_air(TK, RH, P)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00435">SUEWS_ESTM_functions.f95:435</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_a6f49f02608586154b6a3b3cddcd6aa5e"><div class="ttname"><a href="namespacemodsolarcalc.html#a6f49f02608586154b6a3b3cddcd6aa5e">modsolarcalc::solar_angles</a></div><div class="ttdeci">subroutine solar_angles(lat, lng, timezone, dectime, decl, zenith, azimuth)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00129">SUEWS_ESTM_functions.f95:129</a></div></div>
<div class="ttc" id="namespacemeteo_html_ae4e33b320117dc89986bd1d37a18ae74"><div class="ttname"><a href="namespacemeteo.html#ae4e33b320117dc89986bd1d37a18ae74">meteo::rad2deg</a></div><div class="ttdeci">real(kind(1d0)), parameter rad2deg</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00358">SUEWS_ESTM_functions.f95:358</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_a8e5e61f1a3537693aa4ca5527f74233e"><div class="ttname"><a href="namespacemodsolarcalc.html#a8e5e61f1a3537693aa4ca5527f74233e">modsolarcalc::transmissivity</a></div><div class="ttdeci">subroutine transmissivity(vap_press, Tk, theta, tr, tg, tw, ta, toz)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00276">SUEWS_ESTM_functions.f95:276</a></div></div>
<div class="ttc" id="namespacemodsolarcalc_html_abf0aac3f480ad1b6dbfdac598c453fa5"><div class="ttname"><a href="namespacemodsolarcalc.html#abf0aac3f480ad1b6dbfdac598c453fa5">modsolarcalc::smithlambda</a></div><div class="ttdeci">real function, dimension(365) smithlambda(lat)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__functions_8f95_source.html#l00206">SUEWS_ESTM_functions.f95:206</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
