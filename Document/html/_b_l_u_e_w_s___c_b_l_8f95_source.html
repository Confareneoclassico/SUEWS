<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SUEWS-AnOHM: BLUEWS_CBL.f95 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SUEWS-AnOHM
   &#160;<span id="projectnumber">0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BLUEWS_CBL.f95</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_b_l_u_e_w_s___c_b_l_8f95.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;  <span class="comment">! Note: INTERVAL is now set to 3600 s in Initial (it is no longer set in RunControl) HCW 29 Jan 2015</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  <span class="comment">! Last modified:</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  <span class="comment">!  HCW 29 Mar 2017 - Changed third dimension of dataOutBL to Gridiv (was previously iMB which seems incorrect)</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  <span class="comment">!  NT 6 Apr 2017 - include top of the CBL variables in RKUTTA scheme + add flag to include or exclude subsidence</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  <span class="comment">!  LJ 27 Jan 2016 - Removal of tabs</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#acde23a276c692f0ec2a493dc9720471c">cbl</a>(ifirst,iMB,Gridiv)</div><div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="_b_l_u_e_w_s___c_b_l_8f95.html#acde23a276c692f0ec2a493dc9720471c">    9</a></span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemod__z.html">mod_z</a></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemod__k.html">mod_k</a></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacegas.html">gas</a></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacetime.html">time</a></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacedata__in.html">data_in</a></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacesues__data.html">sues_data</a></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemoist.html">moist</a></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceallocatearray.html">allocatearray</a></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacedefaultnotused.html">defaultnotused</a></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacecbl__module.html">cbl_module</a></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacegis__data.html">gis_data</a></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewherewhen.html">wherewhen</a></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::sat_vap_press</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::qh_use,qe_use,tm_K_zm,qm_gkg_zm</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::Temp_C1,avrh1,es_hPa1</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::secs0,secs1,Lv</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">INTEGER</span>::idoy,ifirst,iMB,Gridiv,startflag,iNBL</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>, <span class="keywordtype">PARAMETER</span>::pi=3.141592653589793d+0,d2r=pi/180.</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">! Reset iCBLcount at start of each metblock (HCW added 29/03/2017)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">IF</span>(ifirst == 1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;       <a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a> = 0</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">!write(*,*) DateTIme</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">!Skip first loop and unspecified days</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">!IF((ifirst==1 .AND. iMB==1) .OR. CBLday(id)==0) THEN   !HCW modified condition to check for first timestep of the model run</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">IF</span>(ifirst==1 .OR. <a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,2)==-999) <span class="keywordflow">THEN</span>   <span class="comment">!TS modified to adapt the format of the new CBL_initial file</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;       <a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>=<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>+1</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;       <span class="comment">!write(*,*) &#39;ifirst or nonCBLday&#39;, DateTime, iCBLcount</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;       <a class="code" href="namespaceallocatearray.html#a668365934e66c156613eaf3027add7a4">dataoutbl</a>(<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>,1:<a class="code" href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">ncolumnsdataoutbl</a>,gridiv)=(/<span class="keywordtype">REAL(iy,8)</span>,<span class="keywordtype">REAL(id,8)</span>,<span class="keywordtype">REAL(it,8)</span>,<span class="keywordtype">REAL(imin,8)</span>,dectime, &amp;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;       (<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a>,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=6,<a class="code" href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">ncolumnsdataoutbl</a>)/)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;       <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacedata__in.html#a8ac4d9de71d52d8c39e04c59635a5e3c">avkdn</a>&lt;5)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;       inbl=1</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;       <span class="keywordflow">IF</span> (inbl==-9) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          <span class="keyword">CALL </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#a2070c594a28f66b5ee4b95cd0251621e">cbl_initial</a>(qh_use,qe_use,tm_k_zm,qm_gkg_zm,startflag,imb, gridiv)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;          <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;       <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;          <span class="comment">!ADD NBL for Night:(1)Fixed input/output NBL; (2) Input Fixed Theta,Q to SUEWS; (3) Currently NBL eq 200 m</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;          <span class="keyword">CALL </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#ada6e5e5cd6b578659b196bb8c26bd98c">nbl</a>(qh_use,qe_use,tm_k_zm,qm_gkg_zm,startflag,imb, gridiv)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;          <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keywordflow">       ENDIF</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">IF</span>(startflag==0)<span class="keywordflow">THEN</span> <span class="comment">!write down initial values in previous time step</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       <span class="comment">!write(*,*) &#39;startflag&#39;, DateTime, iCBLcount</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;       <a class="code" href="namespaceallocatearray.html#a668365934e66c156613eaf3027add7a4">dataoutbl</a>(<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>,1:<a class="code" href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">ncolumnsdataoutbl</a>,gridiv)=(/<span class="keywordtype">REAL(iy,8)</span>,<span class="keywordtype">REAL(id,8)</span>,<span class="keywordtype">REAL(it,8)</span>,<span class="keywordtype">REAL(imin,8)</span>,dectime,<a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a>,<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>, &amp;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;       qm_kgkg*1000,tp_K,qp_kgkg*1000,(<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a>,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=11,20),<a class="code" href="namespacecbl__module.html#a86a03f05040f82f59951951ed8feb92d">gamt_km</a>,<a class="code" href="namespacecbl__module.html#a1ce0de96513d92e7be4a7b0318a7102a">gamq_kgkgm</a>/)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;       startflag=1</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    qh_use=<a class="code" href="namespacesues__data.html#a891cda3d0ef1f628e7dd9a185f00fc6c">qhforcbl</a>(gridiv)   <span class="comment">!HCW 21 Mar 2017</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    qe_use=<a class="code" href="namespacesues__data.html#a08451f44609cb386788368a9136432c7">qeforcbl</a>(gridiv)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">IF</span>(qh_use&lt;-900.OR.qe_use&lt;-900)<span class="keywordflow">THEN</span>  <span class="comment">! observed data has a problem</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(22,<span class="stringliteral">&#39;Unrealistic qh or qe_value for CBL.&#39;</span>,qh_use,qe_use,<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">!!Heat flux choices - these are now made in SUEWS_Calculations for qhforCBL and qeCBL, rather than here</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">!IF(Qh_choice==1) THEN   !from SUEWS</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">!  !qh_use=qh</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">!   !qe_use=qeph</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">!   qh_use=qhforCBL(Gridiv)   !HCW 21 Mar 2017</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">!   qe_use=qeforCBL(Gridiv)</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">!ELSEIF(qh_choice==2)THEN !from LUMPS</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">!   qh_use=H_mod</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">!   qe_use=E_mod</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">!ELSEIF(qh_choice==3)THEN  !from OBS</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">!   IF(qh_obs&lt;-900.OR.qe_obs&lt;-900)THEN  ! observed data has a problem</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">!      CALL ErrorHint(22,&#39;Unrealistic observed qh or qe_value.&#39;,qh_obs,qe_obs,qh_choice)</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">!   ENDIF</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">!   qh_use=qh_obs</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">!   qe_use=qe_obs</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">!ENDIF</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">!-------Main loop of CBL calculation--------------------------------------</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">!-------------------------------------------------------------------------</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">!write(*,*) &#39;Main CBL loop&#39;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(1)=float(<a class="code" href="namespacetime.html#a88a6c141593462330d65da0397b9b71d">it</a>)+float(<a class="code" href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">imin</a>)/60.</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(2)=qh_use</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(3)=qe_use</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(4)=<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(5)=<a class="code" href="namespacemoist.html#a59a8f410cf3ebfe343d9c01b5dbb2cf8">lv_j_kg</a></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(6)=<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(7)=<a class="code" href="namespacedata__in.html#abc95201410a9b25f8d1d2d5a063302c3">avu1</a></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(8)=<a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(9)=<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(10)=<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    secs0=<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(1)*3600.</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    secs1=secs0+float(<a class="code" href="namespacesues__data.html#ac6af955be55f5fe026b4ba1ab6ec480e">tstep</a>) <span class="comment">! time in seconds</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">! Kinematic fluxes</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="namespacecbl__module.html#a3bb0811c2c1eb194eff7132bb1a906ef">fhbl_kms</a>    = <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(2)/ (<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(4)*<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(6))  <span class="comment">!qh_use/(avdens*avcp)      ! units: degK * m/s</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="namespacecbl__module.html#a5b2329a6a103326f5fa08282787d83aa">febl_kgkgms</a> = <a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(3)/ (<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(4)*<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(5))  <span class="comment">!qe_use/(avdens*lv_J_kg)   ! units: kg/kg * m/s</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#a1fe4af3f4b8ea35de69189177bcc9d5d">co2_included</a>==1)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;       <a class="code" href="namespacecbl__module.html#abece0fd4503899af7cb75b51be8b5e63">fcbl</a> = 0<span class="comment">!fc(i)/(rmco2/volm)      ! units: mol/mol * m/s</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;       <a class="code" href="namespacecbl__module.html#ab5d6f31d2f9b523336fb0947a1e53707">cm</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">!   tpp_K=tp_K</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">!   qpp_kgkg=qp_kgkg</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#a546f4ac8b1d6305356caf940d8e8e342">sondeflag</a>.EQ.1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_b_l_u_e_w_s___diff_8f95.html#a27fc32bfb9bfb2d6e21511c2e8c9bfed">gamma_sonde</a></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">!       set up array for Runge-Kutta call</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="namespacecbl__module.html#a19dd722436e710830c7ff6b961753c62">blh1_m</a>=<a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(1)=<a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a> <span class="comment">! integrate h, t, q, c from time s(i-1)</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(2)=<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>  <span class="comment">! to time s(i) using runge-kutta solution</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(3)=qm_kgkg   <span class="comment">! of slab CBL equations</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(4)=<a class="code" href="namespacecbl__module.html#ab5d6f31d2f9b523336fb0947a1e53707">cm</a></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(5)=tp_k</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(6)=qp_kgkg</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">!++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">CALL </span><a class="code" href="_b_l_u_e_w_s___diff_8f95.html#aa6b01ddf379446848f8a822a7918fcd0">rkutta</a>(<a class="code" href="namespacecbl__module.html#a52c76c9e4368adec7890e95932374f73">neqn</a>,secs0,secs1,<a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>,1)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">!++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a>   =<a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(1)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>    =<a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(2)  <span class="comment">! potential temperature, units: deg C  &lt;-NT: shouldn&#39;t this be K?</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    qm_kgkg =<a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(3)  <span class="comment">! specific humidity, units: kg/kg</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="namespacecbl__module.html#ab5d6f31d2f9b523336fb0947a1e53707">cm</a>      =<a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(4)  <span class="comment">! co2 concentration,units: mol/mol</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    tp_k    =<a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(5)  <span class="comment">! potential temperature top of CBL: K</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    qp_kgkg =<a class="code" href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">y</a>(6)  <span class="comment">! specific humidity top of CBL: kg/kg</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">!       compute derived quantities for this time step</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">!NT: now included in rkutta</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">!   tp_K   = tpp_K     + (gamt_Km*(blh_m-blh1_m))</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">!   qp_kgkg = qpp_kgkg + (gamq_kgkgm*(blh_m-blh1_m))</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!   IF (tp_K.LT.tm_K) THEN</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">!      tp_K = tm_K</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">!   ENDIF</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">!       th = tm_K - (grav/cbldata(5))*blh_m          ! actual temp just below z=h</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">!       dh = qsatf(th,cbldata(8)) - qm_kgkg           ! deficit just below z=h</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="namespacecbl__module.html#a7b92d87a613cb13145b7c84beced7f67">tp_c</a>=tp_k-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="namespacecbl__module.html#a9981080497583b5953927b0a2bbdcde8">tm_c</a>=<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">!    delt = tp_K - tm_K ! temp</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">!    delq = qp_kgkg - qm_kgkg ! humidity</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">!deltv = (tp_K - tm_K) + 0.61*tm_k*(qp_kgkg - qm_kgkg)  ! pot virtual temp</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>=qm_kgkg*1000 <span class="comment">!humidities: kg/kg -&gt; g/kg</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">!Output time correction</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    idoy=<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">!If(it==0 .and. imin==55) idoy=id-1</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacetime.html#a88a6c141593462330d65da0397b9b71d">it</a>==0 .AND. <a class="code" href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">imin</a>==(<a class="code" href="namespacesues__data.html#ab2070158f8b88b8f7835232841061718">nsh_real</a>-1)/<a class="code" href="namespacesues__data.html#ab2070158f8b88b8f7835232841061718">nsh_real</a>*60) idoy=<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1  <span class="comment">!Modified by HCW 04 Mar 2015 in case model timestep is not 5-min</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">! NB: any difference between the two options? code looks the same in the two branches.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">IF</span>((<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>==1).OR.(<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>==2))<span class="keywordflow">THEN</span> <span class="comment">!BLUEWS or BLUMPS</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;       <span class="comment">!Stability correction</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;       <span class="comment">!tm_K_zm=tm_K+cbldata(10)*cbldata(2)/(k*cbldata(8)*cbldata(6)*cbldata(4))</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;       <a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>=<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>/((1000/<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(9))**(<a class="code" href="namespacegas.html#ac0aae13e9168fcb9f0f09f3559594b4d">gas_ct_dry</a>/<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(6)))-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;       <a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>=sat_vap_press(<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(9),1)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;       lv=(2500.25-2.365*<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>)*1000</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;       <span class="comment">!qm_gkg_zm=qm_gkg+cbldata(10)*cbldata(3)/(k*cbldata(8)*cbldata(4)*lv)</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;       <a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>=100*((<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>*<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(9)/(622+<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>))/<a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>) <span class="comment">!check pressure</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;       <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>&gt;100)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(34,<span class="stringliteral">&#39;subroutine CBL dectime, relative humidity&#39;</span>,idoy+<a class="code" href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbldata</a>(1)/24.0,<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>,100)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>=100</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="keywordflow">       ENDIF</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;       <a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>=<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>+1</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;       <span class="comment">!write(*,*) &#39;qh1or2&#39;, DateTIme, iCBLcount</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;       <a class="code" href="namespaceallocatearray.html#a668365934e66c156613eaf3027add7a4">dataoutbl</a>(<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>,1:<a class="code" href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">ncolumnsdataoutbl</a>,gridiv)=(/<span class="keywordtype">REAL(iy,8)</span>,<span class="keywordtype">REAL(id,8)</span>,<span class="keywordtype">REAL(it,8)</span>,<span class="keywordtype">REAL(imin,8)</span>,dectime,<a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a>,<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>, &amp;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;       qm_kgkg*1000, tp_K,qp_kgkg*1000,&amp;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;       Temp_C,avrh,cbldata(2),cbldata(3),cbldata(9),cbldata(7),cbldata(8),cbldata(4),cbldata(5),cbldata(6),&amp;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;       gamt_Km,gamq_kgkgm/)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>==3)<span class="keywordflow">THEN</span> <span class="comment">! CBL</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;       <span class="comment">!tm_K_zm=tm_K+cbldata(10)*cbldata(2)/(k*cbldata(8)*cbldata(6)*cbldata(4))</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;       temp_c1=<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>/((1000/cbldata(9))**(<a class="code" href="namespacegas.html#ac0aae13e9168fcb9f0f09f3559594b4d">gas_ct_dry</a>/cbldata(6)))-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;       es_hpa1=sat_vap_press(temp_c1,cbldata(9),1)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;       lv=(2500.25-2.365*temp_c1)*1000</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;       <span class="comment">!qm_gkg_zm=qm_gkg+cbldata(10)*cbldata(3)/(k*cbldata(8)*cbldata(4)*lv)</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       <span class="comment">!  avrh1=100*((qm_gkg*cbldata(8)/(622+qm_gkg))/es_hPa1) !check pressure</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       avrh1=100*((<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>*cbldata(9)/(622+<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>))/es_hpa1) <span class="comment">! should be cbldata(9), i.e., Press_hPa</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;       <span class="keywordflow">IF</span>(avrh1&gt;100)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(34,<span class="stringliteral">&#39;subroutine CBL dectime, relative humidity&#39;</span>,idoy+cbldata(1)/24.0,avrh,100)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          avrh1=100</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keywordflow">       ENDIF</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;       <a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>=<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>+1</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;       <span class="comment">!write(*,*) &#39;qh3&#39;, DateTIme, iCBLcount</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;       <a class="code" href="namespaceallocatearray.html#a668365934e66c156613eaf3027add7a4">dataoutbl</a>(<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>,1:<a class="code" href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">ncolumnsdataoutbl</a>,gridiv)=(/<span class="keywordtype">REAL(iy,8)</span>,<span class="keywordtype">REAL(id,8)</span>,<span class="keywordtype">REAL(it,8)</span>,<span class="keywordtype">REAL(imin,8)</span>,dectime,blh_m,tm_K, &amp;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;       qm_kgkg*1000,tp_K,qp_kgkg*1000,&amp;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;       Temp_C1,avrh1,cbldata(2),cbldata(3),cbldata(9),cbldata(7),cbldata(8),cbldata(4),cbldata(5),cbldata(6),&amp;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       gamt_Km,gamq_kgkgm/)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#acde23a276c692f0ec2a493dc9720471c">cbl</a></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#a2b7c9b5778366f3415268e6939cab229">cbl_readinputdata</a></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="_b_l_u_e_w_s___c_b_l_8f95.html#a2b7c9b5778366f3415268e6939cab229">  212</a></span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceallocatearray.html">allocatearray</a></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacedata__in.html">data_in</a></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacesues__data.html">sues_data</a></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacecbl__module.html">cbl_module</a></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceinitial.html">initial</a></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewherewhen.html">wherewhen</a></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">INTEGER</span>::i, ios</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::l</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordtype">    NAMELIST</span>/cblinput/<a class="code" href="namespacecbl__module.html#a904519e3dcaa1592e2506c840b8cc7e4">entrainmenttype</a>,&amp;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>,&amp;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="namespacecbl__module.html#a0140016345794a8912c00aafaf50fe1e">isubs</a>,&amp;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="namespacecbl__module.html#a1fe4af3f4b8ea35de69189177bcc9d5d">co2_included</a>,&amp;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="namespacecbl__module.html#a5901bc487fe54be32f04988c42ab7443">cblday</a>,&amp;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="namespacecbl__module.html#acdfa6106091fdfa93a6cab25af3d0f1a">wsb</a>,&amp;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>,&amp;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="namespacecbl__module.html#add8682c29dcc92f528e2894dd1e16f39">initialdatafilename</a>,&amp;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="namespacecbl__module.html#a546f4ac8b1d6305356caf940d8e8e342">sondeflag</a>,&amp;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="namespacecbl__module.html#a810011542edd41ab403379b2004c84ab">filesonde</a></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">OPEN</span>(51,file=trim(<a class="code" href="namespacedata__in.html#a67f60bb1f8edd3c6be5380ab655fe7f1">fileinputpath</a>)//<span class="stringliteral">&#39;CBLInput.nml&#39;</span>,status=<span class="stringliteral">&#39;old&#39;</span>, err=24)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keyword">READ</span>(51,nml=cblinput,err=24)</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">CLOSE</span>(51)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">!Read initial values if it&#39;s needed</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>==1 .OR. <a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>==2)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;       <span class="keyword">OPEN</span>(52,file=trim(<a class="code" href="namespacedata__in.html#a67f60bb1f8edd3c6be5380ab655fe7f1">fileinputpath</a>)//trim(<a class="code" href="namespacecbl__module.html#add8682c29dcc92f528e2894dd1e16f39">initialdatafilename</a>),status=<span class="stringliteral">&#39;old&#39;</span>, err=25)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;       <span class="keyword">READ</span>(52,*)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;       <a class="code" href="namespacecbl__module.html#a5f768f5aae74fa7b0c2d66118fc71ba5">nlineindata</a> = 0   <span class="comment">!Initialise nlines</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;       <span class="keywordflow">DO</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          <span class="keyword">READ</span>(52,*, iostat=ios) l</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          <span class="keywordflow">IF</span>(ios&lt;0 .OR. l == -9) <span class="keywordflow">EXIT</span>   <span class="comment">!IF (l == -9) EXIT</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          <a class="code" href="namespacecbl__module.html#a5f768f5aae74fa7b0c2d66118fc71ba5">nlineindata</a> = <a class="code" href="namespacecbl__module.html#a5f768f5aae74fa7b0c2d66118fc71ba5">nlineindata</a> + 1</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keywordflow">       ENDDO</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;       <span class="keyword">CLOSE</span>(52)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;       <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(1:<a class="code" href="namespacecbl__module.html#a5f768f5aae74fa7b0c2d66118fc71ba5">nlineindata</a>,1:8))</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;       <span class="keyword">OPEN</span>(52,file=trim(<a class="code" href="namespacedata__in.html#a67f60bb1f8edd3c6be5380ab655fe7f1">fileinputpath</a>)//trim(<a class="code" href="namespacecbl__module.html#add8682c29dcc92f528e2894dd1e16f39">initialdatafilename</a>),status=<span class="stringliteral">&#39;old&#39;</span>, err=25)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;       <span class="keyword">READ</span>(52,*)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;       <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacecbl__module.html#a5f768f5aae74fa7b0c2d66118fc71ba5">nlineindata</a></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keyword">READ</span>(52,*)<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(i,1:8)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordflow">       ENDDO</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;       <span class="keyword">CLOSE</span>(52)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#a1fe4af3f4b8ea35de69189177bcc9d5d">co2_included</a>==0)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;       <a class="code" href="namespacecbl__module.html#abece0fd4503899af7cb75b51be8b5e63">fcbl</a>=0       <span class="comment">! hard-wire no CO2</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>=0</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">RETURN</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;24  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(24,<span class="stringliteral">&#39;CBLInput.nml&#39;</span>,0.00d0,0.000d0,0)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;25  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(24,trim(<a class="code" href="namespacedata__in.html#a67f60bb1f8edd3c6be5380ab655fe7f1">fileinputpath</a>)//trim(<a class="code" href="namespacecbl__module.html#add8682c29dcc92f528e2894dd1e16f39">initialdatafilename</a>),0.00d0,0.00d0,0)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#a2b7c9b5778366f3415268e6939cab229">cbl_readinputdata</a></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">!----------------------------------------------------------------------</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">!-----------------------------------------------------------------------</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#a2070c594a28f66b5ee4b95cd0251621e">cbl_initial</a>(qh_use,qe_use,tm_K_zm,qm_gkg_zm,startflag,iMB,Gridiv)</div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="_b_l_u_e_w_s___c_b_l_8f95.html#a2070c594a28f66b5ee4b95cd0251621e">  277</a></span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemod__z.html">mod_z</a></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemod__k.html">mod_k</a></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacegas.html">gas</a></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacetime.html">time</a></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacedata__in.html">data_in</a></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacesues__data.html">sues_data</a></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemoist.html">moist</a></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceallocatearray.html">allocatearray</a></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacedefaultnotused.html">defaultnotused</a></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacecbl__module.html">cbl_module</a></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacegis__data.html">gis_data</a></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewherewhen.html">wherewhen</a></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::qh_use,qe_use,tm_K_zm,qm_gkg_zm</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::qsatf,sat_vap_press,lv</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">INTEGER</span>::i,nLineDay,iMB,Gridiv,startflag</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    qh_use=<a class="code" href="namespacesues__data.html#a891cda3d0ef1f628e7dd9a185f00fc6c">qhforcbl</a>(gridiv)   <span class="comment">!HCW 21 Mar 2017</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    qe_use=<a class="code" href="namespacesues__data.html#a08451f44609cb386788368a9136432c7">qeforcbl</a>(gridiv)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">IF</span>(qh_use&lt;-900.OR.qe_use&lt;-900)<span class="keywordflow">THEN</span>  <span class="comment">! observed data has a problem</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(22,<span class="stringliteral">&#39;Unrealistic qh or qe_value for CBL.&#39;</span>,qh_use,qe_use,<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">!!Heat flux choices - these are now made in SUEWS_Calculations for qhforCBL and qeCBL, rather than here</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">!IF(Qh_choice==1) THEN   !from SUEWS</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">!   !qh_use=qh</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">!   !qe_use=qeph</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">!   qh_use=qhforCBL(Gridiv)   !HCW 21 Mar 2017</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">!   qe_use=qeforCBL(Gridiv)</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">!ELSEIF(qh_choice==2)THEN !from LUMPS</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">!   qh_use=H_mod</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">!   qe_use=E_mod</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">!ELSEIF(qh_choice==3)THEN  !from OBS</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">!   IF(qh_obs&lt;-900.OR.qe_obs&lt;-900)THEN  ! observed data has a problem</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">!      CALL ErrorHint(22,&#39;Unrealistic observed qh or qe_value.&#39;,qh_obs,qe_obs,qh_choice)</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">!   ENDIF</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">!   qh_use=qh_obs</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">!   qe_use=qe_obs</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">!ENDIF</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>=<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>+1</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">!write(*,*) &#39;cblinitial&#39;, DateTIme, iCBLcount</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="namespaceallocatearray.html#a668365934e66c156613eaf3027add7a4">dataoutbl</a>(<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>,1:<a class="code" href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">ncolumnsdataoutbl</a>,gridiv)=(/<span class="keywordtype">REAL(iy,8)</span>,<span class="keywordtype">REAL(id,8)</span>,<span class="keywordtype">REAL(it,8)</span>,<span class="keywordtype">REAL(imin,8)</span>,dectime, &amp;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    (<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a>,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=6,<a class="code" href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">ncolumnsdataoutbl</a>)/)</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    nlineday=0</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacecbl__module.html#a5f768f5aae74fa7b0c2d66118fc71ba5">nlineindata</a></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;       <span class="keywordflow">IF</span> (int(<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(i,1))&lt;=<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          nlineday=nlineday+1</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">       ENDIF</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keywordflow">    ENDDO</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>==2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;       <a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,2)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;       <a class="code" href="namespacecbl__module.html#a86a03f05040f82f59951951ed8feb92d">gamt_km</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,3)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;       <a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,4)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;       <a class="code" href="namespacecbl__module.html#af9b1b9c8cf1a15dca9b8750920a048c3">tp_k</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,5)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;       <a class="code" href="namespacecbl__module.html#a45208115b84dad98c55d11cf93307c0c">qp_gkg</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,6)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;       <a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,7)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;       <a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,8)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>==1 .AND. <a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,1)==<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>)<span class="keywordflow">THEN</span>   <span class="comment">! Changed from i to nlineDay, HCW 29 March 2017</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;       <a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,2)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;       <a class="code" href="namespacecbl__module.html#a86a03f05040f82f59951951ed8feb92d">gamt_km</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,3)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;       <a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,4)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;       tm_k_zm=(<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>+<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a>)*((1000/<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>)**(<a class="code" href="namespacegas.html#ac0aae13e9168fcb9f0f09f3559594b4d">gas_ct_dry</a>/<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>))</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;       <a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>=tm_k_zm-<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a>*qh_use/(<a class="code" href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">k</a>*<a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>*<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>*<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;       <a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>=sat_vap_press(<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>,1)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;       qm_gkg_zm=622*<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>/(100*<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>/<a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>-<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;       lv=(2500.25-2.365*<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>)*1000</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;       <a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>=qm_gkg_zm-<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a>*qe_use/(<a class="code" href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">k</a>*<a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>*<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>*lv)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;       <a class="code" href="namespacecbl__module.html#af9b1b9c8cf1a15dca9b8750920a048c3">tp_k</a>=<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;       <a class="code" href="namespacecbl__module.html#a45208115b84dad98c55d11cf93307c0c">qp_gkg</a>=<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>==0)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;       <a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a>=241.5</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;       <a class="code" href="namespacecbl__module.html#a86a03f05040f82f59951951ed8feb92d">gamt_km</a>=0.043</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;       <a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>=0.0092</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;       tm_k_zm=(<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>+<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a>)*((1000/<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>)**(<a class="code" href="namespacegas.html#ac0aae13e9168fcb9f0f09f3559594b4d">gas_ct_dry</a>/<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>))</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;       <a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>=tm_k_zm-<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a>*qh_use/(<a class="code" href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">k</a>*<a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>*<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>*<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;       <a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>=sat_vap_press(<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>,1)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;       qm_gkg_zm=622*<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>/(100*<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>/<a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>-<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;       lv=(2500.25-2.365*<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>)*1000</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;       <a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>=<a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>-<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a>*qe_use/(<a class="code" href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">k</a>*<a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>*<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>*lv)</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;       <a class="code" href="namespacecbl__module.html#af9b1b9c8cf1a15dca9b8750920a048c3">tp_k</a>=<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;       <a class="code" href="namespacecbl__module.html#a45208115b84dad98c55d11cf93307c0c">qp_gkg</a>=<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="namespacecbl__module.html#a1ce0de96513d92e7be4a7b0318a7102a">gamq_kgkgm</a>=<a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>/1000.</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">qp_kgkg</a>=<a class="code" href="namespacecbl__module.html#a45208115b84dad98c55d11cf93307c0c">qp_gkg</a>/1000    <span class="comment">!humidities: g/kg -&gt; kg/kg   q+</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">qm_kgkg</a>=<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>/1000    <span class="comment">!conc at mixing layer height h</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="namespacecbl__module.html#a7b92d87a613cb13145b7c84beced7f67">tp_c</a>=<a class="code" href="namespacecbl__module.html#af9b1b9c8cf1a15dca9b8750920a048c3">tp_k</a>-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="namespacecbl__module.html#a9981080497583b5953927b0a2bbdcde8">tm_c</a>=<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">! IF(sondeflag==1 .AND. cblday(id)==1) THEN</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#a546f4ac8b1d6305356caf940d8e8e342">sondeflag</a>==1 .AND. <a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,2)/=-999) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;       <span class="comment">!if gamma theta varies with z (selected by setting gthetaflag=1)</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;       <span class="comment">!if gamma q varies with z (selected by setting ghumflag=1)</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_b_l_u_e_w_s___diff_8f95.html#a63eab50bdd789005154d787035910277">sonde</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;       <a class="code" href="namespacecbl__module.html#a86a03f05040f82f59951951ed8feb92d">gamt_km</a>=0</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;       <a class="code" href="namespacecbl__module.html#a1ce0de96513d92e7be4a7b0318a7102a">gamq_kgkgm</a>=0</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">!adjusting qp and pm in case of saturation</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">qp_kgkg</a>.GT.qsatf(<a class="code" href="namespacecbl__module.html#a7b92d87a613cb13145b7c84beced7f67">tp_c</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>).OR.<a class="code" href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">qp_kgkg</a>.LT.0)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;       <a class="code" href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">qp_kgkg</a> = qsatf(<a class="code" href="namespacecbl__module.html#a7b92d87a613cb13145b7c84beced7f67">tp_c</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">qm_kgkg</a>.GT.qsatf(<a class="code" href="namespacecbl__module.html#a9981080497583b5953927b0a2bbdcde8">tm_c</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>).OR.<a class="code" href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">qm_kgkg</a>.LT.0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;       <a class="code" href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">qm_kgkg</a> = qsatf(<a class="code" href="namespacecbl__module.html#a9981080497583b5953927b0a2bbdcde8">tm_c</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">!    if((CBLuse==2).and.(zenith_deg&gt;=90))then</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">!    blh_m=188</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">!    endif</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    startflag=0</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#a2070c594a28f66b5ee4b95cd0251621e">cbl_initial</a></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#ada6e5e5cd6b578659b196bb8c26bd98c">nbl</a>(qh_use,qe_use,tm_K_zm,qm_gkg_zm,startflag,iMb,Gridiv)</div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="_b_l_u_e_w_s___c_b_l_8f95.html#ada6e5e5cd6b578659b196bb8c26bd98c">  401</a></span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemod__z.html">mod_z</a></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemod__k.html">mod_k</a></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacegas.html">gas</a></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacetime.html">time</a></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacedata__in.html">data_in</a></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacesues__data.html">sues_data</a></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacemoist.html">moist</a></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespaceallocatearray.html">allocatearray</a></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacedefaultnotused.html">defaultnotused</a></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacecbl__module.html">cbl_module</a></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacegis__data.html">gis_data</a></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="namespacewherewhen.html">wherewhen</a></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::qh_use,qe_use,tm_k_zm,qm_gkg_zm</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">REAL(KIND(1d0))</span>::qsatf,sat_vap_press,lv</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">INTEGER</span>::i,iMb,nLineDay,Gridiv,startflag</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    qh_use=<a class="code" href="namespacesues__data.html#a891cda3d0ef1f628e7dd9a185f00fc6c">qhforcbl</a>(gridiv)   <span class="comment">!HCW 21 Mar 2017</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    qe_use=<a class="code" href="namespacesues__data.html#a08451f44609cb386788368a9136432c7">qeforcbl</a>(gridiv)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">IF</span>(qh_use&lt;-900.OR.qe_use&lt;-900)<span class="keywordflow">THEN</span>  <span class="comment">! observed data has a problem</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(22,<span class="stringliteral">&#39;Unrealistic qh or qe_value for CBL.&#39;</span>,qh_use,qe_use,<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    nlineday=0</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">DO</span> i=1,<a class="code" href="namespacecbl__module.html#a5f768f5aae74fa7b0c2d66118fc71ba5">nlineindata</a></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;       <span class="keywordflow">IF</span> (int(<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(i,1))&lt;=<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          nlineday=nlineday+1</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keywordflow">       ENDIF</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordflow">    ENDDO</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">!Assume Theta and Q in the night constantly Equal to the ones in the morning for CBL to run</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">! seems incorrect initialisation</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">! tm_K=IniCBLdata(nLineDay,7)*1000</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">! qm_gkg=IniCBLdata(nLineDay,8)*1000</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">! corrected to the following, TS 20170609:</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,7)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,8)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">!NBL currently fixed to 200 m</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">blh_m</a>=200</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">! also fill in other variables</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="namespacecbl__module.html#a86a03f05040f82f59951951ed8feb92d">gamt_km</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,3)</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,4)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="namespacecbl__module.html#af9b1b9c8cf1a15dca9b8750920a048c3">tp_k</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,5)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="namespacecbl__module.html#a45208115b84dad98c55d11cf93307c0c">qp_gkg</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,6)</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,7)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,8)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>=<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>+1</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">! dataOutBL(iCBLcount,1:ncolumnsdataOutBL,Gridiv)=(/REAL(iy,8),REAL(id,8),REAL(it,8),REAL(imin,8),&amp;</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">! dectime,blh_m,tm_K,qm_gkg,&amp;</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">! (NAN,is=9,ncolumnsdataOutBL)/)</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>=<a class="code" href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">tm_k</a>/((1000/<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>)**(<a class="code" href="namespacegas.html#ac0aae13e9168fcb9f0f09f3559594b4d">gas_ct_dry</a>/<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>))-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>=sat_vap_press(<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>,1)</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    lv=(2500.25-2.365*<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>)*1000</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">!qm_gkg_zm=qm_gkg+cbldata(10)*cbldata(3)/(k*cbldata(8)*cbldata(4)*lv)</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>=100*((<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>*<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>/(622+<a class="code" href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">qm_gkg</a>))/<a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>) <span class="comment">!check pressure</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>&gt;100)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(34,<span class="stringliteral">&#39;subroutine CBL dectime, relative humidity&#39;</span>,<a class="code" href="namespacetime.html#acf0bd1b102769fcbe36a171b4b9e2a25">dectime</a>,<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>,100)</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;       <a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>=100</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="namespaceallocatearray.html#a668365934e66c156613eaf3027add7a4">dataoutbl</a>(<a class="code" href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">icblcount</a>,1:<a class="code" href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">ncolumnsdataoutbl</a>,gridiv)=&amp;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    (/<span class="keywordtype">REAL(iy,8)</span>,<span class="keywordtype">REAL(id,8)</span>,<span class="keywordtype">REAL(it,8)</span>,<span class="keywordtype">REAL(imin,8)</span>,dectime,&amp;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    blh_m,tm_K,qm_gkg,&amp;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    tp_K,qp_gkg,&amp;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    Temp_C,avrh,qh_use,qe_use,Press_hPa,avu1,ustar,avdens,lv_J_kg,avcp,&amp;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    gamt_Km,gamq_kgkgm/)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>==2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;       blh_m=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,2)</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;       gamt_km=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,3)</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;       <a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,4)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;       tp_k=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,5)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;       qp_gkg=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,6)</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;       tm_k=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,7)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;       qm_gkg=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,8)</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>==1 .AND. <a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,1)==<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>)<span class="keywordflow">THEN</span>   <span class="comment">! Changed from i to nlineDay, HCW 29 March 2017</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;       blh_m=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,2)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;       gamt_km=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,3)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;       <a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>=<a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(nlineday,4)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;       tm_k_zm=(temp_c+<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a>)*((1000/press_hpa)**(<a class="code" href="namespacegas.html#ac0aae13e9168fcb9f0f09f3559594b4d">gas_ct_dry</a>/avcp))</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;       tm_k=tm_k_zm-<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a>*qh_use/(<a class="code" href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">k</a>*ustar*avcp*avdens)</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;       <a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>=sat_vap_press(temp_c,press_hpa,1)</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;       qm_gkg_zm=622*avrh/(100*press_hpa/<a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>-avrh)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;       lv=(2500.25-2.365*temp_c)*1000</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;       qm_gkg=qm_gkg_zm-<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a>*qe_use/(<a class="code" href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">k</a>*ustar*avdens*lv)</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;       tp_k=tm_k</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;       qp_gkg=qm_gkg</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">initialdata_use</a>==0)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;       blh_m=241.5</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;       gamt_km=0.043</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;       <a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>=0.0092</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;       tm_k_zm=(temp_c+<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a>)*((1000/press_hpa)**(<a class="code" href="namespacegas.html#ac0aae13e9168fcb9f0f09f3559594b4d">gas_ct_dry</a>/avcp))</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;       tm_k=tm_k_zm-<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a>*qh_use/(<a class="code" href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">k</a>*ustar*avcp*avdens)</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;       <a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>=sat_vap_press(temp_c,press_hpa,1)</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;       qm_gkg_zm=622*avrh/(100*press_hpa/<a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>-avrh)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;       lv=(2500.25-2.365*temp_c)*1000</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;       qm_gkg=<a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>-<a class="code" href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">psyh</a>*qe_use/(<a class="code" href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">k</a>*ustar*avdens*lv)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;       tp_k=tm_k</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;       qp_gkg=qm_gkg</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    gamq_kgkgm=<a class="code" href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">gamq_gkgm</a>/1000.</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">qp_kgkg</a>=qp_gkg/1000    <span class="comment">!humidities: g/kg -&gt; kg/kg   q+</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">qm_kgkg</a>=qm_gkg/1000    <span class="comment">!conc at mixing layer height h</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="namespacecbl__module.html#a7b92d87a613cb13145b7c84beced7f67">tp_c</a>=tp_k-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="namespacecbl__module.html#a9981080497583b5953927b0a2bbdcde8">tm_c</a>=tm_k-<a class="code" href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">c2k</a></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">! IF(sondeflag==1 .AND. cblday(id)==1) THEN</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#a546f4ac8b1d6305356caf940d8e8e342">sondeflag</a>==1 .AND. <a class="code" href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">inicbldata</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,2)/=-999) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;       <span class="comment">!if gamma theta varies with z (selected by setting gthetaflag=1)</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;       <span class="comment">!if gamma q varies with z (selected by setting ghumflag=1)</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_b_l_u_e_w_s___diff_8f95.html#a63eab50bdd789005154d787035910277">sonde</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>)</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;       gamt_km=0</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;       gamq_kgkgm=0</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">!adjusting qp and pm in case of saturation</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">qp_kgkg</a>.GT.qsatf(<a class="code" href="namespacecbl__module.html#a7b92d87a613cb13145b7c84beced7f67">tp_c</a>,press_hpa).OR.<a class="code" href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">qp_kgkg</a>.LT.0)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;       <a class="code" href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">qp_kgkg</a> = qsatf(<a class="code" href="namespacecbl__module.html#a7b92d87a613cb13145b7c84beced7f67">tp_c</a>,press_hpa)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">qm_kgkg</a>.GT.qsatf(<a class="code" href="namespacecbl__module.html#a9981080497583b5953927b0a2bbdcde8">tm_c</a>,press_hpa).OR.<a class="code" href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">qm_kgkg</a>.LT.0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;       <a class="code" href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">qm_kgkg</a> = qsatf(<a class="code" href="namespacecbl__module.html#a9981080497583b5953927b0a2bbdcde8">tm_c</a>,press_hpa)</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    startflag=0</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#ada6e5e5cd6b578659b196bb8c26bd98c">nbl</a></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">!------------------------------------------------------------------------</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">!------------------------------------------------------------------------</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="keyword">  FUNCTION </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#a67036afb2f40fef682aefc6df6d0c311">qsatf</a>(T,PMB) <span class="keyword">RESULT</span>(qsat)</div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="_b_l_u_e_w_s___c_b_l_8f95.html#a67036afb2f40fef682aefc6df6d0c311">  538</a></span>&#160;    <span class="comment">!       MRR, 1987</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="comment">! AT TEMPERATURE T (DEG C) AND PRESSURE PMB (MB), GET SATURATION SPECIFIC</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">!       HUMIDITY (KG/KG) FROM TETEN FORMULA</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordtype">REAL (KIND(1D0))</span>::T,es,qsat,PMB</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordtype">REAL (KIND(1D0))</span>,<span class="keywordtype">PARAMETER</span>::&amp;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">!Teten coefficients</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    a=6.106,&amp;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    b=17.27,&amp;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    c=237.3,&amp;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    molar=0.028965,&amp; <span class="comment">!Dry air molar fraction in kg/mol</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;         molar_wat_vap=0.0180153 <span class="comment">!Molar fraction of water vapor in kg/mol</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">IF</span>(t.GT.55)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;       <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(34,<span class="stringliteral">&#39;Function qsatf&#39;</span>,t,0.00d0,notusedi)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="keywordflow">    ENDIF</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    es = a*dexp(b*t/(c+t))</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    qsat = (molar_wat_vap/molar)*es/pmb<span class="comment">!(rmh2o/rmair)*ES/PMB</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="keyword">  END FUNCTION </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#a67036afb2f40fef682aefc6df6d0c311">qsatf</a></div><div class="ttc" id="namespacedefaultnotused_html"><div class="ttname"><a href="namespacedefaultnotused.html">defaultnotused</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01137">LUMPS_Module_constants.f95:1137</a></div></div>
<div class="ttc" id="namespacedata__in_html_abf271c3057b02dd9183e4442954c9577"><div class="ttname"><a href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">data_in::avdens</a></div><div class="ttdeci">real(kind(1d0)) avdens</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacegas_html"><div class="ttname"><a href="namespacegas.html">gas</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01182">LUMPS_Module_constants.f95:1182</a></div></div>
<div class="ttc" id="namespaceinitial_html"><div class="ttname"><a href="namespaceinitial.html">initial</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00768">LUMPS_Module_constants.f95:768</a></div></div>
<div class="ttc" id="namespacecbl__module_html_aae12ee171bb6806332a07b9300284693"><div class="ttname"><a href="namespacecbl__module.html#aae12ee171bb6806332a07b9300284693">cbl_module::cbldata</a></div><div class="ttdeci">real(kind(1d0)), dimension(1:10) cbldata</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01051">LUMPS_Module_constants.f95:1051</a></div></div>
<div class="ttc" id="namespacecbl__module_html_aa9e98a57d9be62a92919841c4ad428b9"><div class="ttname"><a href="namespacecbl__module.html#aa9e98a57d9be62a92919841c4ad428b9">cbl_module::qm_kgkg</a></div><div class="ttdeci">real(kind(1d0)) qm_kgkg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacedata__in_html_a2c6cba95e27ebb1dcb673c457b66325d"><div class="ttname"><a href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">data_in::avrh</a></div><div class="ttdeci">real(kind(1d0)) avrh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacegis__data_html"><div class="ttname"><a href="namespacegis__data.html">gis_data</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01242">LUMPS_Module_constants.f95:1242</a></div></div>
<div class="ttc" id="namespacemod__k_html_a75bb9b4e883eadeb3233662441943aaf"><div class="ttname"><a href="namespacemod__k.html#a75bb9b4e883eadeb3233662441943aaf">mod_k::k</a></div><div class="ttdeci">real(kind(1d0)) k</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01169">LUMPS_Module_constants.f95:1169</a></div></div>
<div class="ttc" id="namespacedefaultnotused_html_a9ad6683bfdf839485292f0be53501f07"><div class="ttname"><a href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">defaultnotused::nan</a></div><div class="ttdeci">real(kind(1d0)) nan</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01139">LUMPS_Module_constants.f95:1139</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a3bb0811c2c1eb194eff7132bb1a906ef"><div class="ttname"><a href="namespacecbl__module.html#a3bb0811c2c1eb194eff7132bb1a906ef">cbl_module::fhbl_kms</a></div><div class="ttdeci">real(kind(1d0)) fhbl_kms</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a52c76c9e4368adec7890e95932374f73"><div class="ttname"><a href="namespacecbl__module.html#a52c76c9e4368adec7890e95932374f73">cbl_module::neqn</a></div><div class="ttdeci">integer neqn</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01055">LUMPS_Module_constants.f95:1055</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a5f768f5aae74fa7b0c2d66118fc71ba5"><div class="ttname"><a href="namespacecbl__module.html#a5f768f5aae74fa7b0c2d66118fc71ba5">cbl_module::nlineindata</a></div><div class="ttdeci">integer nlineindata</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01055">LUMPS_Module_constants.f95:1055</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a810011542edd41ab403379b2004c84ab"><div class="ttname"><a href="namespacecbl__module.html#a810011542edd41ab403379b2004c84ab">cbl_module::filesonde</a></div><div class="ttdeci">character(len=200), dimension(366) filesonde</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01048">LUMPS_Module_constants.f95:1048</a></div></div>
<div class="ttc" id="namespacedata__in_html_a8ac4d9de71d52d8c39e04c59635a5e3c"><div class="ttname"><a href="namespacedata__in.html#a8ac4d9de71d52d8c39e04c59635a5e3c">data_in::avkdn</a></div><div class="ttdeci">real(kind(1d0)) avkdn</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a5901bc487fe54be32f04988c42ab7443"><div class="ttname"><a href="namespacecbl__module.html#a5901bc487fe54be32f04988c42ab7443">cbl_module::cblday</a></div><div class="ttdeci">integer, dimension(366) cblday</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01046">LUMPS_Module_constants.f95:1046</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a546f4ac8b1d6305356caf940d8e8e342"><div class="ttname"><a href="namespacecbl__module.html#a546f4ac8b1d6305356caf940d8e8e342">cbl_module::sondeflag</a></div><div class="ttdeci">integer sondeflag</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01039">LUMPS_Module_constants.f95:1039</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a105bb269b58c37d9b6170f7aa3a74fbe"><div class="ttname"><a href="namespacecbl__module.html#a105bb269b58c37d9b6170f7aa3a74fbe">cbl_module::icblcount</a></div><div class="ttdeci">integer icblcount</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01055">LUMPS_Module_constants.f95:1055</a></div></div>
<div class="ttc" id="namespacecbl__module_html"><div class="ttname"><a href="namespacecbl__module.html">cbl_module</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01037">LUMPS_Module_constants.f95:1037</a></div></div>
<div class="ttc" id="namespacemod__k_html"><div class="ttname"><a href="namespacemod__k.html">mod_k</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01168">LUMPS_Module_constants.f95:1168</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a86a03f05040f82f59951951ed8feb92d"><div class="ttname"><a href="namespacecbl__module.html#a86a03f05040f82f59951951ed8feb92d">cbl_module::gamt_km</a></div><div class="ttdeci">real(kind(1d0)) gamt_km</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a0140016345794a8912c00aafaf50fe1e"><div class="ttname"><a href="namespacecbl__module.html#a0140016345794a8912c00aafaf50fe1e">cbl_module::isubs</a></div><div class="ttdeci">integer isubs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01039">LUMPS_Module_constants.f95:1039</a></div></div>
<div class="ttc" id="namespacemoist_html"><div class="ttname"><a href="namespacemoist.html">moist</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01219">LUMPS_Module_constants.f95:1219</a></div></div>
<div class="ttc" id="namespacedata__in_html_abc95201410a9b25f8d1d2d5a063302c3"><div class="ttname"><a href="namespacedata__in.html#abc95201410a9b25f8d1d2d5a063302c3">data_in::avu1</a></div><div class="ttdeci">real(kind(1d0)) avu1</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a904519e3dcaa1592e2506c840b8cc7e4"><div class="ttname"><a href="namespacecbl__module.html#a904519e3dcaa1592e2506c840b8cc7e4">cbl_module::entrainmenttype</a></div><div class="ttdeci">integer entrainmenttype</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01039">LUMPS_Module_constants.f95:1039</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a45208115b84dad98c55d11cf93307c0c"><div class="ttname"><a href="namespacecbl__module.html#a45208115b84dad98c55d11cf93307c0c">cbl_module::qp_gkg</a></div><div class="ttdeci">real(kind(1d0)) qp_gkg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___c_b_l_8f95_html_a67036afb2f40fef682aefc6df6d0c311"><div class="ttname"><a href="_b_l_u_e_w_s___c_b_l_8f95.html#a67036afb2f40fef682aefc6df6d0c311">qsatf</a></div><div class="ttdeci">real(kind(1d0)) function qsatf(T, PMB)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___c_b_l_8f95_source.html#l00538">BLUEWS_CBL.f95:538</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a45295cba02de86a1053db4c80f07ec19"><div class="ttname"><a href="namespaceallocatearray.html#a45295cba02de86a1053db4c80f07ec19">allocatearray::ncolumnsdataoutbl</a></div><div class="ttdeci">integer, parameter ncolumnsdataoutbl</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00042">LUMPS_Module_constants.f95:42</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___c_b_l_8f95_html_a2b7c9b5778366f3415268e6939cab229"><div class="ttname"><a href="_b_l_u_e_w_s___c_b_l_8f95.html#a2b7c9b5778366f3415268e6939cab229">cbl_readinputdata</a></div><div class="ttdeci">subroutine cbl_readinputdata</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___c_b_l_8f95_source.html#l00212">BLUEWS_CBL.f95:212</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___c_b_l_8f95_html_acde23a276c692f0ec2a493dc9720471c"><div class="ttname"><a href="_b_l_u_e_w_s___c_b_l_8f95.html#acde23a276c692f0ec2a493dc9720471c">cbl</a></div><div class="ttdeci">subroutine cbl(ifirst, iMB, Gridiv)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___c_b_l_8f95_source.html#l00009">BLUEWS_CBL.f95:9</a></div></div>
<div class="ttc" id="namespacesues__data_html"><div class="ttname"><a href="namespacesues__data.html">sues_data</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01273">LUMPS_Module_constants.f95:1273</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a652625bc960f05e00df2f7bf48cb7444"><div class="ttname"><a href="namespacecbl__module.html#a652625bc960f05e00df2f7bf48cb7444">cbl_module::qm_gkg</a></div><div class="ttdeci">real(kind(1d0)) qm_gkg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacemod__z_html"><div class="ttname"><a href="namespacemod__z.html">mod_z</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01197">LUMPS_Module_constants.f95:1197</a></div></div>
<div class="ttc" id="namespacecbl__module_html_ab5d6f31d2f9b523336fb0947a1e53707"><div class="ttname"><a href="namespacecbl__module.html#ab5d6f31d2f9b523336fb0947a1e53707">cbl_module::cm</a></div><div class="ttdeci">real(kind(1d0)) cm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacetime_html_abc3475e9770d0639f41dad7382bcb6d0"><div class="ttname"><a href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">time::id</a></div><div class="ttdeci">integer id</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01147">LUMPS_Module_constants.f95:1147</a></div></div>
<div class="ttc" id="namespacedata__in_html_aaac1000f5b2d5c88466c307795518d4c"><div class="ttname"><a href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">data_in::temp_c</a></div><div class="ttdeci">real(kind(1d0)) temp_c</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a9981080497583b5953927b0a2bbdcde8"><div class="ttname"><a href="namespacecbl__module.html#a9981080497583b5953927b0a2bbdcde8">cbl_module::tm_c</a></div><div class="ttdeci">real(kind(1d0)) tm_c</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacesues__data_html_a3422c30d52ea500ca138d13670403a50"><div class="ttname"><a href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">sues_data::ustar</a></div><div class="ttdeci">real(kind(1d0)) ustar</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespacetime_html_a9be08cae4e706325fe3524f4370754cc"><div class="ttname"><a href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">time::imin</a></div><div class="ttdeci">integer imin</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01147">LUMPS_Module_constants.f95:1147</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a7b92d87a613cb13145b7c84beced7f67"><div class="ttname"><a href="namespacecbl__module.html#a7b92d87a613cb13145b7c84beced7f67">cbl_module::tp_c</a></div><div class="ttdeci">real(kind(1d0)) tp_c</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacetime_html"><div class="ttname"><a href="namespacetime.html">time</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01146">LUMPS_Module_constants.f95:1146</a></div></div>
<div class="ttc" id="namespacecbl__module_html_ae82d92a08db006da8495afa687a74c6c"><div class="ttname"><a href="namespacecbl__module.html#ae82d92a08db006da8495afa687a74c6c">cbl_module::inicbldata</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:), allocatable inicbldata</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01052">LUMPS_Module_constants.f95:1052</a></div></div>
<div class="ttc" id="namespacegas_html_ac0aae13e9168fcb9f0f09f3559594b4d"><div class="ttname"><a href="namespacegas.html#ac0aae13e9168fcb9f0f09f3559594b4d">gas::gas_ct_dry</a></div><div class="ttdeci">real(kind(1d0)) gas_ct_dry</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01192">LUMPS_Module_constants.f95:1192</a></div></div>
<div class="ttc" id="namespacewherewhen_html"><div class="ttname"><a href="namespacewherewhen.html">wherewhen</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l02097">LUMPS_Module_constants.f95:2097</a></div></div>
<div class="ttc" id="namespacecbl__module_html_ad06cbd2f8723521c7d20e7d57ebe0f9c"><div class="ttname"><a href="namespacecbl__module.html#ad06cbd2f8723521c7d20e7d57ebe0f9c">cbl_module::initialdata_use</a></div><div class="ttdeci">integer initialdata_use</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01039">LUMPS_Module_constants.f95:1039</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___diff_8f95_html_a63eab50bdd789005154d787035910277"><div class="ttname"><a href="_b_l_u_e_w_s___diff_8f95.html#a63eab50bdd789005154d787035910277">sonde</a></div><div class="ttdeci">subroutine sonde(id)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___diff_8f95_source.html#l00229">BLUEWS_Diff.f95:229</a></div></div>
<div class="ttc" id="namespacecbl__module_html_acdfa6106091fdfa93a6cab25af3d0f1a"><div class="ttname"><a href="namespacecbl__module.html#acdfa6106091fdfa93a6cab25af3d0f1a">cbl_module::wsb</a></div><div class="ttdeci">real(kind(1d0)) wsb</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01050">LUMPS_Module_constants.f95:1050</a></div></div>
<div class="ttc" id="namespacesues__data_html_ac6af955be55f5fe026b4ba1ab6ec480e"><div class="ttname"><a href="namespacesues__data.html#ac6af955be55f5fe026b4ba1ab6ec480e">sues_data::tstep</a></div><div class="ttdeci">integer tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01276">LUMPS_Module_constants.f95:1276</a></div></div>
<div class="ttc" id="namespacesues__data_html_a2333d97226ad99ef4b17125ad7c3b205"><div class="ttname"><a href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">sues_data::qh_choice</a></div><div class="ttdeci">integer qh_choice</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01408">LUMPS_Module_constants.f95:1408</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a295b5b9a6a2d8808cba5c386dd4ed2e6"><div class="ttname"><a href="namespacecbl__module.html#a295b5b9a6a2d8808cba5c386dd4ed2e6">cbl_module::c2k</a></div><div class="ttdeci">real(kind(1d0)) c2k</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01059">LUMPS_Module_constants.f95:1059</a></div></div>
<div class="ttc" id="namespacesues__data_html_a08451f44609cb386788368a9136432c7"><div class="ttname"><a href="namespacesues__data.html#a08451f44609cb386788368a9136432c7">sues_data::qeforcbl</a></div><div class="ttdeci">real(kind(1d0)), dimension(:), allocatable qeforcbl</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01407">LUMPS_Module_constants.f95:1407</a></div></div>
<div class="ttc" id="namespaceallocatearray_html"><div class="ttname"><a href="namespaceallocatearray.html">allocatearray</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00016">LUMPS_Module_constants.f95:16</a></div></div>
<div class="ttc" id="namespacemoist_html_a59a8f410cf3ebfe343d9c01b5dbb2cf8"><div class="ttname"><a href="namespacemoist.html#a59a8f410cf3ebfe343d9c01b5dbb2cf8">moist::lv_j_kg</a></div><div class="ttdeci">real(kind(1d0)) lv_j_kg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacesues__data_html_a6d5d62e6767411fff0b1641fe6cbf1f9"><div class="ttname"><a href="namespacesues__data.html#a6d5d62e6767411fff0b1641fe6cbf1f9">sues_data::psyh</a></div><div class="ttdeci">real(kind(1d0)) psyh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespacesues__data_html_a38a6478771abe06a6cf4334fe858c0ef"><div class="ttname"><a href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">sues_data::is</a></div><div class="ttdeci">integer is</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01295">LUMPS_Module_constants.f95:1295</a></div></div>
<div class="ttc" id="namespacecbl__module_html_afb21accdfbc0b24e12b24a44ffd9d6d1"><div class="ttname"><a href="namespacecbl__module.html#afb21accdfbc0b24e12b24a44ffd9d6d1">cbl_module::tm_k</a></div><div class="ttdeci">real(kind(1d0)) tm_k</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a3d7f7d5671cd679f69c81da2fbf797e2"><div class="ttname"><a href="namespacecbl__module.html#a3d7f7d5671cd679f69c81da2fbf797e2">cbl_module::y</a></div><div class="ttdeci">real(kind(1d0)), dimension(6) y</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01088">LUMPS_Module_constants.f95:1088</a></div></div>
<div class="ttc" id="namespacedata__in_html_a67f60bb1f8edd3c6be5380ab655fe7f1"><div class="ttname"><a href="namespacedata__in.html#a67f60bb1f8edd3c6be5380ab655fe7f1">data_in::fileinputpath</a></div><div class="ttdeci">character(len=150) fileinputpath</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00821">LUMPS_Module_constants.f95:821</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a6aab251dd8f51c9cd6a8dc723a99fdf3"><div class="ttname"><a href="namespacecbl__module.html#a6aab251dd8f51c9cd6a8dc723a99fdf3">cbl_module::gamq_gkgm</a></div><div class="ttdeci">real(kind(1d0)) gamq_gkgm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacesues__data_html_a891cda3d0ef1f628e7dd9a185f00fc6c"><div class="ttname"><a href="namespacesues__data.html#a891cda3d0ef1f628e7dd9a185f00fc6c">sues_data::qhforcbl</a></div><div class="ttdeci">real(kind(1d0)), dimension(:), allocatable qhforcbl</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01407">LUMPS_Module_constants.f95:1407</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a20477a72c625deb14eccf5e2cd767d95"><div class="ttname"><a href="namespacecbl__module.html#a20477a72c625deb14eccf5e2cd767d95">cbl_module::blh_m</a></div><div class="ttdeci">real(kind(1d0)) blh_m</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacedata__in_html"><div class="ttname"><a href="namespacedata__in.html">data_in</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00813">LUMPS_Module_constants.f95:813</a></div></div>
<div class="ttc" id="namespacecbl__module_html_abece0fd4503899af7cb75b51be8b5e63"><div class="ttname"><a href="namespacecbl__module.html#abece0fd4503899af7cb75b51be8b5e63">cbl_module::fcbl</a></div><div class="ttdeci">real(kind(1d0)) fcbl</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01061">LUMPS_Module_constants.f95:1061</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a1fe4af3f4b8ea35de69189177bcc9d5d"><div class="ttname"><a href="namespacecbl__module.html#a1fe4af3f4b8ea35de69189177bcc9d5d">cbl_module::co2_included</a></div><div class="ttdeci">integer co2_included</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01039">LUMPS_Module_constants.f95:1039</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___diff_8f95_html_aa6b01ddf379446848f8a822a7918fcd0"><div class="ttname"><a href="_b_l_u_e_w_s___diff_8f95.html#aa6b01ddf379446848f8a822a7918fcd0">rkutta</a></div><div class="ttdeci">subroutine rkutta(neqn, XA, XB, Y, NSTEPS)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___diff_8f95_source.html#l00007">BLUEWS_Diff.f95:7</a></div></div>
<div class="ttc" id="namespacesues__data_html_ab2070158f8b88b8f7835232841061718"><div class="ttname"><a href="namespacesues__data.html#ab2070158f8b88b8f7835232841061718">sues_data::nsh_real</a></div><div class="ttdeci">real(kind(1d0)) nsh_real</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01283">LUMPS_Module_constants.f95:1283</a></div></div>
<div class="ttc" id="namespacetime_html_a88a6c141593462330d65da0397b9b71d"><div class="ttname"><a href="namespacetime.html#a88a6c141593462330d65da0397b9b71d">time::it</a></div><div class="ttdeci">integer it</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01147">LUMPS_Module_constants.f95:1147</a></div></div>
<div class="ttc" id="namespacetime_html_acf0bd1b102769fcbe36a171b4b9e2a25"><div class="ttname"><a href="namespacetime.html#acf0bd1b102769fcbe36a171b4b9e2a25">time::dectime</a></div><div class="ttdeci">real(kind(1d0)) dectime</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01153">LUMPS_Module_constants.f95:1153</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___diff_8f95_html_a27fc32bfb9bfb2d6e21511c2e8c9bfed"><div class="ttname"><a href="_b_l_u_e_w_s___diff_8f95.html#a27fc32bfb9bfb2d6e21511c2e8c9bfed">gamma_sonde</a></div><div class="ttdeci">subroutine gamma_sonde</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___diff_8f95_source.html#l00263">BLUEWS_Diff.f95:263</a></div></div>
<div class="ttc" id="namespacemoist_html_ab97dbf8fcbd5d11d712712430254200c"><div class="ttname"><a href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">moist::avcp</a></div><div class="ttdeci">real(kind(1d0)) avcp</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacedata__in_html_a03eea39f7275fe19868636524b857b6d"><div class="ttname"><a href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">data_in::press_hpa</a></div><div class="ttdeci">real(kind(1d0)) press_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacecbl__module_html_add8682c29dcc92f528e2894dd1e16f39"><div class="ttname"><a href="namespacecbl__module.html#add8682c29dcc92f528e2894dd1e16f39">cbl_module::initialdatafilename</a></div><div class="ttdeci">character(len=200) initialdatafilename</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01049">LUMPS_Module_constants.f95:1049</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a668365934e66c156613eaf3027add7a4"><div class="ttname"><a href="namespaceallocatearray.html#a668365934e66c156613eaf3027add7a4">allocatearray::dataoutbl</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:,:), allocatable dataoutbl</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00109">LUMPS_Module_constants.f95:109</a></div></div>
<div class="ttc" id="namespacecbl__module_html_af9b1b9c8cf1a15dca9b8750920a048c3"><div class="ttname"><a href="namespacecbl__module.html#af9b1b9c8cf1a15dca9b8750920a048c3">cbl_module::tp_k</a></div><div class="ttdeci">real(kind(1d0)) tp_k</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a5b2329a6a103326f5fa08282787d83aa"><div class="ttname"><a href="namespacecbl__module.html#a5b2329a6a103326f5fa08282787d83aa">cbl_module::febl_kgkgms</a></div><div class="ttdeci">real(kind(1d0)) febl_kgkgms</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a19585b12b6f9726bfbda1954703b7b4d"><div class="ttname"><a href="namespacecbl__module.html#a19585b12b6f9726bfbda1954703b7b4d">cbl_module::qp_kgkg</a></div><div class="ttdeci">real(kind(1d0)) qp_kgkg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="namespacemoist_html_a711adf6d19a4bb7b9a6c55d39dd5357b"><div class="ttname"><a href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">moist::es_hpa</a></div><div class="ttdeci">real(kind(1d0)) es_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="_s_u_e_w_s__error_8f95_html_ac54090fb3ca221d8f45ec0a2a714e6c9"><div class="ttname"><a href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a></div><div class="ttdeci">subroutine errorhint(errh, ProblemFile, VALUE, value2, valueI)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s__error_8f95_source.html#l00002">SUEWS_error.f95:2</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a1ce0de96513d92e7be4a7b0318a7102a"><div class="ttname"><a href="namespacecbl__module.html#a1ce0de96513d92e7be4a7b0318a7102a">cbl_module::gamq_kgkgm</a></div><div class="ttdeci">real(kind(1d0)) gamq_kgkgm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___c_b_l_8f95_html_a2070c594a28f66b5ee4b95cd0251621e"><div class="ttname"><a href="_b_l_u_e_w_s___c_b_l_8f95.html#a2070c594a28f66b5ee4b95cd0251621e">cbl_initial</a></div><div class="ttdeci">subroutine cbl_initial(qh_use, qe_use, tm_K_zm, qm_gkg_zm, startflag, iMB, Gridiv)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___c_b_l_8f95_source.html#l00277">BLUEWS_CBL.f95:277</a></div></div>
<div class="ttc" id="namespacecbl__module_html_a19dd722436e710830c7ff6b961753c62"><div class="ttname"><a href="namespacecbl__module.html#a19dd722436e710830c7ff6b961753c62">cbl_module::blh1_m</a></div><div class="ttdeci">real(kind(1d0)) blh1_m</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01063">LUMPS_Module_constants.f95:1063</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___c_b_l_8f95_html_ada6e5e5cd6b578659b196bb8c26bd98c"><div class="ttname"><a href="_b_l_u_e_w_s___c_b_l_8f95.html#ada6e5e5cd6b578659b196bb8c26bd98c">nbl</a></div><div class="ttdeci">subroutine nbl(qh_use, qe_use, tm_K_zm, qm_gkg_zm, startflag, iMb, Gridiv)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___c_b_l_8f95_source.html#l00401">BLUEWS_CBL.f95:401</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
