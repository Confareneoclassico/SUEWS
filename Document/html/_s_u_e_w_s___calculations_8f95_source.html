<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SUEWS-AnOHM: SUEWS_Calculations.f95 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SUEWS-AnOHM
   &#160;<span id="projectnumber">0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">SUEWS_Calculations.f95</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_s_u_e_w_s___calculations_8f95.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!This subroutine does the actual calculations of the SUEWS code (mostly old SUEWS_Temporal).</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!Made by LJ and HW Oct 2014</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!Gives in the grid ID (Gridiv) and number of line in the met forcing data to be analyzed (ir)</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!Last modification</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!Last modification:</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">! LJ  15 Jun 2017 - Add parts where NonWaterFraction=0 is used as a divider so that the code won&#39;t crash with 100% water</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">! TS  20 May 2017 - Add surface-level diagonostics: T2, Q2, U10</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">! HCW 09 Dec 2016 - Add zenith and azimuth to output file</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">! HCw 24 Aug 2016 - smd and state for each surface set to NAN in output file if surface does not exist.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!                 - Added Fc to output file</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">! HCW 21 Jul 2016 - Set soil variables to -999 in output when grid is 100% water surface.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">! HCW 29 Jun 2016 - Commented out StateDay and SoilMoistDay as creates jumps and should not be needed.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!                   Would not work unless each met block consists of a whole day for each grid.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">! TS 09 Mar 2016  - Added AnOHM subroutine to calculate heat storage</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">! HCW 10 Mar 2016 - Calculation of soil moisture deficit of vegetated surfaces added (vsmd)</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">! LJ 2 Jan 2016   - Calculation of snow fraction moved from SUEWS_Calculations to SUEWS_Snow</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">! HCW 12 Nov 2015 - Added z0m and zdm to output file</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">! HCW 05 Nov 2015 - Changed Kawai et al. (2007) z0v calculation so VegFraction(veg+soil) rather than veg_fr(veg+soil+water) is used.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">! HCW 29 Jun 2015 - Added albEveTr and albGrass</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">! HCW 25 Jun 2015 - Fixed bug in LAI calculation at year change.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!                 - Changed AlbDec to use id value (not (id-1) value) to avoid issues at year change.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">! HCW 27 Apr 2015 - Correction to tot_chang_per_tstep calculation (water balance should now close)</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">! HCW 16 Feb 2015 - Updated water balance calculations</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!                 - Corrected area-averaged calculations (soil moisture, drain, two versions of state with/out water)</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">!                 - Replaced soilmoist_state variable with soilstate (as seems to be duplicate)</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">! HCW 15 Jan 2015 - Added switch OHMIncQF to calculate QS with (1, default) or without (0) QF added to QSTAR</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">! To do</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">!      - add iy and imin to output files (may impact LUMPS_RunoffFromGrid)</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">!      - phase out _per_interval water balance variables</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">!      - renormalise by NonWaterFraction where necessary</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">!      - Update Snow subroutines similarly in terms of water balance</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">!==================================================================</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">SUBROUTINE </span><a class="code" href="_s_u_e_w_s___calculations_8f95.html#a178f1acf059ccbc65e48be6eb7f37baf">suews_calculations</a>(Gridiv,ir,iMB,irMax)</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="_s_u_e_w_s___calculations_8f95.html#a178f1acf059ccbc65e48be6eb7f37baf">   36</a></span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacedata__in.html">data_in</a></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacetime.html">time</a></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacenarp__module.html">narp_module</a></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacedefaultnotused.html">defaultnotused</a></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespaceallocatearray.html">allocatearray</a></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacesues__data.html">sues_data</a></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacesnowmod.html">snowmod</a></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacegis__data.html">gis_data</a></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespaceinitial.html">initial</a></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacemoist.html">moist</a></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacemod__z.html">mod_z</a></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacemod__k.html">mod_k</a></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacesolweig__module.html">solweig_module</a></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespacewherewhen.html">wherewhen</a></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="namespaceanohm__module.html">anohm_module</a></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">INTEGER</span>        :: Gridiv,ir,i,ih,iMB</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">LOGICAL</span>        :: debug=.false.</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">REAL(KIND(1d0))</span>:: idectime</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">!real(kind(1d0)):: SnowDepletionCurve  !for SUEWS_Snow - not needed here (HCW 24 May 2016)</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">REAL(KIND(1d0))</span>:: lai_wt,qsatf</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordtype">INTEGER</span>        :: irMax</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">!==================================================================</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">!==================================================================</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">!Translate all data to the variables used in the model calculations</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SUEWS_Translate...&#39;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__translate_8f95.html#abf8ea565715e31244a76de2908c9fc4b">suews_translate</a>(gridiv,ir,imb)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">! ! load the final water states of the previous day to keep water balance, by TS 13 Apr 2016</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">! IF ( ir==1 ) THEN</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">!      PRINT*, &#39;********************************&#39;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">!      PRINT*, &#39;starting state of&#39;, id,it,imin</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">!    state(1:nsurf)     = stateDay(id-1,Gridiv,1:nsurf)</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">!    soilmoist(1:nsurf) = soilmoistDay(id-1,Gridiv,1:nsurf)</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">!      PRINT*, &#39;state:&#39;, state</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">!      PRINT*, &#39;soilmoist&#39;, soilmoist</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">! END IF</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling RoughnessParameters...&#39;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">! CALL RoughnessParameters(Gridiv) ! Added by HCW 11 Nov 2014</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___roughness_parameters_8f95.html#af045b298f2d6ed45fbb8ba93a81d9568">roughnessparameters</a>(&amp;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       <a class="code" href="namespacedata__in.html#ae0baee62dbc6ad6a70c51f5eb1c1882b">roughlenmommethod</a>,&amp;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;       <a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,&amp; <span class="comment">! number of surface types</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;       <a class="code" href="namespaceallocatearray.html#a5a6ce5dda0d024d7333d95ba544f38c9">pavsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       <a class="code" href="namespaceallocatearray.html#afbbcbdfd67c32839a537f74d1bc6ff5a">bldgsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;       <a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;       <a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;       <a class="code" href="namespaceallocatearray.html#a570d73b34ec4b42f6f6075640a282619">bsoilsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;       <a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       <a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;       <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,&amp;<span class="comment">! surface fractions</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;       <a class="code" href="namespacegis__data.html#a59a6c27dbdfd939e15369ac064221241">areazh</a>,&amp;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       <a class="code" href="namespacegis__data.html#a2a0cc85bf87fdf807e528acb5c7b0740">bldgh</a>,&amp;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;       <a class="code" href="namespacegis__data.html#a2eab7550922ec226bac9160b71203e83">evetreeh</a>,&amp;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;       <a class="code" href="namespacegis__data.html#a4f60c63599a3076e7b8ffabbcaa57405">dectreeh</a>,&amp;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;       <a class="code" href="namespaceallocatearray.html#ad6779574483b9977e34962301653f997">porosity</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>),&amp;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;       <a class="code" href="namespacegis__data.html#a23e18e9f568ef5a47ed3b37826c9f7f3">faibldg</a>,<a class="code" href="namespacegis__data.html#a78a214dccb2ce0e8d532e514bd05927f">faievetree</a>,<a class="code" href="namespacegis__data.html#ae57a4a8a22280d3953006ba6e242c5be">faidectree</a>,<a class="code" href="namespacemod__z.html#a64eb68f633930155dd1415ee7f3e9d5c">z</a>,&amp;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;       <a class="code" href="namespacesues__data.html#a0489c46c970c2dd6ecdf0af0e11dee21">planf</a>,&amp;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;       <a class="code" href="namespacesues__data.html#a738f60744a0e91f90a050542ad946898">zh</a>,<a class="code" href="namespacemod__z.html#afd15a8bab419b8b576ccd3fa639d546f">z0m</a>,<a class="code" href="namespacemod__z.html#a85318ac2a4eb1313fc10432ff860214e">zdm</a>,<a class="code" href="namespacemod__z.html#ac1314dbe1ed7b4c92c501ced67f725c3">zzd</a>&amp;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       )</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="comment">!=============Get data ready for the qs calculation====================</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a0b433ad2361360f657c537b128e4a5f7">netradiationmethod</a>==0) <span class="keywordflow">THEN</span> <span class="comment">!Radiative components are provided as forcing</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;     <span class="comment">!avkdn=NAN                  !Needed for resistances for SUEWS.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;     <a class="code" href="namespacedata__in.html#a7be43e97ab4efa32b57c8f6b6b5949b7">ldown</a>     = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;     <a class="code" href="namespacedata__in.html#a5a2c23ecc11fe337a954cca86be6e0ce">lup</a>       = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;     <a class="code" href="namespacedata__in.html#a5d9f4f79563d2e000333219a4d2f4c99">kup</a>       = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;     <a class="code" href="namespacedata__in.html#a743440f75d11d6596e13e18b78d7f531">tsurf</a>     = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     <a class="code" href="namespaceallocatearray.html#abe02f0b83f99a74be1c1133b86872599">lup_ind</a>   = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;     <a class="code" href="namespaceallocatearray.html#ad56cceda5c3f4f010df2d55ce5a8e031">kup_ind</a>   = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;     <a class="code" href="namespaceallocatearray.html#a8ff59bff050fb421cbb0626422a102c6">tsurf_ind</a> = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;     <a class="code" href="namespaceallocatearray.html#ae1c8dcf595053e7c0c88f68acf975058">qn1_ind</a>   = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;     <a class="code" href="namespacedata__in.html#a8afa15b03c067e57c570544bd5562ac1">fcld</a>      = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a7ee5c5c530300f6627f86b6cbde2d5b9">ldown_option</a>==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;     <a class="code" href="namespacedata__in.html#a8afa15b03c067e57c570544bd5562ac1">fcld</a> = <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">!=====================================================================</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">! Initialisation for OAF&#39;s water bucket scheme</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">! LUMPS only (Loridan et al. (2012))</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="namespacedata__in.html#aaacec9be1e147ab0d69fee857ecd57cd">rainres</a> = 0.</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="namespacedata__in.html#a959499405172092dfb8d49b61bfec809">rainbucket</a> = 0.</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="namespacedata__in.html#a737780f5cf53c9f2d3048bbfface32cd">e_mod</a>=0 <span class="comment">!RAIN24HR = 0.;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">!=====================================================================</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">!Initialize variables calculated at each 5-min timestep</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="namespacesues__data.html#ac2654954c97c2cbba667e51f44850250">runoffagveg</a>             = 0</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="namespacesues__data.html#ac376fe6389c7367c307fce12d816009c">runoffagimpervious</a>      = 0</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="namespacesues__data.html#a0fce415bc7210db0cfe37ded2d8c1ef5">runoffwaterbody</a>         = 0</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="namespacesues__data.html#a3b42551207483efdea0f50bba253afe4">runoffsoil_per_tstep</a>    = 0</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="namespacesues__data.html#ae3658e6cd4c5115a1a9f8ea57cf6f6b1">runoffsoil_per_interval</a> = 0</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="namespacesues__data.html#af62ec721dfd084ec5bce9224750e1330">chsnow_per_interval</a>     = 0</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="namespacesnowmod.html#a7e8123e5b32bedfb676ea5c6ca62272a">mwh</a>                     = 0 <span class="comment">!Initialize snow melt and heat related to snowmelt</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="namespacesnowmod.html#a67018a3202a62ad0d4e7715dbfcf5e50">fwh</a>                     = 0</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="namespacesnowmod.html#a1d7e7d0b8974783e0320cde393e09594">qm</a>                      = 0 <span class="comment">!Heat related to melting/freezing</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="namespacesnowmod.html#adbb58215814d438f2486f880958737be">qmfreez</a>                 = 0</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="namespacesnowmod.html#a35fe883b6ebd9767f44c27354160afd3">qmrain</a>                  = 0</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="namespaceallocatearray.html#aa072ff6c84e33695ad3f23bc7608a022">mw_ind</a>                  = 0</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="namespaceallocatearray.html#a2aa940f81b7bfe5c4815dd2d15e5c734">snowdepth</a>               = 0</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="namespacesnowmod.html#ab1cf232aa719c4c447ac11c210889e66">zf</a>                      = 0</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="namespaceallocatearray.html#aca62321fa80aef03d41d2ed66f3ade3a">deltaqi</a>                 = 0</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="namespacesnowmod.html#a216f7ed83c0474b708443eddfa6c574e">swe</a>                     = 0</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="namespacesnowmod.html#affe56e4e5f1d5df5d7f4bbae7ae22541">mwstore</a>                 = 0</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="namespacesnowmod.html#a8cda7b30a924d03ee30f2bde6c9e41bc">waterholdcapfrac</a>        = 0</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="namespacedata__in.html#ade512e4aad4c64404e1c974241c965e7">qh</a> = -999 <span class="comment">! Added HCW 26 Feb 2015</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="namespacesues__data.html#ae76235b1ac6a388886f63eb27a0905dd">h</a>  = -999 <span class="comment">! Added HCW 26 Feb 2015</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">! Calculate sun position</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  idectime=<a class="code" href="namespacetime.html#acf0bd1b102769fcbe36a171b4b9e2a25">dectime</a>-<a class="code" href="namespacesues__data.html#a6e2f669999914372fd2de922c917e6dc">halftimestep</a><span class="comment">! sun position at middle of timestep before</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling sun_position...&#39;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_n_a_r_p__sun__position__v2_8f95.html#a2b388ff5a9cd5447020b0ef32065c86b">sun_position</a>(&amp;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                <span class="comment">!input:</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       <a class="code" href="namespacedata__in.html#a491ee3189141ae36fd29fde5cc020b53">year</a>,idectime,<a class="code" href="namespacedata__in.html#ae7c74e8cbd3c208e00306eafe50a98c0">timezone</a>,<a class="code" href="namespacedata__in.html#a364ff1ce2a4c78ea431e4dacbd66d6b4">lat</a>,<a class="code" href="namespacedata__in.html#a3604b533bd06593307e185fbbee27efb">lng</a>,<a class="code" href="namespacedata__in.html#a1f542f63d48efee0cd1e356f9f3ea1cf">alt</a>,&amp;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                <span class="comment">!output:</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       <a class="code" href="namespacedata__in.html#a0abb9aefbb8c1dc5ac6ff2f770da7faa">azimuth</a>,<a class="code" href="namespacedata__in.html#a332530944dd5c37316f92c3c74350e83">zenith_deg</a>)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="comment">!write(*,*) DateTime, timezone,lat,lng,alt,azimuth,zenith_deg</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a0baf7befb79fdeb3a9b4a5107f64d25c">cbluse</a>&gt;=1)<span class="keywordflow">THEN</span> <span class="comment">! If CBL is used, calculated Temp_C and RH are replaced with the obs.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling CBL...&#39;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;     <span class="keyword">CALL </span><a class="code" href="_b_l_u_e_w_s___c_b_l_8f95.html#acde23a276c692f0ec2a493dc9720471c">cbl</a>(ir,imb,gridiv)   <span class="comment">!ir=1 indicates first row of each met data block</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">!Call the dailystate routine to get surface characteristics ready</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling DailyState...&#39;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___daily_state_8f95.html#a29739ac43530dcb073d83e8c57f81778">dailystate</a>(gridiv)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a3c3027e7975cd18122a58ae965ee0f86">laicalcyes</a>==0)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;     <a class="code" href="namespaceallocatearray.html#ab660d7e4ca340b0b677a74ecb8bb34f4">lai</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1,:)=<a class="code" href="namespacedata__in.html#af9683d39e50e85ff167afd46236c7643">lai_obs</a> <span class="comment">! check -- this is going to be a problem as it is not for each vegetation class</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">!Calculation of density and other water related parameters</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling atmos_moist_lumps...&#39;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_l_u_m_p_s__atmos__functions__moist_8f95.html#ae6aae41b4a8fe866a54025d8fbc439d2">atmos_moist_lumps</a>(&amp;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;       <a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>,<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>,<a class="code" href="namespacetime.html#acf0bd1b102769fcbe36a171b4b9e2a25">dectime</a>,&amp;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;       <a class="code" href="namespacemoist.html#a59a8f410cf3ebfe343d9c01b5dbb2cf8">lv_j_kg</a>,<a class="code" href="namespacesnowmod.html#aa988f82274f056c6d2f7ed3d37457b24">lvs_j_kg</a>,&amp;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;       <a class="code" href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">es_hpa</a>,&amp;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;       <a class="code" href="namespacemoist.html#a19f55d056cfde820ca8beafe774a0688">ea_hpa</a>,&amp;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       <a class="code" href="namespacemoist.html#aad393ebb822062a86d42176ac76b30ad">vpd_hpa</a>,&amp;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;       <a class="code" href="namespacemoist.html#a86ab3b130c4af24cd94e0859a73c58e6">vpd_pa</a>,&amp;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;       <a class="code" href="namespacemoist.html#ac54b9750ff8d2f544e3706dc3c7ea73d">dq</a>,&amp;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;       <a class="code" href="namespacemoist.html#a86e17481beeffe41b498ff747fc52360">dens_dry</a>,&amp;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;       <a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>,&amp;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;       <a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">!======== Calculate soil moisture =========</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="namespacesues__data.html#ada5a214d0c4d5da587baa5f8de1da6d9">soilmoistcap</a>=0   <span class="comment">!Maximum capacity of soil store [mm] for whole surface</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>=0      <span class="comment">!Area-averaged soil moisture [mm] for whole surface</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>/=0) <span class="keywordflow">THEN</span> <span class="comment">!Soil states only calculated if soil exists. LJ June 2017</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;     <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>-1   <span class="comment">!No water body included</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="namespacesues__data.html#ada5a214d0c4d5da587baa5f8de1da6d9">soilmoistcap</a>=<a class="code" href="namespacesues__data.html#ada5a214d0c4d5da587baa5f8de1da6d9">soilmoistcap</a>+(<a class="code" href="namespaceallocatearray.html#a1c0a391fbf8e63a46d93cae2c6c11049">soilstorecap</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)/<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>=<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>+(<a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)/<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordflow">     ENDDO</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">!If loop removed HCW 26 Feb 2015</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">!if (ir==1) then  !Calculate initial smd</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="namespacesues__data.html#ac73de7c829233718bfd143f4346adf70">smd</a>=<a class="code" href="namespacesues__data.html#ada5a214d0c4d5da587baa5f8de1da6d9">soilmoistcap</a>-<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">!endif</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">! Calculate soil moisture for vegetated surfaces only (for use in surface conductance)</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="namespacesues__data.html#adfce8b9e1538d8a1629df9963a7a6df0">vsmd</a>=0</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=<a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>,<a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>  <span class="comment">!Vegetated surfaces only</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;     <span class="keywordflow">IF</span> ( <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>) + <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>) + <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>) ==0 ) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="namespacesues__data.html#adfce8b9e1538d8a1629df9963a7a6df0">vsmd</a>=0</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="namespacesues__data.html#adfce8b9e1538d8a1629df9963a7a6df0">vsmd</a>=<a class="code" href="namespacesues__data.html#adfce8b9e1538d8a1629df9963a7a6df0">vsmd</a>+(<a class="code" href="namespaceallocatearray.html#a1c0a391fbf8e63a46d93cae2c6c11049">soilstorecap</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>) - <a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>))*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)/(<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>) + <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>) + <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>))</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordflow">     END IF</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;     <span class="comment">!write(*,*) is, vsmd, smd</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="keywordflow">  ENDDO</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">! ===================NET ALLWAVE RADIATION================================</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a0b433ad2361360f657c537b128e4a5f7">netradiationmethod</a>&gt;0)<span class="keywordflow">THEN</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;     <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">snowuse</a>==0) <a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>=<a class="code" href="namespacedata__in.html#ac93d21776972756112d04651ac3cbb22">snow_obs</a></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a7ee5c5c530300f6627f86b6cbde2d5b9">ldown_option</a>==1) <span class="keywordflow">THEN</span> <span class="comment">!Observed ldown provided as forcing</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="namespacedata__in.html#a7be43e97ab4efa32b57c8f6b6b5949b7">ldown</a>=<a class="code" href="namespacedata__in.html#ad5a6e580db1d91b3cbb617a2bbee8d93">ldown_obs</a></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="namespacedata__in.html#a7be43e97ab4efa32b57c8f6b6b5949b7">ldown</a>=-9              <span class="comment">!to be filled in NARP</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keywordflow">     ENDIF</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a7ee5c5c530300f6627f86b6cbde2d5b9">ldown_option</a>==2) <span class="keywordflow">THEN</span> <span class="comment">!observed cloud fraction provided as forcing</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="namespacedata__in.html#a8afa15b03c067e57c570544bd5562ac1">fcld</a>=<a class="code" href="namespacedata__in.html#a03109ad2e583af2eb4b59e2e95758a72">fcld_obs</a></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keywordflow">     ENDIF</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;     <span class="comment">!write(*,*) DecidCap(id), id, it, imin, &#39;Calc - near start&#39;</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;     <span class="comment">! Update variables that change daily and represent seasonal variability</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;     <a class="code" href="namespaceallocatearray.html#ad49963261e823b38b1d9e6dad29978bd">alb</a>(<a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>)    = <a class="code" href="namespaceallocatearray.html#ac2b3eb71556f66b5cb4a91b0b0e8d6d3">albdectr</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>) <span class="comment">!Change deciduous albedo</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;     <a class="code" href="namespaceallocatearray.html#a25ebdf393dee2419f983b4ac7d2bf2e9">surf</a>(6,<a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>) = <a class="code" href="namespaceallocatearray.html#a73c64b6d041d6c9bb27a54bd87fcb9b9">decidcap</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>) <span class="comment">!Change current storage capacity of deciduous trees</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;     <span class="comment">! Change EveTr and Grass albedo too</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;     <a class="code" href="namespaceallocatearray.html#ad49963261e823b38b1d9e6dad29978bd">alb</a>(<a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>) = <a class="code" href="namespaceallocatearray.html#a55c401506715656db25c4f3ea8d44956">albevetr</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;     <a class="code" href="namespaceallocatearray.html#ad49963261e823b38b1d9e6dad29978bd">alb</a>(<a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>) = <a class="code" href="namespaceallocatearray.html#af087b466573effc0552f0a3b2d367db3">albgrass</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling NARP...&#39;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     <span class="keyword">CALL </span><a class="code" href="namespacenarp__module.html#ac480c3115a6413b9e79770f601e68895">narp</a>(&amp;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;          <a class="code" href="namespacetime.html#acf0bd1b102769fcbe36a171b4b9e2a25">dectime</a>,<a class="code" href="namespacedata__in.html#a332530944dd5c37316f92c3c74350e83">zenith_deg</a>,<a class="code" href="namespacedata__in.html#a8ac4d9de71d52d8c39e04c59635a5e3c">avkdn</a>,<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,<a class="code" href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">avrh</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>,<a class="code" href="namespacedata__in.html#ae357494342c4cf48a962c4361d7c4459">qn1_obs</a>,&amp;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          <a class="code" href="namespacesnowmod.html#a269fc9eb4dcd8dc77888c370c046a3c2">snowalb</a>,&amp;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;          <a class="code" href="namespacedata__in.html#a95db274f3821ba4b3b2799481c2484f7">albedochoice</a>,<a class="code" href="namespacedata__in.html#a7ee5c5c530300f6627f86b6cbde2d5b9">ldown_option</a>,<a class="code" href="namespacedata__in.html#a0b433ad2361360f657c537b128e4a5f7">netradiationmethod</a>,<a class="code" href="namespacedata__in.html#a2d6b128b5a2c8b851ee4fdd38204a18f">diagqn</a>,&amp;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>,<a class="code" href="namespacedata__in.html#af270ed598adad800b8338f7a0700183f">qn1_sf</a>,<a class="code" href="namespacedata__in.html#ae21258de695f82699606f7ced498693d">qn1_s</a>,<a class="code" href="namespacedata__in.html#ab31fbd3fd9d4036fa930706c4de36397">kclear</a>,<a class="code" href="namespacedata__in.html#a5d9f4f79563d2e000333219a4d2f4c99">kup</a>,<a class="code" href="namespacedata__in.html#a7be43e97ab4efa32b57c8f6b6b5949b7">ldown</a>,<a class="code" href="namespacedata__in.html#a5a2c23ecc11fe337a954cca86be6e0ce">lup</a>,<a class="code" href="namespacedata__in.html#a8afa15b03c067e57c570544bd5562ac1">fcld</a>,<a class="code" href="namespacedata__in.html#a743440f75d11d6596e13e18b78d7f531">tsurf</a>)</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;     <span class="comment">!Temp_C,kclear,fcld,dectime,avkdn,avRH,qn1,kup,ldown,lup,tsurf,&amp;</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;     <span class="comment">!AlbedoChoice,ldown_option,Press_hPa,Ea_hPa,qn1_obs,&amp;</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;     <span class="comment">!zenith_deg,NetRadiationMethod,</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     <a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a> = <a class="code" href="namespacedata__in.html#ac93d21776972756112d04651ac3cbb22">snow_obs</a></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>      = <a class="code" href="namespacedata__in.html#ae357494342c4cf48a962c4361d7c4459">qn1_obs</a></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;     <a class="code" href="namespacedata__in.html#af270ed598adad800b8338f7a0700183f">qn1_sf</a>   = <a class="code" href="namespacedata__in.html#ae357494342c4cf48a962c4361d7c4459">qn1_obs</a></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     <a class="code" href="namespacedata__in.html#ae21258de695f82699606f7ced498693d">qn1_s</a>    = <a class="code" href="namespacedata__in.html#ae357494342c4cf48a962c4361d7c4459">qn1_obs</a></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">! ===================SOLWEIG OUTPUT ========================================</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#a6cc0dbee756c4ddc20f395bd37f7ad8f">solweiguse</a>==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;     <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#aa192321c93659ded79b2485baaa901b3">outinterval</a>==<a class="code" href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">imin</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#ae2ab3d89e50ddafe5bdb6f79aeb6d690">runforgrid</a>==-999) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;           <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SOLWEIG_2014a_core...&#39;</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;           <span class="keyword">CALL </span><a class="code" href="_s_o_l_w_e_i_g__2014a__core_8f95.html#a16c0a3ea3be2afe58b9d3308aa479d8f">solweig_2014a_core</a>(imb)</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;           <a class="code" href="namespacesolweig__module.html#a466d8cf9dd423b05c00deaf1ac231f2c">solweigcount</a>=<a class="code" href="namespacesolweig__module.html#a466d8cf9dd423b05c00deaf1ac231f2c">solweigcount</a>+1</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;           <span class="keywordflow">IF</span> (gridiv == <a class="code" href="namespacedata__in.html#ae2ab3d89e50ddafe5bdb6f79aeb6d690">runforgrid</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;              <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SOLWEIG_2014a_core...&#39;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;              <span class="keyword">CALL </span><a class="code" href="_s_o_l_w_e_i_g__2014a__core_8f95.html#a16c0a3ea3be2afe58b9d3308aa479d8f">solweig_2014a_core</a>(imb)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;              <a class="code" href="namespacesolweig__module.html#a466d8cf9dd423b05c00deaf1ac231f2c">solweigcount</a>=<a class="code" href="namespacesolweig__module.html#a466d8cf9dd423b05c00deaf1ac231f2c">solweigcount</a>+1</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordflow">           ENDIF</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keywordflow">     ENDIF</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     <a class="code" href="namespacedata__in.html#add17d78f3c3ee4dde8d1a3d9630068ca">solweigpoi_out</a>=0</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">! ===================ANTHROPOGENIC HEAT FLUX================================</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  ih=<a class="code" href="namespacetime.html#a88a6c141593462330d65da0397b9b71d">it</a>-<a class="code" href="namespacetime.html#a0985b09f5d79535bd56787cb3c82cfd0">dls</a></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">IF</span>(ih&lt;0) ih=23</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a2d5ce0a221d7ee5c42ab2bdb3bf06a8b">anthropheatmethod</a>==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SAHP_1...&#39;</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;     <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___s_a_h_p_8f95.html#ab568d02ff4d86576ac4294ee0d16a0d8">sahp_1</a>(<a class="code" href="namespacedata__in.html#a3bdf6ad52d92cd85f212cea607807601">qf_sahp</a>,<a class="code" href="namespacedata__in.html#a717a1dc537f7b213fc70eb8f51819542">qf_sahp_base</a>,<a class="code" href="namespacedata__in.html#a3606d0dc641d4f68851d608bec320422">qf_sahp_heat</a>,<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,ih,<a class="code" href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">imin</a>)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;     <a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a>=<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;     <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>=<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>+<a class="code" href="namespacedata__in.html#a3bdf6ad52d92cd85f212cea607807601">qf_sahp</a></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacedata__in.html#a2d5ce0a221d7ee5c42ab2bdb3bf06a8b">anthropheatmethod</a>==2) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SAHP_2...&#39;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;     <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___s_a_h_p_8f95.html#aee8fa1098c2995bf57f8bc65e5be7ed2">sahp_2</a>(<a class="code" href="namespacedata__in.html#a3bdf6ad52d92cd85f212cea607807601">qf_sahp</a>,<a class="code" href="namespacedata__in.html#a717a1dc537f7b213fc70eb8f51819542">qf_sahp_base</a>,<a class="code" href="namespacedata__in.html#a3606d0dc641d4f68851d608bec320422">qf_sahp_heat</a>,<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,ih,<a class="code" href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">imin</a>)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;     <a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a>=<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>=<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>+<a class="code" href="namespacedata__in.html#a3bdf6ad52d92cd85f212cea607807601">qf_sahp</a></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacedata__in.html#a2d5ce0a221d7ee5c42ab2bdb3bf06a8b">anthropheatmethod</a>==3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SAHP_3...&#39;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;     <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___s_a_h_p_8f95.html#a2afb7b9da3c248277f05791a04feb468">sahp_3</a>(<a class="code" href="namespacedata__in.html#a3bdf6ad52d92cd85f212cea607807601">qf_sahp</a>,<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,ih,<a class="code" href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">imin</a>)</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;     <a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a>=<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;     <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>=<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>+<a class="code" href="namespacedata__in.html#a3bdf6ad52d92cd85f212cea607807601">qf_sahp</a></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;     <a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a>=<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;     <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>=<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>+<a class="code" href="namespacedata__in.html#a13eb3e18ed56b78668ba6c47d11ba155">qf</a></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">! -- qn1 is now QSTAR+QF (net all-wave radiation + anthropogenic heat flux)</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">! -- qn1_bup is QSTAR only</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a2d5ce0a221d7ee5c42ab2bdb3bf06a8b">anthropheatmethod</a>&gt;=1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;     <a class="code" href="namespacedata__in.html#a13eb3e18ed56b78668ba6c47d11ba155">qf</a>=<a class="code" href="namespacedata__in.html#a3bdf6ad52d92cd85f212cea607807601">qf_sahp</a></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">! Calculate CO2 fluxes from anthropogenic components</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling CO2_anthro...&#39;</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___c_o2_8f95.html#a3d08af1e9ac16a2e04534ba1a9018988">co2_anthro</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,ih,<a class="code" href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">imin</a>)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">! =================STORAGE HEAT FLUX=======================================</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aba572e9ad5577e14bcd393849b1fcdf3">storageheatmethod</a>==1) <span class="keywordflow">THEN</span>           <span class="comment">!Use OHM to calculate QS</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a27bd8e1db530bad815c128979003c184">ohmincqf</a> == 1) <span class="keywordflow">THEN</span>      <span class="comment">!Calculate QS using QSTAR+QF</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling OHM...&#39;</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___o_h_m_8f95.html#ab185f57c5ea6cf2099e1287a56748702">ohm</a>(<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>,<a class="code" href="namespaceallocatearray.html#aef0f065addcafc27e8adbf9c9f9f867f">qn1_store</a>(:,gridiv),<a class="code" href="namespaceallocatearray.html#ad5f385f647d84ed863fbfe5ae0754b28">qn1_av_store</a>(:,gridiv),&amp;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;             <a class="code" href="namespacedata__in.html#ae21258de695f82699606f7ced498693d">qn1_s</a>,<a class="code" href="namespaceallocatearray.html#a29c0ea0741af8fff0b282998c49da9a1">qn1_s_store</a>(:,gridiv),<a class="code" href="namespaceallocatearray.html#a7d2779bd8ecaa17c3f07c18a936d2150">qn1_s_av_store</a>(:,gridiv),&amp;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;             <a class="code" href="namespacesues__data.html#ab28124e60c813d253c9b095050fe3ebe">nsh</a>,&amp;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;             <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,&amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;             <a class="code" href="namespaceallocatearray.html#aae45e57c1b2d211392c5f98300524ee8">hdd</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1,4),&amp;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;             <a class="code" href="namespaceallocatearray.html#aa455ec06de0d5f8b24b5a991a07b32c1">ohm_coef</a>,&amp;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;             <a class="code" href="namespaceallocatearray.html#a8b9a218b05df6fa11170f787d62e5ed4">ohm_threshsw</a>,<a class="code" href="namespaceallocatearray.html#a138caba870c7f698f4b833e019b2c794">ohm_threshwd</a>,&amp;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;             <a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>,<a class="code" href="namespaceallocatearray.html#a1c0a391fbf8e63a46d93cae2c6c11049">soilstorecap</a>,<a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>,&amp;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;             <a class="code" href="namespaceallocatearray.html#afbbcbdfd67c32839a537f74d1bc6ff5a">bldgsurf</a>,<a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>,&amp;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;             <a class="code" href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">snowuse</a>,<a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>,&amp;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;             <a class="code" href="namespacedata__in.html#a2202e62dbdf6e4d935d472a09af97460">diagqs</a>,&amp;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;             <a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>,<a class="code" href="namespaceallocatearray.html#aca62321fa80aef03d41d2ed66f3ade3a">deltaqi</a>)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;     <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacedata__in.html#a27bd8e1db530bad815c128979003c184">ohmincqf</a> == 0) <span class="keywordflow">THEN</span>  <span class="comment">!Calculate QS using QSTAR</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>=<a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling OHM...&#39;</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___o_h_m_8f95.html#ab185f57c5ea6cf2099e1287a56748702">ohm</a>(<a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a>,<a class="code" href="namespaceallocatearray.html#aef0f065addcafc27e8adbf9c9f9f867f">qn1_store</a>(:,gridiv),<a class="code" href="namespaceallocatearray.html#ad5f385f647d84ed863fbfe5ae0754b28">qn1_av_store</a>(:,gridiv),&amp;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;             <a class="code" href="namespacedata__in.html#ae21258de695f82699606f7ced498693d">qn1_s</a>,<a class="code" href="namespaceallocatearray.html#a29c0ea0741af8fff0b282998c49da9a1">qn1_s_store</a>(:,gridiv),<a class="code" href="namespaceallocatearray.html#a7d2779bd8ecaa17c3f07c18a936d2150">qn1_s_av_store</a>(:,gridiv),&amp;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;             <a class="code" href="namespacesues__data.html#ab28124e60c813d253c9b095050fe3ebe">nsh</a>,&amp;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;             <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,&amp;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;             <a class="code" href="namespaceallocatearray.html#aae45e57c1b2d211392c5f98300524ee8">hdd</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1,4),&amp;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;             <a class="code" href="namespaceallocatearray.html#aa455ec06de0d5f8b24b5a991a07b32c1">ohm_coef</a>,&amp;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;             <a class="code" href="namespaceallocatearray.html#a8b9a218b05df6fa11170f787d62e5ed4">ohm_threshsw</a>,<a class="code" href="namespaceallocatearray.html#a138caba870c7f698f4b833e019b2c794">ohm_threshwd</a>,&amp;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;             <a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>,<a class="code" href="namespaceallocatearray.html#a1c0a391fbf8e63a46d93cae2c6c11049">soilstorecap</a>,<a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>,&amp;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;             <a class="code" href="namespaceallocatearray.html#afbbcbdfd67c32839a537f74d1bc6ff5a">bldgsurf</a>,<a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>,&amp;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;             <a class="code" href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">snowuse</a>,<a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>,&amp;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;             <a class="code" href="namespacedata__in.html#a2202e62dbdf6e4d935d472a09af97460">diagqs</a>,&amp;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;             <a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>,<a class="code" href="namespaceallocatearray.html#aca62321fa80aef03d41d2ed66f3ade3a">deltaqi</a>)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="keywordflow">     ENDIF</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">! use AnOHM to calculate QS, TS 14 Mar 2016</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">! print*, &#39;id and time&#39;,id,it,imin</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#aba572e9ad5577e14bcd393849b1fcdf3">storageheatmethod</a>==3) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;     <span class="keywordflow">IF</span> ( <a class="code" href="namespacedata__in.html#a27bd8e1db530bad815c128979003c184">ohmincqf</a> == 1 ) <span class="keywordflow">THEN</span>    <span class="comment">!Calculate QS using QSTAR+QF</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling AnOHM...&#39;</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespaceanohm__module.html#a12150b343f1a4a8c3210e499cb9db9d9">anohm</a>(<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>,<a class="code" href="namespaceallocatearray.html#aef0f065addcafc27e8adbf9c9f9f867f">qn1_store</a>(:,gridiv),<a class="code" href="namespaceallocatearray.html#ad5f385f647d84ed863fbfe5ae0754b28">qn1_av_store</a>(:,gridiv),&amp;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;             <a class="code" href="namespaceallocatearray.html#aa263d396297f85dc10ee06a484ffcde6">metforcingdata</a>(:,:,gridiv),<a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>,&amp;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;             <a class="code" href="namespaceallocatearray.html#ad49963261e823b38b1d9e6dad29978bd">alb</a>, <a class="code" href="namespaceallocatearray.html#a5780572b4c9bdc7bbf20e4ee9d72010e">emis</a>, <a class="code" href="namespaceallocatearray.html#a24bcde513a65db1cd23573a243901f6a">cpanohm</a>, <a class="code" href="namespaceallocatearray.html#a8055e207eb40afdc658bde6493ab319e">kkanohm</a>, <a class="code" href="namespaceallocatearray.html#a10d39115371a0bd3c9a9fc9d4bc7fb2f">chanohm</a>,&amp;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;             <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,<a class="code" href="namespacesues__data.html#ab28124e60c813d253c9b095050fe3ebe">nsh</a>,<a class="code" href="namespacedata__in.html#a2d5ce0a221d7ee5c42ab2bdb3bf06a8b">anthropheatmethod</a>,<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,&amp;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;             <a class="code" href="namespaceallocatearray.html#ad46985325048552753cfa81641ff8b0f">a1</a>,<a class="code" href="namespaceallocatearray.html#a0cad51c36be0d8e5f907e24f9c391e4e">a2</a>,<a class="code" href="namespaceallocatearray.html#ac17d9365b9163e951de7ce3f5fa21897">a3</a>,<a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;     <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacedata__in.html#a27bd8e1db530bad815c128979003c184">ohmincqf</a> == 0) <span class="keywordflow">THEN</span>   <span class="comment">!Calculate QS using QSTAR</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>=<a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling AnOHM...&#39;</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keyword">CALL </span><a class="code" href="namespaceanohm__module.html#a12150b343f1a4a8c3210e499cb9db9d9">anohm</a>(<a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a>,<a class="code" href="namespaceallocatearray.html#aef0f065addcafc27e8adbf9c9f9f867f">qn1_store</a>(:,gridiv),<a class="code" href="namespaceallocatearray.html#ad5f385f647d84ed863fbfe5ae0754b28">qn1_av_store</a>(:,gridiv),&amp;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;             <a class="code" href="namespaceallocatearray.html#aa263d396297f85dc10ee06a484ffcde6">metforcingdata</a>(:,:,gridiv),<a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>,&amp;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;             <a class="code" href="namespaceallocatearray.html#ad49963261e823b38b1d9e6dad29978bd">alb</a>, <a class="code" href="namespaceallocatearray.html#a5780572b4c9bdc7bbf20e4ee9d72010e">emis</a>, <a class="code" href="namespaceallocatearray.html#a24bcde513a65db1cd23573a243901f6a">cpanohm</a>, <a class="code" href="namespaceallocatearray.html#a8055e207eb40afdc658bde6493ab319e">kkanohm</a>, <a class="code" href="namespaceallocatearray.html#a10d39115371a0bd3c9a9fc9d4bc7fb2f">chanohm</a>,&amp;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;             <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,<a class="code" href="namespacesues__data.html#ab28124e60c813d253c9b095050fe3ebe">nsh</a>,<a class="code" href="namespacedata__in.html#a2d5ce0a221d7ee5c42ab2bdb3bf06a8b">anthropheatmethod</a>,<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,&amp;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;             <a class="code" href="namespaceallocatearray.html#ad46985325048552753cfa81641ff8b0f">a1</a>,<a class="code" href="namespaceallocatearray.html#a0cad51c36be0d8e5f907e24f9c391e4e">a2</a>,<a class="code" href="namespaceallocatearray.html#ac17d9365b9163e951de7ce3f5fa21897">a3</a>,<a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keywordflow">     END IF</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordflow">  END IF</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">!Calculate QS using ESTM</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aba572e9ad5577e14bcd393849b1fcdf3">storageheatmethod</a>==4 .OR. <a class="code" href="namespacedata__in.html#aba572e9ad5577e14bcd393849b1fcdf3">storageheatmethod</a>==14) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;     <span class="comment">!CALL ESTM_v2016(QSestm,iMB)</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling ESTM...&#39;</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;     <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___e_s_t_m__v2016_8f95.html#a76f075c3b84d1ab8aac9844ba11dbd3e">estm_v2016</a>(<a class="code" href="namespacedata__in.html#a4c71a7e3c5a99b333e25a1876a3968b1">qsestm</a>,gridiv,ir)  <span class="comment">! iMB corrected to Gridiv, TS 09 Jun 2016</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;     <a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>=<a class="code" href="namespacedata__in.html#a4c71a7e3c5a99b333e25a1876a3968b1">qsestm</a>   <span class="comment">! Use ESTM qs</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">! don&#39;t use these composite QS options at the moment, TS 10 Jun 2016</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">! IF (StorageHeatMethod&gt;=10)THEN ! Chose which QS will be used in SUEWS and output file</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">!    !write(800,*)id,it,QS,QSanOHM,QSestm</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="comment">!    IF(StorageHeatMethod==14)THEN</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">!       QS=QSestm</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">!    ELSEIF(StorageHeatMethod==13)THEN</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">!       QS=QSanOHM</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">!    ENDIF</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">! ENDIF</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">! For the purpose of turbulent fluxes, remove QF from the net all-wave radiation</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>=<a class="code" href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">qn1_bup</a>  <span class="comment">!Remove QF from QSTAR</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">! -- qn1 is now QSTAR only</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">!==================Energy related to snow melting/freezing processes=======</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">snowuse</a>==1)  <span class="keywordflow">THEN</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling MeltHeat&#39;</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;     <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___snow_8f95.html#ab4ce449365f2ed93c920c5629a3ca469">meltheat</a></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;     <span class="comment">! If snow on ground, no irrigation, so veg_fr same in each case</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;     <span class="comment">!New fraction of vegetation.</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;     <span class="comment">!IF(veg_type==1)THEN         ! area vegetated</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;     <a class="code" href="namespacegis__data.html#a16985ccbad5040769f8cd039103c4f15">veg_fr</a> = <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>)*(1-<a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>(<a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>))+<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>)*(1-<a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>(<a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>))+&amp;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>)*(1-<a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>(<a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>))+<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a570d73b34ec4b42f6f6075640a282619">bsoilsurf</a>)*(1-<a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>(<a class="code" href="namespaceallocatearray.html#a570d73b34ec4b42f6f6075640a282619">bsoilsurf</a>))+&amp;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>)*(1-<a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>(<a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>))</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;     <span class="comment">!ELSEIF(veg_type==2)THEN     ! area irrigated</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;     <span class="comment">!   !!!veg_fr=sfr(GrassISurf)*(1-snowFrac(GrassUSurf))</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;     <span class="comment">!END IF</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">  END IF</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">!==========================Turbulent Fluxes================================</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <a class="code" href="namespacemoist.html#a4572c899e5e83d9647c7ed9f16901c24">tlv</a>=<a class="code" href="namespacemoist.html#a59a8f410cf3ebfe343d9c01b5dbb2cf8">lv_j_kg</a>/<a class="code" href="namespacesues__data.html#a81a241a978fdd040dee716c4e68dc786">tstep_real</a> <span class="comment">!Latent heat of vapourisation per timestep</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling LUMPS_QHQE...&#39;</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">!Calculate QH and QE from LUMPS</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_l_u_m_p_s___q_h_q_e_8f95.html#af6b781cbbc71c67d4bb5de9dcb066b01">lumps_qhqe</a>(&amp;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                <span class="comment">!input:</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;       <a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>,<a class="code" href="namespacedata__in.html#a13eb3e18ed56b78668ba6c47d11ba155">qf</a>,<a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>,<a class="code" href="namespacesnowmod.html#a1d7e7d0b8974783e0320cde393e09594">qm</a>,<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>,<a class="code" href="namespacemoist.html#a59a8f410cf3ebfe343d9c01b5dbb2cf8">lv_j_kg</a>,<a class="code" href="namespacemoist.html#a4572c899e5e83d9647c7ed9f16901c24">tlv</a>,&amp;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;       <a class="code" href="namespacedata__in.html#abc838b310998f8cef4246fd9d724e903">drainrt</a>,<a class="code" href="namespacedata__in.html#affc86dfcf91974ff6d1768ff3b4406c3">precip</a>,&amp;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;       <a class="code" href="namespacedata__in.html#a959499405172092dfb8d49b61bfec809">rainbucket</a>,<a class="code" href="namespacedata__in.html#a2ea729731f7651be567d3392e184bf47">rainmaxres</a>,<a class="code" href="namespacedata__in.html#a8a79043a75a7cba200c72ec10044bcd3">raincover</a>,&amp;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;       <a class="code" href="namespacegis__data.html#a16985ccbad5040769f8cd039103c4f15">veg_fr</a>,<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespaceallocatearray.html#a808db51d4a8ed78af7b4ea759da827a2">ivconif</a>+2:<a class="code" href="namespaceallocatearray.html#a4f4900cf0725d3239c9973fc7c48e5ba">ivgrass</a>+2),<a class="code" href="namespaceallocatearray.html#ab660d7e4ca340b0b677a74ecb8bb34f4">lai</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1,gridiv),<a class="code" href="namespaceallocatearray.html#a535874e25b1042564b17301e8d84147b">laimax</a>,<a class="code" href="namespaceallocatearray.html#ab3f65c4c4c46b200d0e63121b457d7c4">laimin</a>,&amp;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;       <a class="code" href="namespacesues__data.html#ab2070158f8b88b8f7835232841061718">nsh_real</a>,<a class="code" href="namespacegis__data.html#a9cc38462906e83260e293f5b447c4374">veg_type</a>,<a class="code" href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">snowuse</a>,&amp;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                <span class="comment">!output:</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;       <a class="code" href="namespacedata__in.html#aaa77ae828595f5b1e1bec4237020dfbc">h_mod</a>,<a class="code" href="namespacedata__in.html#a737780f5cf53c9f2d3048bbfface32cd">e_mod</a>,&amp;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;       <a class="code" href="namespacemoist.html#a8a8d0c665be356954056ed6c102b953b">psyc_hpa</a>,<a class="code" href="namespacemoist.html#ab898e28f0ece3e6a2c1852fd8fe61bc1">s_hpa</a>,<a class="code" href="namespacemoist.html#a38df7531f904d511b341f35b56ab56f3">sice_hpa</a>,<a class="code" href="namespacedata__in.html#afff1f4919ba95d947fa5e34493cc9fa3">tempveg</a>)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">IF</span>(debug)<span class="keyword">WRITE</span>(*,*)<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>,<a class="code" href="namespacemoist.html#a8a8d0c665be356954056ed6c102b953b">psyc_hpa</a>,i</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling WaterUse...&#39;</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">!Gives the external and internal water uses per timestep</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__water_use_8f95.html#a2de7209275154fbb61e2f22a1d4a1d38">wateruse</a>(&amp;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;       <a class="code" href="namespacesues__data.html#ab2070158f8b88b8f7835232841061718">nsh_real</a>,&amp;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;       <a class="code" href="namespacesues__data.html#a9d6a1e2ae7fe7c36fb4aaa9e2e3c2137">surfacearea</a>,&amp;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;       <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,&amp;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;       <a class="code" href="namespacesues__data.html#aec92653b01eece5fbbb4f1cdfa3575cf">irrfracconif</a>,&amp;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;       <a class="code" href="namespacesues__data.html#aa6d49b1ef69f02f3bd0334c0d50d9a30">irrfracdecid</a>,&amp;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;       <a class="code" href="namespacesues__data.html#ac09560182eb4e8e83479a33c9ea2f52b">irrfracgrass</a>,&amp;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;       <a class="code" href="namespaceallocatearray.html#a7bc9ecd33459d391cf70ea0bb83dce0f">dayofweek</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,:),&amp;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;       <a class="code" href="namespaceallocatearray.html#ab6f942b1808c9a62a4628cbd9e7e34a1">wuprofa_tstep</a>,&amp;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;       <a class="code" href="namespaceallocatearray.html#adb237729df78f011f8ea814ee43f1703">wuprofm_tstep</a>,&amp;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;       <a class="code" href="namespacesues__data.html#aaec40541d3458d50a5e554aa1ca0848b">internalwateruse_h</a>,&amp;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;       <a class="code" href="namespaceallocatearray.html#aae45e57c1b2d211392c5f98300524ee8">hdd</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1,:),&amp;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;       <a class="code" href="namespaceallocatearray.html#a5a9854768fde92cc3ec838f8729f5d42">wu_day</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1,:),&amp;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;       <a class="code" href="namespacedata__in.html#ab3b82014d0bd4e04ce70642a274dd0dc">waterusemethod</a>,&amp;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;       <a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>,&amp;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;       <a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>,&amp;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;       <a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>,&amp;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;       <a class="code" href="namespacesues__data.html#ab28124e60c813d253c9b095050fe3ebe">nsh</a>,&amp;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;       <a class="code" href="namespacetime.html#a88a6c141593462330d65da0397b9b71d">it</a>,<a class="code" href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">imin</a>,<a class="code" href="namespacetime.html#a0985b09f5d79535bd56787cb3c82cfd0">dls</a>,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,&amp;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;       <a class="code" href="namespacesues__data.html#aa663cd30d361709a541de0a9d406557e">overuse</a>,&amp;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                <span class="comment">!  output:</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;       <a class="code" href="namespacesues__data.html#a167fa54ed7df9e23b3dac81232961fa3">wuareaevetr_m2</a>,&amp;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;       <a class="code" href="namespacesues__data.html#a3dd16ee1aeeae265f322b0982f33a321">wuareadectr_m2</a>,&amp;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;       <a class="code" href="namespacesues__data.html#a9d58cea1a78af7ae81ee097bde9e0ef4">wuareagrass_m2</a>,&amp;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;       <a class="code" href="namespacesues__data.html#a4145456981d7aaa8f5b19ab3ea5f1781">wuareatotal_m2</a>,&amp;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;       <a class="code" href="namespacesues__data.html#a6aa0ce59c7eee4b94b9ee86ac5b555d0">wu_evetr</a>,&amp;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;       <a class="code" href="namespacesues__data.html#a087f298012279c621f24a283b360d592">wu_dectr</a>,&amp;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;       <a class="code" href="namespacesues__data.html#a56315a7303bf70155e92ead9b64493c2">wu_grass</a>,&amp;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;       <a class="code" href="namespacedata__in.html#ae8c7901bd4995fbdec3868c38d2101b1">wu_m3</a>,&amp;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;       <a class="code" href="namespacesues__data.html#affbedb6f34d747605bf529fd2d80d4c7">int_wu</a>,&amp;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;       <a class="code" href="namespacesues__data.html#ad2e4c4ffe627921b28183c9f4d8789fd">ext_wu</a>)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#affc86dfcf91974ff6d1768ff3b4406c3">precip</a>&gt;0) <span class="keywordflow">THEN</span>   <span class="comment">!Initiate rain data [mm]</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;     <a class="code" href="namespacesues__data.html#aa2d35158f50e5437170a36712c99a891">pin</a>=<a class="code" href="namespacedata__in.html#affc86dfcf91974ff6d1768ff3b4406c3">precip</a></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;     <a class="code" href="namespacesues__data.html#aa2d35158f50e5437170a36712c99a891">pin</a>=0</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">! Get first estimate of sensible heat flux. Modified by HCW 26 Feb 2015</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">! Calculate kinematic heat flux (w&#39;T&#39;) from sensible heat flux [W m-2] from observed data (if available) or LUMPS</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a333bca61a59b05a5a5db0c7bb9daa2b9">qh_obs</a>/=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a>) <span class="keywordflow">THEN</span>   <span class="comment">!if(qh_obs/=NAN) qh=qh_obs   !Commented out by HCW 04 Mar 2015</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;     <a class="code" href="namespacesues__data.html#ae76235b1ac6a388886f63eb27a0905dd">h</a>=<a class="code" href="namespacedata__in.html#a333bca61a59b05a5a5db0c7bb9daa2b9">qh_obs</a>/(<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>*<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>)  <span class="comment">!Use observed value</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aaa77ae828595f5b1e1bec4237020dfbc">h_mod</a>/=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="namespacesues__data.html#ae76235b1ac6a388886f63eb27a0905dd">h</a> = <a class="code" href="namespacedata__in.html#aaa77ae828595f5b1e1bec4237020dfbc">h_mod</a>/(<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>*<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>)   <span class="comment">!Use LUMPS value</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="namespacesues__data.html#ae76235b1ac6a388886f63eb27a0905dd">h</a>=(<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>*0.2)/(<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>*<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>)   <span class="comment">!If LUMPS has had a problem, we still need a value</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(38,<span class="stringliteral">&#39;LUMPS unable to calculate realistic value for H_mod.&#39;</span>,<a class="code" href="namespacedata__in.html#aaa77ae828595f5b1e1bec4237020dfbc">h_mod</a>, <a class="code" href="namespacetime.html#acf0bd1b102769fcbe36a171b4b9e2a25">dectime</a>, <a class="code" href="namespacedefaultnotused.html#afd5393d7b0bd5eadd9ebcf66bd974e0d">notusedi</a>)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keywordflow">     ENDIF</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">!------------------------------------------------------------------</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling STAB_lumps...&#39;</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">!u* and Obukhov length out</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_l_u_m_p_s__atmos__functions__stab_8f95.html#a1783dde883ce9c28084bad6ce0af4b7d">stab_lumps</a>(&amp;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                <span class="comment">! input</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;       <a class="code" href="namespacesues__data.html#a1005846b0d388b51d731e6d5e404e2d6">stabilitymethod</a>,&amp;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;       <a class="code" href="namespacetime.html#acf0bd1b102769fcbe36a171b4b9e2a25">dectime</a>,&amp; <span class="comment">!Decimal time</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;       <a class="code" href="namespacemod__z.html#ac1314dbe1ed7b4c92c501ced67f725c3">zzd</a>,&amp;     <span class="comment">!Active measurement height (meas. height-displac. height)</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;       <a class="code" href="namespacemod__z.html#afd15a8bab419b8b576ccd3fa639d546f">z0m</a>,&amp;     <span class="comment">!Aerodynamic roughness length</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;       <a class="code" href="namespacemod__z.html#a85318ac2a4eb1313fc10432ff860214e">zdm</a>,&amp;     <span class="comment">!Displacement height</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;       <a class="code" href="namespacedata__in.html#abc95201410a9b25f8d1d2d5a063302c3">avu1</a>,&amp;    <span class="comment">!Average wind speed</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;       <a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,&amp;    <span class="comment">!Air temperature</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;       <a class="code" href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">l_mod</a>,&amp;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;       <a class="code" href="namespacesues__data.html#a6d0dd8d535aa36ca406b9c4ba99caef6">tstar</a>,&amp;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;       <a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>,&amp;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;       <a class="code" href="namespacesues__data.html#ae76235b1ac6a388886f63eb27a0905dd">h</a>,&amp;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;       <a class="code" href="namespacesues__data.html#ab35a12f588d9dfb72d0ec039e806d3bb">psim</a>)</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling AerodynamicResistance...&#39;</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___aerodynamic_resistance_8f95.html#a04f1fea7666166223b4895686e96bcbf">aerodynamicresistance</a>(&amp;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;       <a class="code" href="namespacemod__z.html#ac1314dbe1ed7b4c92c501ced67f725c3">zzd</a>,&amp;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;       <a class="code" href="namespacemod__z.html#afd15a8bab419b8b576ccd3fa639d546f">z0m</a>,&amp;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;       <a class="code" href="namespacedata__in.html#abc95201410a9b25f8d1d2d5a063302c3">avu1</a>,&amp;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;       <a class="code" href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">l_mod</a>,&amp;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;       <a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>,&amp;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;       <a class="code" href="namespacegis__data.html#a092cc07d2d55535e1995ac1196dac36a">vegfraction</a>,&amp;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;       <a class="code" href="namespacesues__data.html#a1780a57f30571faa7263e9cd248a8dd0">aerodynamicresistancemethod</a>,&amp;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;       <a class="code" href="namespacesues__data.html#a1005846b0d388b51d731e6d5e404e2d6">stabilitymethod</a>,&amp;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;       <a class="code" href="namespacesues__data.html#a9dff10e1f001cc8241e5d1d72a4beeb2">roughlenheatmethod</a>,&amp;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;       <a class="code" href="namespacesues__data.html#aafce3a183c34dd4df5268cdbfc8aea24">ra</a>)     <span class="comment">!RA out</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">snowuse</a>==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling AerodynamicResistance...&#39;</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;     <span class="comment">!  CALL AerodynamicResistance(RAsnow,AerodynamicResistanceMethod,StabilityMethod,3,&amp;</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;     <span class="comment">! ZZD,z0m,k2,AVU1,L_mod,Ustar,VegFraction,psyh)      !RA out</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;     <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___aerodynamic_resistance_8f95.html#a04f1fea7666166223b4895686e96bcbf">aerodynamicresistance</a>(&amp;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;          <a class="code" href="namespacemod__z.html#ac1314dbe1ed7b4c92c501ced67f725c3">zzd</a>,&amp;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;          <a class="code" href="namespacemod__z.html#afd15a8bab419b8b576ccd3fa639d546f">z0m</a>,&amp;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;          <a class="code" href="namespacedata__in.html#abc95201410a9b25f8d1d2d5a063302c3">avu1</a>,&amp;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;          <a class="code" href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">l_mod</a>,&amp;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;          <a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>,&amp;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;          <a class="code" href="namespacegis__data.html#a092cc07d2d55535e1995ac1196dac36a">vegfraction</a>,&amp;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;          <a class="code" href="namespacesues__data.html#a1780a57f30571faa7263e9cd248a8dd0">aerodynamicresistancemethod</a>,&amp;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          <a class="code" href="namespacesues__data.html#a1005846b0d388b51d731e6d5e404e2d6">stabilitymethod</a>,&amp;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;          3,&amp;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;          <a class="code" href="namespacesues__data.html#a2a84935439f246e72f5de7bd752888f1">rasnow</a>)     <span class="comment">!RA out</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SurfaceResistance...&#39;</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">! CALL SurfaceResistance(id,it)   !qsc and surface resistance out</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keyword">CALL  </span><a class="code" href="_s_u_e_w_s___surface_resistance_8f95.html#a4da071a736ca3e2e388c9f1f3b3e6ea7">surfaceresistance</a>(&amp;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;       <a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>,<a class="code" href="namespacetime.html#a88a6c141593462330d65da0397b9b71d">it</a>,&amp;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;       <a class="code" href="namespacedata__in.html#a306f10a44e3e8097152fc6a9c0403f6b">smdmethod</a>,&amp;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;       <a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>,&amp;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;       <a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>,&amp;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;       <a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>,&amp;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;       <a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>,&amp;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;       <a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>,&amp;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;       <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,&amp;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;       <a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,&amp;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;       <a class="code" href="namespacedata__in.html#a8ac4d9de71d52d8c39e04c59635a5e3c">avkdn</a>,&amp;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;       <a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>,&amp;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;       <a class="code" href="namespacemoist.html#ac54b9750ff8d2f544e3706dc3c7ea73d">dq</a>,&amp;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;       <a class="code" href="namespacedata__in.html#a22f13004f0c25b6603cceb88897eaee5">xsmd</a>,&amp;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;       <a class="code" href="namespacesues__data.html#adfce8b9e1538d8a1629df9963a7a6df0">vsmd</a>,&amp;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;       <a class="code" href="namespaceallocatearray.html#aded55272c7c08e6a254c7a9d70546d69">maxconductance</a>,&amp;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;       <a class="code" href="namespaceallocatearray.html#a535874e25b1042564b17301e8d84147b">laimax</a>,&amp;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;       <a class="code" href="namespaceallocatearray.html#ab660d7e4ca340b0b677a74ecb8bb34f4">lai</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1,:),&amp;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;       int(<a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#a0372ecc61cfb88ee683fac861aab87ac">c_gsmodel</a>)),&amp;<span class="comment">!  gsModel,&amp;</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#a69cae8cc47b53e83d621a7abe318ff14">c_gskmax</a>),&amp;<span class="comment">!  Kmax,&amp;</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#a10397ddbe69224c2751100ffad7d60ed">c_gsg1</a>),&amp;<span class="comment">! G1,&amp;</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#a2b115354208d6b09535bda0cee499316">c_gsg2</a>),&amp;<span class="comment">! G2,&amp;</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#a70972d48cf32e2ae2f264134371657eb">c_gsg3</a>),&amp;<span class="comment">! G3,&amp;</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#ade39cdbf936049001075bb06589629d8">c_gsg4</a>),&amp;<span class="comment">! G4,&amp;</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#a1b25f9c9a9281958b7ed21d0bb85dde1">c_gsg5</a>),&amp;<span class="comment">! G5,&amp;</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#ab8971a61a031605df883466bf12f9c11">c_gsg6</a>),&amp;<span class="comment">! G6,&amp;</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#abf62bf3e83784366ed95fdfaae1f1d92">c_gsth</a>),&amp;<span class="comment">! TH,&amp;</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#aa11ae08cca1b320e3e176e06ac0daa50">c_gstl</a>),&amp;<span class="comment">! TL,&amp;</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#aee67f7f4bcae37b7727fdeeb7570e7de">c_gss1</a>),&amp;<span class="comment">! S1,&amp;</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;       <a class="code" href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">surfacechar</a>(gridiv,<a class="code" href="namespaceallocatearray.html#af79468bbe3d4485e8a4f27d33c674864">c_gss2</a>),&amp;<span class="comment">! S2,&amp;</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;       <a class="code" href="namespacesues__data.html#a0aca98063df71052382d5ab58c2f0d19">gsc</a>,&amp;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;       <a class="code" href="namespacesues__data.html#a678cac1e19ddb70f811693772c031f0c">resistsurf</a>)</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling BoundaryLayerResistance...&#39;</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___b_l___resist_8f95.html#a1892d7a5ef6383934b4530b744268d15">boundarylayerresistance</a>(&amp;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;       <a class="code" href="namespacemod__z.html#ac1314dbe1ed7b4c92c501ced67f725c3">zzd</a>,&amp;     <span class="comment">!Active measurement height (meas. height-displac. height)</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;       <a class="code" href="namespacemod__z.html#afd15a8bab419b8b576ccd3fa639d546f">z0m</a>,&amp;     <span class="comment">!Aerodynamic roughness length</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;       <a class="code" href="namespacedata__in.html#abc95201410a9b25f8d1d2d5a063302c3">avu1</a>,&amp;    <span class="comment">!Average wind speed</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                <span class="comment">! input/output:</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;       <a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>,&amp;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;       <a class="code" href="namespacesues__data.html#a90293da57db1b1a3a4bc0979d2005640">rb</a>)</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="comment">! Calculate CO2 fluxes from biogenic components</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling CO2_biogen...&#39;</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___c_o2_8f95.html#a32784914a86ccd9e508a6f20eff62b59">co2_biogen</a></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">! Sum anthropogenic and biogenic CO2 flux components to find overall CO2 flux</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <a class="code" href="namespacedata__in.html#a8bc526d8d9a75c1ecef04817aac48046">fc</a> = <a class="code" href="namespacedata__in.html#ad77982daffd6bf19ea51d6635d9d2009">fc_anthro</a> + <a class="code" href="namespacedata__in.html#a446b6dc73d9c2e2518917361d9b526b3">fc_biogen</a></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <a class="code" href="namespacesues__data.html#ade8fa0a70d4bdc01712ae9438602f21e">sae</a>   = <a class="code" href="namespacemoist.html#ab898e28f0ece3e6a2c1852fd8fe61bc1">s_hpa</a>*(<a class="code" href="namespacedata__in.html#af270ed598adad800b8338f7a0700183f">qn1_sf</a>+<a class="code" href="namespacedata__in.html#a13eb3e18ed56b78668ba6c47d11ba155">qf</a>-<a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>)    <span class="comment">!s_haPa - slope of svp vs t curve. qn1 changed to qn1_SF, lj in May 2013</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <a class="code" href="namespacesues__data.html#a79ee74466d17ed05bb20f195934f383b">vdrc</a>  = <a class="code" href="namespacemoist.html#aad393ebb822062a86d42176ac76b30ad">vpd_hpa</a>*<a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>*<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <a class="code" href="namespacesues__data.html#a77243f6b1c7d2baecb0d13f5d98b4318">sp</a>    = <a class="code" href="namespacemoist.html#ab898e28f0ece3e6a2c1852fd8fe61bc1">s_hpa</a>/<a class="code" href="namespacemoist.html#a8a8d0c665be356954056ed6c102b953b">psyc_hpa</a></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <a class="code" href="namespacesues__data.html#a06a4500745768a4bcf4886312a028e0c">numpm</a> = <a class="code" href="namespacesues__data.html#ade8fa0a70d4bdc01712ae9438602f21e">sae</a>+<a class="code" href="namespacesues__data.html#a79ee74466d17ed05bb20f195934f383b">vdrc</a>/<a class="code" href="namespacesues__data.html#aafce3a183c34dd4df5268cdbfc8aea24">ra</a></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="comment">!write(*,*) numPM, sae, vdrc/ra, s_hPA+psyc_hPa, NumPM/(s_hPA+psyc_hPa)</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">!=====================================================================</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="comment">!========= Water balance calculations ================================</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">! Needs to run at small timesteps (i.e. minutes)</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="comment">! Previously, v2014b switched to 60/NSH min intervals here</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">! Now whole model runs at a resolution of tstep</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <span class="comment">! Initialise water balance variables</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <a class="code" href="namespacedata__in.html#a15dff170cc3ed5a26f5b095eebf80392">qe</a>               = 0</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <a class="code" href="namespacesues__data.html#a879c9f9f7cf8597fe30edea62a95bcdd">ev</a>               = 0</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <a class="code" href="namespaceallocatearray.html#a6bf4d6d59ed380463ac60fb9d4f382b6">ev_snow</a>          = 0</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <a class="code" href="namespacesues__data.html#a08d117cca68ee0e84a8b286a038434c6">surplusevap</a>      = 0</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <a class="code" href="namespaceallocatearray.html#a91095edf69a936902a3586fe9ef958a3">evap</a>             = 0</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <a class="code" href="namespaceallocatearray.html#a2c176341a882c22aab3f1b01844f4fa0">chang</a>            = 0</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <a class="code" href="namespaceallocatearray.html#abf84199761d02e1a9304d1d7a2c00eba">runoff</a>           = 0</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <a class="code" href="namespaceallocatearray.html#a56dec28d9173b960574b82696b82f7a2">runoffsoil</a>       = 0</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <a class="code" href="namespacesues__data.html#ac93567a8ca56d05105523626613f5cc4">surpluswaterbody</a> = 0</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">! Added by HCW 13 Feb 2015</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <a class="code" href="namespacesues__data.html#a8506404b27e8b0ded77802f2ab475928">qe_per_tstep</a>         = 0     <span class="comment">![W m-2]</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <a class="code" href="namespacesues__data.html#a11bc80be13a121686d39d355d6c98aa9">ev_per_tstep</a>         = 0</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <a class="code" href="namespacesues__data.html#a96e76d9edd6c97fcdbc8f73047e189f3">drain_per_tstep</a>      = 0</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <a class="code" href="namespacesues__data.html#a1848f093a3dd5ebdc1da775e9cda8509">surf_chang_per_tstep</a> = 0</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <a class="code" href="namespacesues__data.html#a82ac11b95b008fb43921aac3b503efad">tot_chang_per_tstep</a>  = 0</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <a class="code" href="namespacesues__data.html#abdb761c4b6b03cace33c5c54eb3607b2">state_per_tstep</a>      = 0</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <a class="code" href="namespacesues__data.html#a9a093b62067234bd553e776c06ac4df9">nwstate_per_tstep</a>    = 0</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="namespacesues__data.html#a15eb03975ee429099b923fc02a2577ca">runoff_per_tstep</a>     = 0</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">! Retain previous surface state and soil moisture state</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <a class="code" href="namespaceallocatearray.html#a417b9ff3eb6479963b494b8c50d661c2">stateold</a>     = <a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>     <span class="comment">!State of each surface [mm] for the previous timestep</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <a class="code" href="namespaceallocatearray.html#a21359b000cf1cea64f86412e4336b957">soilmoistold</a> = <a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a> <span class="comment">!Soil moisture of each surface [mm] for the previous timestep</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="comment">!============= Grid-to-grid runoff =============</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">! Calculate additional water coming from other grids</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">! i.e. the variables addImpervious, addVeg, addWaterBody, addPipes</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">!call RunoffFromGrid(GridFromFrac)  !!Need to code between-grid water transfer</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">! Sum water coming from other grids (these are expressed as depths over the whole surface)</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="code" href="namespacesues__data.html#a2c84a8e635e90b198dc0fd4c93c51ba4">additionalwater</a> = <a class="code" href="namespacesues__data.html#a58a8108dff93f602ad2ef840fef9395f">addpipes</a>+<a class="code" href="namespacesues__data.html#af0fed458b1eefc0164c4ffb6d6e2d1a2">addimpervious</a>+<a class="code" href="namespacesues__data.html#a2553d0e5b7218422246f2078b379fed5">addveg</a>+<a class="code" href="namespacesues__data.html#aa314ccdf6d41a3901fa922504f030203">addwaterbody</a>  <span class="comment">![mm]</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="comment">! Initialise runoff in pipes</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <a class="code" href="namespacesues__data.html#a20b9d66de8207bb6709f620aebc98b17">runoffpipes</a>         = <a class="code" href="namespacesues__data.html#a58a8108dff93f602ad2ef840fef9395f">addpipes</a> <span class="comment">!Water flowing in pipes from other grids. No need for scaling??</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">!! CHECK p_i</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <a class="code" href="namespacesues__data.html#a3e74512061da577d1697d50324b5ea28">runoff_per_interval</a> = <a class="code" href="namespacesues__data.html#a58a8108dff93f602ad2ef840fef9395f">addpipes</a> <span class="comment">!pipe plor added to total runoff.</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">!================== Drainage ===================</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="comment">! Calculate drainage for each soil subsurface (excluding water body)</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling Drainage...&#39;</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>/=0) <span class="keywordflow">THEN</span> <span class="comment">!Soil states only calculated if soil exists. LJ June 2017</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;     <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>-1</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__drain_8f95.html#ad457462534fc9fec206ac998199dcb8d">drainage</a>(&amp;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;             <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>,&amp;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;             <a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),&amp;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;             <a class="code" href="namespaceallocatearray.html#a25ebdf393dee2419f983b4ac7d2bf2e9">surf</a>(6,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),&amp;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;             <a class="code" href="namespaceallocatearray.html#a25ebdf393dee2419f983b4ac7d2bf2e9">surf</a>(2,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),&amp;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;             <a class="code" href="namespaceallocatearray.html#a25ebdf393dee2419f983b4ac7d2bf2e9">surf</a>(3,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),&amp;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;             <a class="code" href="namespaceallocatearray.html#a25ebdf393dee2419f983b4ac7d2bf2e9">surf</a>(4,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),&amp;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;             <a class="code" href="namespacesues__data.html#ab2070158f8b88b8f7835232841061718">nsh_real</a>,&amp;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;             <a class="code" href="namespaceallocatearray.html#aeaa22bcbc221cc3e0ca82aa0ac739fd3">drain</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)&amp;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;             )</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">!HCW added and changed to surf(6,is) here 20 Feb 2015</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="namespacesues__data.html#a96e76d9edd6c97fcdbc8f73047e189f3">drain_per_tstep</a>=<a class="code" href="namespacesues__data.html#a96e76d9edd6c97fcdbc8f73047e189f3">drain_per_tstep</a>+(<a class="code" href="namespaceallocatearray.html#aeaa22bcbc221cc3e0ca82aa0ac739fd3">drain</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)/<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>)   <span class="comment">!No water body included</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="keywordflow">     ENDDO</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;     <a class="code" href="namespaceallocatearray.html#aeaa22bcbc221cc3e0ca82aa0ac739fd3">drain</a>(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>-1)=0</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="namespaceallocatearray.html#aeaa22bcbc221cc3e0ca82aa0ac739fd3">drain</a>(<a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>) = 0  <span class="comment">! Set drainage from water body to zero</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">! Distribute water within grid, according to WithinGridWaterDist matrix (Cols 1-7)</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling ReDistributeWater...&#39;</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">! CALL ReDistributeWater</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">!Calculates AddWater(is)</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___re_distribute_water_8f95.html#a7dd364785adedd079304b29447c701d3">redistributewater</a>(&amp;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;       <a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,&amp; <span class="comment">! surface type number</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;       <a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>,&amp;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;       <a class="code" href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">snowuse</a>,&amp;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;       <a class="code" href="namespaceallocatearray.html#a7d0c9b91506a6be29f8c45bbb9a0411c">waterdist</a>,  &amp;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;       <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,   &amp;<span class="comment">!</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;       <a class="code" href="namespaceallocatearray.html#aeaa22bcbc221cc3e0ca82aa0ac739fd3">drain</a>,&amp;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;       <a class="code" href="namespaceallocatearray.html#aa390fe06fd3fcecf38ff94ac0367e04c">addwaterrunoff</a>,&amp;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;       <a class="code" href="namespaceallocatearray.html#a01b956e9e6112af17136ffd957d4c481">addwater</a>&amp;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;       )</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <span class="comment">!======== Evaporation and surface state ========</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling evap_SUEWS and SoilStore...&#39;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>   <span class="comment">!For each surface in turn</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;     <span class="keywordflow">IF</span> (<a class="code" href="namespaceallocatearray.html#ae1fb990049408fe1fa4f557577937ed6">snowcalcswitch</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)/=0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;           <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SnowCalc...&#39;</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;           <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___snow_8f95.html#a2035fba82c9957964a34a3e537c5de1e">snowcalc</a></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;           <a class="code" href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">snowfrac</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>) = 0</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;           <a class="code" href="namespaceallocatearray.html#ac7b06ad52874f40a2c456863ffa3d262">snowdens</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>) = 0</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;           <a class="code" href="namespaceallocatearray.html#a0c3675a79f0c6c3921beb95eb4d9d48f">snowpack</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>) = 0</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="comment">!Calculates ev [mm]</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__evap_8f95.html#abb65abdb24905224cba51fe03f61809c">evap_suews</a>(&amp;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;             <a class="code" href="namespacedata__in.html#a71e2da70dfd1593a6a4770f164bcc146">ity</a>,&amp;<span class="comment">!Evaporation calculated according to Rutter (1) or Shuttleworth (2)</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;             <a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),&amp; <span class="comment">! wetness status</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;             <a class="code" href="namespaceallocatearray.html#ade77725040669c18c67ee2a4891b2711">wetthresh</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),&amp;<span class="comment">!When State &gt; WetThresh, rs=0 limit in SUEWS_evap [mm] (specified in input files)</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;             <a class="code" href="namespaceallocatearray.html#a25ebdf393dee2419f983b4ac7d2bf2e9">surf</a>(6,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),&amp; <span class="comment">! = surf(is,6), current storage capacity [mm]</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;             <a class="code" href="namespacesues__data.html#a06a4500745768a4bcf4886312a028e0c">numpm</a>,&amp;<span class="comment">!numerator of P-M eqn</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;             <a class="code" href="namespacemoist.html#ab898e28f0ece3e6a2c1852fd8fe61bc1">s_hpa</a>,&amp;<span class="comment">!Vapour pressure versus temperature slope in hPa</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;             <a class="code" href="namespacemoist.html#a8a8d0c665be356954056ed6c102b953b">psyc_hpa</a>,&amp;<span class="comment">!Psychometric constant in hPa</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;             <a class="code" href="namespacesues__data.html#a678cac1e19ddb70f811693772c031f0c">resistsurf</a>,&amp;<span class="comment">!Surface resistance</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;             <a class="code" href="namespacesues__data.html#a77243f6b1c7d2baecb0d13f5d98b4318">sp</a>,&amp;<span class="comment">!Term in calculation of E</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;             <a class="code" href="namespacesues__data.html#aafce3a183c34dd4df5268cdbfc8aea24">ra</a>,&amp;<span class="comment">!Aerodynamic resistance</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;             <a class="code" href="namespacesues__data.html#a90293da57db1b1a3a4bc0979d2005640">rb</a>,&amp;<span class="comment">!Boundary layer resistance</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;             <a class="code" href="namespacemoist.html#a4572c899e5e83d9647c7ed9f16901c24">tlv</a>,&amp;<span class="comment">!Latent heat of vaporization per timestep [J kg-1 s-1], (tlv=lv_J_kg/tstep_real)</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                <span class="comment">! output:</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;             <a class="code" href="namespacesues__data.html#ae3375f2161517eabda778cd0642076c5">rss</a>,&amp;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;             <a class="code" href="namespacesues__data.html#a879c9f9f7cf8597fe30edea62a95bcdd">ev</a>,&amp;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;             <a class="code" href="namespacedata__in.html#a15dff170cc3ed5a26f5b095eebf80392">qe</a>&amp; <span class="comment">! latent heat flux [W m-2]</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;             )</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <a class="code" href="namespaceallocatearray.html#ac0727c70a30d09ad8597e7b6456b619f">rss_nsurf</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>) = <a class="code" href="namespacesues__data.html#ae3375f2161517eabda778cd0642076c5">rss</a> <span class="comment">!Store rss for each surface</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="comment">! CALL soilstore    !Surface water balance and soil store updates (can modify ev, updates state)</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="comment">!Surface water balance and soil store updates (can modify ev, updates state)</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__store_8f95.html#ab8fa354f6cb05440dc295f8d7f099306">soilstore</a>(&amp;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;             <a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,&amp; <span class="comment">! number of surface types</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;             <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>,&amp; <span class="comment">! surface type</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;             <a class="code" href="namespaceallocatearray.html#a5a6ce5dda0d024d7333d95ba544f38c9">pavsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;             <a class="code" href="namespaceallocatearray.html#afbbcbdfd67c32839a537f74d1bc6ff5a">bldgsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;             <a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;             <a class="code" href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">conifsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;             <a class="code" href="namespaceallocatearray.html#a570d73b34ec4b42f6f6075640a282619">bsoilsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;             <a class="code" href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">decidsurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;             <a class="code" href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">grasssurf</a>,&amp;<span class="comment">! surface type code</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;             <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,&amp;<span class="comment">! surface fractions</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;             <a class="code" href="namespacesues__data.html#ab2dc1363710dd5d250384fe643279fd7">pipecapacity</a>,&amp;<span class="comment">!Capacity of pipes to transfer water</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;             <a class="code" href="namespacesues__data.html#a92f648948ca3627c9bc8442568c4bba1">runofftowater</a>,&amp;<span class="comment">!Fraction of surface runoff going to water body</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;             <a class="code" href="namespacesues__data.html#aa2d35158f50e5437170a36712c99a891">pin</a>,&amp;<span class="comment">!Rain per time interval</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;             <a class="code" href="namespacesues__data.html#a6aa0ce59c7eee4b94b9ee86ac5b555d0">wu_evetr</a>,&amp;<span class="comment">!Water use for evergreen trees/shrubs [mm]</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;             <a class="code" href="namespacesues__data.html#a087f298012279c621f24a283b360d592">wu_dectr</a>,&amp;<span class="comment">!Water use for deciduous trees/shrubs [mm]</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;             <a class="code" href="namespacesues__data.html#a56315a7303bf70155e92ead9b64493c2">wu_grass</a>,&amp;<span class="comment">!Water use for grass [mm]</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;             <a class="code" href="namespaceallocatearray.html#a01b956e9e6112af17136ffd957d4c481">addwater</a>,&amp;<span class="comment">!Water from other surfaces (WGWaterDist in SUEWS_ReDistributeWater.f95) [mm]</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;             <a class="code" href="namespacesues__data.html#af0fed458b1eefc0164c4ffb6d6e2d1a2">addimpervious</a>,&amp;<span class="comment">!Water from impervious surfaces of other grids [mm] for whole surface area</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;             <a class="code" href="namespacesues__data.html#ab2070158f8b88b8f7835232841061718">nsh_real</a>,&amp;<span class="comment">!nsh cast as a real for use in calculations</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;             <a class="code" href="namespaceallocatearray.html#a417b9ff3eb6479963b494b8c50d661c2">stateold</a>,&amp;<span class="comment">!Wetness status of each surface type from previous timestep [mm]</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;             <a class="code" href="namespaceallocatearray.html#aa390fe06fd3fcecf38ff94ac0367e04c">addwaterrunoff</a>,&amp;<span class="comment">!Fraction of water going to runoff/sub-surface soil (WGWaterDist) [-]</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;             <a class="code" href="namespacegis__data.html#aafb1e051dfaaf0a04760dc14acf4b053">pervfraction</a>,&amp;<span class="comment">! sum of surface cover fractions for impervious surfaces</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;             <a class="code" href="namespacesues__data.html#a2553d0e5b7218422246f2078b379fed5">addveg</a>,&amp;<span class="comment">!Water from vegetated surfaces of other grids [mm] for whole surface area</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;             <a class="code" href="namespaceallocatearray.html#a1c0a391fbf8e63a46d93cae2c6c11049">soilstorecap</a>,&amp;<span class="comment">!Capacity of soil store for each surface [mm]</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;             <a class="code" href="namespacesues__data.html#aa314ccdf6d41a3901fa922504f030203">addwaterbody</a>,&amp;<span class="comment">!Water from water surface of other grids [mm] for whole surface area</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;             <a class="code" href="namespacesues__data.html#aafb79a529ff89254c1399e96d77a5fe0">flowchange</a>,&amp;<span class="comment">!Difference between the input and output flow in the water body</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;             <a class="code" href="namespaceallocatearray.html#a66a859de2b0cea378b18814cdb0438ba">statelimit</a>,&amp;<span class="comment">!Limit for state of each surface type [mm] (specified in input files)</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                <span class="comment">!  inout:</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;             <a class="code" href="namespacesues__data.html#ac376fe6389c7367c307fce12d816009c">runoffagimpervious</a>,&amp;<span class="comment">!Above ground runoff from impervious surface [mm] for whole surface area</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;             <a class="code" href="namespacesues__data.html#ac93567a8ca56d05105523626613f5cc4">surpluswaterbody</a>,&amp;<span class="comment">!Extra runoff that goes to water body [mm] as specified by RunoffToWater</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;             <a class="code" href="namespacesues__data.html#ac2654954c97c2cbba667e51f44850250">runoffagveg</a>,&amp;<span class="comment">!Above ground runoff from vegetated surfaces [mm] for whole surface area</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;             <a class="code" href="namespacesues__data.html#a20b9d66de8207bb6709f620aebc98b17">runoffpipes</a>,&amp;<span class="comment">!Runoff in pipes [mm] for whole surface area</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;             <a class="code" href="namespacesues__data.html#a879c9f9f7cf8597fe30edea62a95bcdd">ev</a>,&amp;<span class="comment">!Evaporation</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;             <a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>,&amp;<span class="comment">!Soil moisture of each surface type [mm]</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;             <a class="code" href="namespacesues__data.html#a08d117cca68ee0e84a8b286a038434c6">surplusevap</a>,&amp;<span class="comment">!Surplus for evaporation in 5 min timestep</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;             <a class="code" href="namespacesues__data.html#a0fce415bc7210db0cfe37ded2d8c1ef5">runoffwaterbody</a>,&amp;<span class="comment">!Above ground runoff from water surface [mm] for whole surface area</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;             <a class="code" href="namespacesues__data.html#a3e74512061da577d1697d50324b5ea28">runoff_per_interval</a>,&amp;<span class="comment">! Total water transported to each grid for grid-to-grid connectivity</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                <span class="comment">!  output:</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;             <a class="code" href="namespacesues__data.html#a9ddcc1842e650815dfc06fa4a3bf6a78">p_mm</a>,&amp;<span class="comment">!Inputs to surface water balance</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;             <a class="code" href="namespaceallocatearray.html#a2c176341a882c22aab3f1b01844f4fa0">chang</a>,&amp;<span class="comment">!Change in state [mm]</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;             <a class="code" href="namespaceallocatearray.html#abf84199761d02e1a9304d1d7a2c00eba">runoff</a>,&amp;<span class="comment">!Runoff from each surface type [mm]</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;             <a class="code" href="namespaceallocatearray.html#aeaa22bcbc221cc3e0ca82aa0ac739fd3">drain</a>,&amp;<span class="comment">!Drainage of each surface type [mm]</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;             <a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>&amp;<span class="comment">!Wetness status of each surface type [mm]</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;             )</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <a class="code" href="namespaceallocatearray.html#a91095edf69a936902a3586fe9ef958a3">evap</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)     = <a class="code" href="namespacesues__data.html#a879c9f9f7cf8597fe30edea62a95bcdd">ev</a> <span class="comment">!Store ev for each surface</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="comment">! Sum evaporation from different surfaces to find total evaporation [mm]</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <a class="code" href="namespacesues__data.html#a11bc80be13a121686d39d355d6c98aa9">ev_per_tstep</a> = <a class="code" href="namespacesues__data.html#a11bc80be13a121686d39d355d6c98aa9">ev_per_tstep</a>+<a class="code" href="namespaceallocatearray.html#a91095edf69a936902a3586fe9ef958a3">evap</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="comment">! Sum change from different surfaces to find total change to surface state</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="namespacesues__data.html#a1848f093a3dd5ebdc1da775e9cda8509">surf_chang_per_tstep</a> = <a class="code" href="namespacesues__data.html#a1848f093a3dd5ebdc1da775e9cda8509">surf_chang_per_tstep</a>+(<a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)-<a class="code" href="namespaceallocatearray.html#a417b9ff3eb6479963b494b8c50d661c2">stateold</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>))*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="comment">! Sum runoff from different surfaces to find total runoff</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <a class="code" href="namespacesues__data.html#a15eb03975ee429099b923fc02a2577ca">runoff_per_tstep</a>     = <a class="code" href="namespacesues__data.html#a15eb03975ee429099b923fc02a2577ca">runoff_per_tstep</a>+<a class="code" href="namespaceallocatearray.html#abf84199761d02e1a9304d1d7a2c00eba">runoff</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="comment">! Calculate total state (including water body)</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <a class="code" href="namespacesues__data.html#abdb761c4b6b03cace33c5c54eb3607b2">state_per_tstep</a>      = <a class="code" href="namespacesues__data.html#abdb761c4b6b03cace33c5c54eb3607b2">state_per_tstep</a>+(<a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>))</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="comment">! Calculate total state (excluding water body)</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>/=0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;           <span class="keywordflow">IF</span> (<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>.NE.<a class="code" href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">watersurf</a>) <a class="code" href="namespacesues__data.html#a9a093b62067234bd553e776c06ac4df9">nwstate_per_tstep</a>=<a class="code" href="namespacesues__data.html#a9a093b62067234bd553e776c06ac4df9">nwstate_per_tstep</a>+(<a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)/<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <a class="code" href="namespaceallocatearray.html#a215dffcb1ced9f49787128f695cbf8d7">changsnow</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)  = 0</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="namespaceallocatearray.html#ad99e95bac5bad1e8fd7ae73daf74933e">runoffsnow</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>) = 0</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="keywordflow">     ENDIF</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="keywordflow">  ENDDO</span>  <span class="comment">!end loop over surfaces</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="comment">! Convert evaporation to latent heat flux [W m-2]</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <a class="code" href="namespacesues__data.html#a8506404b27e8b0ded77802f2ab475928">qe_per_tstep</a> = <a class="code" href="namespacesues__data.html#a11bc80be13a121686d39d355d6c98aa9">ev_per_tstep</a>*<a class="code" href="namespacemoist.html#a4572c899e5e83d9647c7ed9f16901c24">tlv</a></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <a class="code" href="namespacesues__data.html#ae467db694bf0c56a1afbee403a0d8907">qeout</a>        = <a class="code" href="namespacesues__data.html#a8506404b27e8b0ded77802f2ab475928">qe_per_tstep</a></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="comment">!============ Sensible heat flux ===============</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">! Calculate sensible heat flux as a residual (Modified by LJ in Nov 2012)</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <a class="code" href="namespacedata__in.html#ade512e4aad4c64404e1c974241c965e7">qh</a>=(<a class="code" href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">qn1</a>+<a class="code" href="namespacedata__in.html#a13eb3e18ed56b78668ba6c47d11ba155">qf</a>+<a class="code" href="namespacesnowmod.html#a35fe883b6ebd9767f44c27354160afd3">qmrain</a>)-(<a class="code" href="namespacesues__data.html#ae467db694bf0c56a1afbee403a0d8907">qeout</a>+<a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>+<a class="code" href="namespacesnowmod.html#a1d7e7d0b8974783e0320cde393e09594">qm</a>+<a class="code" href="namespacesnowmod.html#adbb58215814d438f2486f880958737be">qmfreez</a>)     <span class="comment">!qh=(qn1+qf+QmRain+QmFreez)-(qeOut+qs+Qm)</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="comment">! Calculate QH using resistance method (for testing HCW 06 Jul 2016)</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacesues__data.html#aafce3a183c34dd4df5268cdbfc8aea24">ra</a>/=0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;     <a class="code" href="namespacedata__in.html#a7144dc07db9d95f72aedabd88c44bf99">qh_r</a> = <a class="code" href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">avdens</a>*<a class="code" href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">avcp</a>*(<a class="code" href="namespacedata__in.html#a743440f75d11d6596e13e18b78d7f531">tsurf</a>-<a class="code" href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">temp_c</a>)/<a class="code" href="namespacesues__data.html#aafce3a183c34dd4df5268cdbfc8aea24">ra</a></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;     <a class="code" href="namespacedata__in.html#a7144dc07db9d95f72aedabd88c44bf99">qh_r</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">!============ surface-level diagonostics ===============</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">! wind speed:</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___diagnostics_8f95.html#aebc4694f2c98d834f1b236f7b49cb4b7">diagsfc</a>(0.,0.,<a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>,<a class="code" href="namespacegis__data.html#a16985ccbad5040769f8cd039103c4f15">veg_fr</a>,<a class="code" href="namespacedata__in.html#ad753c5f26f6cfaac607edf93d4c2dd1d">avu10_ms</a>,0)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">! temperature:</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___diagnostics_8f95.html#aebc4694f2c98d834f1b236f7b49cb4b7">diagsfc</a>(<a class="code" href="namespacedata__in.html#a743440f75d11d6596e13e18b78d7f531">tsurf</a>,<a class="code" href="namespacedata__in.html#ade512e4aad4c64404e1c974241c965e7">qh</a>,<a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>,<a class="code" href="namespacegis__data.html#a16985ccbad5040769f8cd039103c4f15">veg_fr</a>,<a class="code" href="namespacedata__in.html#a4bb1b5c9961c3b92df299792352bed5b">t2_c</a>,1)</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">! humidity:</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___diagnostics_8f95.html#aebc4694f2c98d834f1b236f7b49cb4b7">diagsfc</a>(qsatf(<a class="code" href="namespacedata__in.html#a743440f75d11d6596e13e18b78d7f531">tsurf</a>,<a class="code" href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">press_hpa</a>)*1000,&amp; <span class="comment">! Saturation specific humidity at surface in g/kg</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;       <a class="code" href="namespacesues__data.html#ae467db694bf0c56a1afbee403a0d8907">qeout</a>,<a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>,<a class="code" href="namespacegis__data.html#a16985ccbad5040769f8cd039103c4f15">veg_fr</a>,<a class="code" href="namespacedata__in.html#a56c3960c55d29dadfd4d6be5ec53cc3c">q2_gkg</a>,2)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="comment">!============ surface-level diagonostics end ===============</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="comment">!write(*,*) Gridiv, qn1, qf, qh, qeOut, qs, qn1+qf-qs</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="comment">!if(ir &gt; 155 .and. ir &lt;165) pause</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="comment">!if((qn1+qf-qs) - (qeOut) &lt; -1)  then</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">!    write(*,*) &#39;!!&#39;, (qn1+qf-qs),(qeOut)</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="comment">!    pause</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="comment">!endif</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">!if(ir &gt; 600) pause</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">!if(Gridiv == 3) write(*,*) &#39;&#39;</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">!if(Gridiv == 3 .and. ir == 100) pause</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">!!if(Gridiv == 3 .and.ir == 200) pause</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">!!if(Gridiv == 3 .and.ir == 300) pause</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">!if(Gridiv == 3 .and.ir == 400) pause</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">!if(Gridiv == 3 .and. ir == irMax ) pause</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="comment">! Calculate volume of water that will move between grids</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">! Volume [m3] = Depth relative to whole area [mm] / 1000 [mm m-1] * SurfaceArea [m2]</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">! Need to use these volumes when converting back to addImpervious, AddVeg and AddWater</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <a class="code" href="namespacesues__data.html#a56bf7a98188b09dfcd2c9daed991f1b0">runoffagimpervious_m3</a> = <a class="code" href="namespacesues__data.html#ac376fe6389c7367c307fce12d816009c">runoffagimpervious</a>/1000 *<a class="code" href="namespacesues__data.html#a9d6a1e2ae7fe7c36fb4aaa9e2e3c2137">surfacearea</a></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <a class="code" href="namespacesues__data.html#a030c38cf6a2cc1b2121491399a0353a5">runoffagveg_m3</a>        = <a class="code" href="namespacesues__data.html#ac2654954c97c2cbba667e51f44850250">runoffagveg</a>/1000 *<a class="code" href="namespacesues__data.html#a9d6a1e2ae7fe7c36fb4aaa9e2e3c2137">surfacearea</a></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <a class="code" href="namespacesues__data.html#abc5b5ae18f30abb3a858e2e24e1e99d7">runoffwaterbody_m3</a>    = <a class="code" href="namespacesues__data.html#a0fce415bc7210db0cfe37ded2d8c1ef5">runoffwaterbody</a>/1000 *<a class="code" href="namespacesues__data.html#a9d6a1e2ae7fe7c36fb4aaa9e2e3c2137">surfacearea</a></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <a class="code" href="namespacesues__data.html#ac5a856a3cdf4ba0b3a9150f2a08bb13d">runoffpipes_m3</a>        = <a class="code" href="namespacesues__data.html#a20b9d66de8207bb6709f620aebc98b17">runoffpipes</a>/1000 *<a class="code" href="namespacesues__data.html#a9d6a1e2ae7fe7c36fb4aaa9e2e3c2137">surfacearea</a></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">!=== Horizontal movement between soil stores ===</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  <span class="comment">! Now water is allowed to move horizontally between the soil stores</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling HorizontalSoilWater...&#39;</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="comment">! CALL HorizontalSoilWater</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s___horizontal_soil_water_8f95.html#aa5c24f37e4b3d33a10399364e652cab0">horizontalsoilwater</a>(&amp;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                <span class="comment">! input:</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;       <a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>,&amp;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;       <a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>,&amp;<span class="comment">! surface fractions</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;       <a class="code" href="namespaceallocatearray.html#a1c0a391fbf8e63a46d93cae2c6c11049">soilstorecap</a>,&amp;<span class="comment">!Capacity of soil store for each surface [mm]</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;       <a class="code" href="namespaceallocatearray.html#a243033c7c16c825a30417c6bd4ea9f4e">soildepth</a>,&amp;<span class="comment">!Depth of sub-surface soil store for each surface [mm]</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;       <a class="code" href="namespaceallocatearray.html#a7a8427e580d0969440e13673f28c5104">sathydraulicconduct</a>,&amp;<span class="comment">!Saturated hydraulic conductivity for each soil subsurface [mm s-1]</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;       <a class="code" href="namespacesues__data.html#a9d6a1e2ae7fe7c36fb4aaa9e2e3c2137">surfacearea</a>,&amp;<span class="comment">!Surface area of the study area [m2]</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;       <a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>,&amp;<span class="comment">! sum of surface cover fractions for all except water surfaces</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;       <a class="code" href="namespacesues__data.html#a81a241a978fdd040dee716c4e68dc786">tstep_real</a>,&amp; <span class="comment">!tstep cast as a real for use in calculations</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                                <span class="comment">! inout:</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;       <a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>,&amp;<span class="comment">!Soil moisture of each surface type [mm]</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;       <a class="code" href="namespaceallocatearray.html#a56dec28d9173b960574b82696b82f7a2">runoffsoil</a>,&amp;<span class="comment">!Soil runoff from each soil sub-surface [mm]</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;       <a class="code" href="namespacesues__data.html#a3b42551207483efdea0f50bba253afe4">runoffsoil_per_tstep</a>&amp;<span class="comment">!Runoff to deep soil per timestep [mm] (for whole surface, excluding water body)</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;       )</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">!========== Calculate soil moisture ============</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>=0       <span class="comment">!Area-averaged soil moisture [mm] for whole surface</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>/=0) <span class="keywordflow">THEN</span> <span class="comment">!Fixed for water surfaces only</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;     <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>-1   <span class="comment">!No water body included</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>=<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>+(<a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)/<a class="code" href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">nonwaterfraction</a>)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">IF</span> (<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>&lt;0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;           <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(62,<span class="stringliteral">&#39;SUEWS_Calculations: total soilstate &lt; 0 (just added surface is) &#39;</span>,<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>,<a class="code" href="namespacedefaultnotused.html#a71e2d536a1c83e98103c3ed183c303cd">notused</a>,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">ELSEIF</span> (<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>&gt;<a class="code" href="namespacesues__data.html#ada5a214d0c4d5da587baa5f8de1da6d9">soilmoistcap</a>) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;           <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(62,<span class="stringliteral">&#39;SUEWS_Calculations: total soilstate &gt; capacity (just added surface is) &#39;</span>,<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>,<a class="code" href="namespacedefaultnotused.html#a71e2d536a1c83e98103c3ed183c303cd">notused</a>,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;           <span class="comment">!SoilMoist_state=soilMoistCap !What is this LJ 10/2010 - SM exceeds capacity, but where does extra go?HCW 11/2014</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keywordflow">        ENDIF</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="keywordflow">     ENDDO</span>  <span class="comment">!end loop over surfaces</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">! Calculate soil moisture deficit</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <a class="code" href="namespacesues__data.html#ac73de7c829233718bfd143f4346adf70">smd</a>=<a class="code" href="namespacesues__data.html#ada5a214d0c4d5da587baa5f8de1da6d9">soilmoistcap</a>-<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>   <span class="comment">!One value for whole surface</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <a class="code" href="namespaceallocatearray.html#a1dcc99b13956867bdc2a58c234193a2e">smd_nsurf</a>=<a class="code" href="namespaceallocatearray.html#a1c0a391fbf8e63a46d93cae2c6c11049">soilstorecap</a>-<a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>   <span class="comment">!smd for each surface</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">! Soil stores can change after horizontal water movements</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">! Calculate total change in surface and soil state</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="namespacesues__data.html#a82ac11b95b008fb43921aac3b503efad">tot_chang_per_tstep</a> = <a class="code" href="namespacesues__data.html#a1848f093a3dd5ebdc1da775e9cda8509">surf_chang_per_tstep</a>   <span class="comment">!Change in surface state</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,(<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>-1)   <span class="comment">!No soil for water surface (so change in soil moisture is zero)</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;     <a class="code" href="namespacesues__data.html#a82ac11b95b008fb43921aac3b503efad">tot_chang_per_tstep</a> = <a class="code" href="namespacesues__data.html#a82ac11b95b008fb43921aac3b503efad">tot_chang_per_tstep</a> + ((<a class="code" href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">soilmoist</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)-<a class="code" href="namespaceallocatearray.html#a21359b000cf1cea64f86412e4336b957">soilmoistold</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>))*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>))   <span class="comment">!Add change in soil state</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="keywordflow">  ENDDO</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">!=====================================================================</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">!====================== Prepare data for output ======================</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="comment">! Check surface composition (HCW 21 Jul 2016)</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="comment">! if totally water surface, set output to -999 for columns that do not exist</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="comment">!IF(sfr(WaterSurf)==1) THEN</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment">!   NWstate_per_tstep = NAN    !no non-water surface</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="comment">!   smd = NAN                  !no soil store beneath water surface</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="comment">!   soilstate = NAN</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">!   runoffSoil_per_tstep = NAN</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">!   drain_per_tstep = NAN      !no drainage from water surf</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">!ENDIF</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">!These removed as now all these get a value of 0. LJ 15/06/2017</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">! Remove non-existing surface type from surface and soil outputs   ! Added back in with NANs by HCW 24 Aug 2016</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;     <span class="keywordflow">IF</span> (<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)&lt;0.00001) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <a class="code" href="namespaceallocatearray.html#ac4a521fdb896dece1a1412de6892e77c">stateout</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)= <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <a class="code" href="namespaceallocatearray.html#a332b5e58530f77936db6b394822768c9">smd_nsurfout</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)= <a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="comment">!runoffOut(is)= NAN</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="comment">!runoffSoilOut(is)= NAN</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;     <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <a class="code" href="namespaceallocatearray.html#ac4a521fdb896dece1a1412de6892e77c">stateout</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)=<a class="code" href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">state</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <a class="code" href="namespaceallocatearray.html#a332b5e58530f77936db6b394822768c9">smd_nsurfout</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)=<a class="code" href="namespaceallocatearray.html#a1dcc99b13956867bdc2a58c234193a2e">smd_nsurf</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="comment">!runoffOut(is)=runoff(is)</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="comment">!runoffSoilOut(is)=runoffSoil(is)</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="keywordflow">     ENDIF</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="keywordflow">  ENDDO</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">! Remove negative state   !ErrorHint added, then commented out by HCW 16 Feb 2015 as should never occur</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">!if(st_per_interval&lt;0) then</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">!   call ErrorHint(63,&#39;SUEWS_Calculations: st_per_interval &lt; 0&#39;,st_per_interval,NotUsed,NotUsedI)</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">!   !st_per_interval=0</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">!endif</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">!Set limits on output data to avoid formatting issues ---------------------------------</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">! Set limits as +/-9999, depending on sign of value</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">! errorHints -&gt; warnings commented out as writing these slow down the code considerably when there are many instances</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacesues__data.html#a678cac1e19ddb70f811693772c031f0c">resistsurf</a> &gt; 9999) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;     <span class="comment">!CALL errorHint(6,&#39;rs set to 9999 s m-1 in output; calculated value &gt; 9999 s m-1&#39;,ResistSurf,notUsed,notUsedI)</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;     <a class="code" href="namespacesues__data.html#a678cac1e19ddb70f811693772c031f0c">resistsurf</a>=9999</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">l_mod</a> &gt; 9999) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;     <span class="comment">!CALL errorHint(6,&#39;Lob set to 9999 m in output; calculated value &gt; 9999 m&#39;,L_mod,notUsed,notUsedI)</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;     <a class="code" href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">l_mod</a>=9999</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">l_mod</a> &lt; -9999) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;     <span class="comment">!CALL errorHint(6,&#39;Lob set to -9999 m in output; calculated value &lt; -9999 m&#39;,L_mod,notUsed,notUsedI)</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;     <a class="code" href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">l_mod</a>=-9999</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="comment">! Set NA values   !!Why only these variables??  !!ErrorHints here too - error hints can be very slow here</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacedata__in.html#ade512e4aad4c64404e1c974241c965e7">qh</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacedata__in.html#ade512e4aad4c64404e1c974241c965e7">qh</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacedata__in.html#a7144dc07db9d95f72aedabd88c44bf99">qh_r</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacedata__in.html#a7144dc07db9d95f72aedabd88c44bf99">qh_r</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacesues__data.html#ae467db694bf0c56a1afbee403a0d8907">qeout</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacesues__data.html#ae467db694bf0c56a1afbee403a0d8907">qeout</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">qs</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacesues__data.html#a79ed0c9098d69fcbc6ad9a95fddaf013">ch_per_interval</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacesues__data.html#a79ed0c9098d69fcbc6ad9a95fddaf013">ch_per_interval</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacesues__data.html#a1848f093a3dd5ebdc1da775e9cda8509">surf_chang_per_tstep</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacesues__data.html#a1848f093a3dd5ebdc1da775e9cda8509">surf_chang_per_tstep</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacesues__data.html#a82ac11b95b008fb43921aac3b503efad">tot_chang_per_tstep</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacesues__data.html#a82ac11b95b008fb43921aac3b503efad">tot_chang_per_tstep</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">soilstate</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">IF</span>(abs(<a class="code" href="namespacesues__data.html#ac73de7c829233718bfd143f4346adf70">smd</a>)&gt;<a class="code" href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">pnan</a>) <a class="code" href="namespacesues__data.html#ac73de7c829233718bfd143f4346adf70">smd</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">! If measured smd is used, set components to -999 and smd output to measured one</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#a306f10a44e3e8097152fc6a9c0403f6b">smdmethod</a>&gt;0) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;     <a class="code" href="namespaceallocatearray.html#a1dcc99b13956867bdc2a58c234193a2e">smd_nsurf</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;     <a class="code" href="namespaceallocatearray.html#a332b5e58530f77936db6b394822768c9">smd_nsurfout</a>=<a class="code" href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">nan</a></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;     <a class="code" href="namespacesues__data.html#ac73de7c829233718bfd143f4346adf70">smd</a>=<a class="code" href="namespacedata__in.html#a22f13004f0c25b6603cceb88897eaee5">xsmd</a></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="comment">! Calculate areally-weighted LAI</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacetime.html#a7dd4adda8e1403aee1caa796036c7204">iy</a> == (<a class="code" href="namespacetime.html#a6c4033d0e3f01ba6ea142f00749d0e4e">iy_prev_t</a>+1) .AND. (<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1) == 0) <span class="keywordflow">THEN</span>   <span class="comment">!Check for start of next year and avoid using lai(id-1) as this is at the start of the year</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;     lai_wt=0</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;     <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#abb987c3b35dd321963fd53d38f10236f">nvegsurf</a></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        lai_wt=lai_wt+<a class="code" href="namespaceallocatearray.html#ab660d7e4ca340b0b677a74ecb8bb34f4">lai</a>(<a class="code" href="namespacetime.html#a12b68236a1014f7a9cee2fac8b4aa5f0">id_prev_t</a>,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>+2)</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="keywordflow">     ENDDO</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;     lai_wt=0</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;     <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#abb987c3b35dd321963fd53d38f10236f">nvegsurf</a></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        lai_wt=lai_wt+<a class="code" href="namespaceallocatearray.html#ab660d7e4ca340b0b677a74ecb8bb34f4">lai</a>(<a class="code" href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">id</a>-1,<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>+2)</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="keywordflow">     ENDDO</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">! Calculate areally-weighted albedo</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <a class="code" href="namespaceallocatearray.html#a7ded7a35772c822d536989835435a474">bulkalbedo</a> = 0</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordflow">DO</span> <a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;     <a class="code" href="namespaceallocatearray.html#a7ded7a35772c822d536989835435a474">bulkalbedo</a> = <a class="code" href="namespaceallocatearray.html#a7ded7a35772c822d536989835435a474">bulkalbedo</a> + <a class="code" href="namespaceallocatearray.html#ad49963261e823b38b1d9e6dad29978bd">alb</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)*<a class="code" href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">sfr</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>)</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keywordflow">  ENDDO</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="comment">! Save qh and qe for CBL in next iteration</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>==1) <span class="keywordflow">THEN</span>   <span class="comment">!use QH and QE from SUEWS</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;     <a class="code" href="namespacesues__data.html#a891cda3d0ef1f628e7dd9a185f00fc6c">qhforcbl</a>(gridiv) = <a class="code" href="namespacedata__in.html#ade512e4aad4c64404e1c974241c965e7">qh</a></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;     <a class="code" href="namespacesues__data.html#a08451f44609cb386788368a9136432c7">qeforcbl</a>(gridiv) = <a class="code" href="namespacesues__data.html#ae467db694bf0c56a1afbee403a0d8907">qeout</a></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>==2)<span class="keywordflow">THEN</span>   <span class="comment">!use QH and QE from LUMPS</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;     <a class="code" href="namespacesues__data.html#a891cda3d0ef1f628e7dd9a185f00fc6c">qhforcbl</a>(gridiv) = <a class="code" href="namespacedata__in.html#aaa77ae828595f5b1e1bec4237020dfbc">h_mod</a></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;     <a class="code" href="namespacesues__data.html#a08451f44609cb386788368a9136432c7">qeforcbl</a>(gridiv) = <a class="code" href="namespacedata__in.html#a737780f5cf53c9f2d3048bbfface32cd">e_mod</a></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="keywordflow">ELSEIF</span>(<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>==3)<span class="keywordflow">THEN</span>  <span class="comment">!use QH and QE from OBS</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;     <a class="code" href="namespacesues__data.html#a891cda3d0ef1f628e7dd9a185f00fc6c">qhforcbl</a>(gridiv) = <a class="code" href="namespacedata__in.html#a333bca61a59b05a5a5db0c7bb9daa2b9">qh_obs</a></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;     <a class="code" href="namespacesues__data.html#a08451f44609cb386788368a9136432c7">qeforcbl</a>(gridiv) = <a class="code" href="namespacedata__in.html#a89bbf8e5d0059c1005799182e4f5f703">qe_obs</a></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;     <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#a333bca61a59b05a5a5db0c7bb9daa2b9">qh_obs</a>&lt;-900.OR.<a class="code" href="namespacedata__in.html#a89bbf8e5d0059c1005799182e4f5f703">qe_obs</a>&lt;-900)<span class="keywordflow">THEN</span>  <span class="comment">! observed data has a problem</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a>(22,<span class="stringliteral">&#39;Unrealistic observed qh or qe_value.&#39;</span>,<a class="code" href="namespacedata__in.html#a333bca61a59b05a5a5db0c7bb9daa2b9">qh_obs</a>,<a class="code" href="namespacedata__in.html#a89bbf8e5d0059c1005799182e4f5f703">qe_obs</a>,<a class="code" href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">qh_choice</a>)</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="keywordflow">     ENDIF</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="comment">!=====================================================================</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="comment">!====================== Write out files ==============================</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="comment">!Define the overall output matrix to be printed out step by step</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <a class="code" href="namespaceallocatearray.html#ac655e803ebc3ca4bbd2e53835293f4f2">dataout</a>(ir,1:<a class="code" href="namespaceallocatearray.html#a9408900bed6c87ed095d2c688c1506a0">ncolumnsdataout</a>,gridiv)=(/<span class="keywordtype">REAL(iy,KIND(1D0))</span>,<span class="keywordtype">REAL(id,KIND(1D0))</span>,<span class="keywordtype">REAL(it,KIND(1D0))</span>,<span class="keywordtype">REAL(imin,KIND(1D0))</span>,dectime,&amp;   <span class="comment">!5</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;       avkdn,kup,ldown,lup,tsurf,&amp;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;       qn1,qf,qs,qh,qeOut,&amp;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;       h_mod,e_mod,qh_r,&amp;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;       precip,ext_wu,ev_per_tstep,runoff_per_tstep,tot_chang_per_tstep,&amp;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;       surf_chang_per_tstep,state_per_tstep,NWstate_per_tstep,drain_per_tstep,smd,&amp;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;       FlowChange/nsh_real,AdditionalWater,&amp;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;       runoffSoil_per_tstep,runoffPipes,runoffAGimpervious,runoffAGveg,runoffWaterBody,&amp;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;       int_wu,wu_EveTr,wu_DecTr,wu_Grass,&amp;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;       (<a class="code" href="namespaceallocatearray.html#a332b5e58530f77936db6b394822768c9">smd_nsurfout</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>-1),&amp;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;       (<a class="code" href="namespaceallocatearray.html#ac4a521fdb896dece1a1412de6892e77c">stateout</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),&amp;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;       <a class="code" href="namespacedata__in.html#a332530944dd5c37316f92c3c74350e83">zenith_deg</a>,<a class="code" href="namespacedata__in.html#a0abb9aefbb8c1dc5ac6ff2f770da7faa">azimuth</a>,<a class="code" href="namespaceallocatearray.html#a7ded7a35772c822d536989835435a474">bulkalbedo</a>,<a class="code" href="namespacedata__in.html#a8afa15b03c067e57c570544bd5562ac1">fcld</a>,&amp;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;       lai_wt,<a class="code" href="namespacemod__z.html#afd15a8bab419b8b576ccd3fa639d546f">z0m</a>,<a class="code" href="namespacemod__z.html#a85318ac2a4eb1313fc10432ff860214e">zdm</a>,&amp;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;       <a class="code" href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">ustar</a>,<a class="code" href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">l_mod</a>,<a class="code" href="namespacesues__data.html#aafce3a183c34dd4df5268cdbfc8aea24">ra</a>,<a class="code" href="namespacesues__data.html#a678cac1e19ddb70f811693772c031f0c">resistsurf</a>,&amp;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;       <a class="code" href="namespacedata__in.html#a8bc526d8d9a75c1ecef04817aac48046">fc</a>,&amp;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;       <a class="code" href="namespacedata__in.html#a39642f3fc927b3a4394dda8fef2c193b">fc_photo</a>,<a class="code" href="namespacedata__in.html#a5d6aae5bf11940a5ff7437dfec30cd4f">fc_respi</a>,<a class="code" href="namespacedata__in.html#a8676790950975f07daf8d24b503ef952">fc_metab</a>,<a class="code" href="namespacedata__in.html#a9fcca4951f8282ad10df290f8a025387">fc_traff</a>,<a class="code" href="namespacedata__in.html#a3c13cce56632f598e61b00bccdc94e4a">fc_build</a>,&amp;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;       <a class="code" href="namespacedata__in.html#af270ed598adad800b8338f7a0700183f">qn1_sf</a>,<a class="code" href="namespacedata__in.html#ae21258de695f82699606f7ced498693d">qn1_s</a>,<a class="code" href="namespacesnowmod.html#a269fc9eb4dcd8dc77888c370c046a3c2">snowalb</a>,&amp;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;       <a class="code" href="namespacesnowmod.html#a1d7e7d0b8974783e0320cde393e09594">qm</a>,<a class="code" href="namespacesnowmod.html#adbb58215814d438f2486f880958737be">qmfreez</a>,<a class="code" href="namespacesnowmod.html#a35fe883b6ebd9767f44c27354160afd3">qmrain</a>,<a class="code" href="namespacesnowmod.html#a216f7ed83c0474b708443eddfa6c574e">swe</a>,<a class="code" href="namespacesnowmod.html#a7e8123e5b32bedfb676ea5c6ca62272a">mwh</a>,<a class="code" href="namespacesnowmod.html#affe56e4e5f1d5df5d7f4bbae7ae22541">mwstore</a>,<a class="code" href="namespacesues__data.html#af62ec721dfd084ec5bce9224750e1330">chsnow_per_interval</a>,&amp;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;       (<a class="code" href="namespacesnowmod.html#a9c7d574d109596d16542b38123065e66">snowremoval</a>(<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>),<a class="code" href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">is</a>=1,2),&amp;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;       <a class="code" href="namespacedata__in.html#a4bb1b5c9961c3b92df299792352bed5b">t2_c</a>,<a class="code" href="namespacedata__in.html#a56c3960c55d29dadfd4d6be5ec53cc3c">q2_gkg</a>,<a class="code" href="namespacedata__in.html#ad753c5f26f6cfaac607edf93d4c2dd1d">avu10_ms</a>&amp; <span class="comment">! surface-level diagonostics</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;       /)</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keywordflow">IF</span> (<a class="code" href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">snowuse</a>==1) <span class="keywordflow">THEN</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;     <a class="code" href="namespaceallocatearray.html#a7e6a4164edb43537d8e21816ee3e33e9">dataoutsnow</a>(ir,1:<a class="code" href="namespaceallocatearray.html#ab4a2c7e53ba41245b200baa41aed6137">ncolumnsdataoutsnow</a>,gridiv)=(/<span class="keywordtype">REAL(iy,KIND(1D0))</span>,<span class="keywordtype">REAL(id,KIND(1D0))</span>,&amp;               <span class="comment">!2</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;          <span class="keywordtype">REAL(it,KIND(1D0))</span>,<span class="keywordtype">REAL(imin,KIND(1D0))</span>,dectime,&amp;                                        <span class="comment">!5</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          SnowPack(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),mw_ind(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),Qm_melt(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),&amp;                                     <span class="comment">!26</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;          Qm_rain(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),Qm_freezState(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),snowFrac(1:(<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>-1)),&amp;                          <span class="comment">!46</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;          rainOnSnow(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),&amp;                                                                    <span class="comment">!53</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;          qn1_ind_snow(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),kup_ind_snow(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),freezMelt(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),&amp;                         <span class="comment">!74</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;          MeltWaterStore(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),SnowDens(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),&amp;                                              <span class="comment">!88</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          snowDepth(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>),Tsurf_ind_snow(1:<a class="code" href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">nsurf</a>)/)                                             <span class="comment">!102</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="keywordflow">  ENDIF</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="comment">!Calculate new snow fraction used in the next timestep if snowUse==1</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="comment">!Calculated only at end of each hour.</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">!if (SnowFractionChoice==2.and.snowUse==1.and.it==23.and.imin==(nsh_real-1)/nsh_real*60) then</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="comment">!   do is=1,nsurf-1</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="comment">!      if ((snowPack(is)&gt;0.and.mw_ind(is)&gt;0)) then</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="comment">!         write(*,*) is,snowPack(is),snowD(is),mw_ind(is),snowFrac(is)!</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="comment">!         snowFrac(is)=SnowDepletionCurve(is,snowPack(is),snowD(is))</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="comment">!         write(*,*) snowFrac(is)</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="comment">!         pause</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="comment">!      elseif (snowPack(is)==0) then</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">!         snowFrac(is)=0</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">!      endif</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="comment">!   enddo</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="comment">!endif</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="comment">!write(*,*) DecidCap(id), id, it, imin, &#39;Calc - before translate back&#39;</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="comment">!write(*,*) iy, id, it, imin, &#39;Calc - before translate back&#39;</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="comment">!if(Gridiv==1)  write(*,*) iy, id, it, imin, HDD(id-1,5), HDD(id,5), HDD(id-1,6), HDD(id,6)</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="comment">!if(id==12) pause</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="comment">!write(*,*) &#39; &#39;</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="keywordflow">IF</span>(<a class="code" href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">diagnose</a>==1) <span class="keyword">WRITE</span>(*,*) <span class="stringliteral">&#39;Calling SUEWS_TranslateBack...&#39;</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keyword">CALL </span><a class="code" href="_s_u_e_w_s__translate_8f95.html#a5c6d5265e5c9daebbaaff8999791406e">suews_translateback</a>(gridiv,ir,irmax)</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="comment">!  ! store water balance states of the day, by TS 13 Apr 2016</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="comment">!  IF ( ir==irMax ) THEN</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="comment">!       PRINT*, &#39;ending end of&#39;, id,it,imin</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  <span class="comment">!     stateDay(id,Gridiv,:)     = state(:)</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <span class="comment">!     soilmoistDay(id,Gridiv,:) = soilmoist(:)</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">!       PRINT*, &#39;state:&#39;, state</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">!       PRINT*, &#39;soilmoist&#39;, soilmoist</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">!       PRINT*, &#39;********************************&#39;</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="comment">!  END IF</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="comment">! if ( id&gt;10 ) then</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">!   stop &quot;stop to test state&quot;</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="comment">! end if</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">!!!if((id &lt;=3 .or. id &gt; 364).and. it == 0 .and. imin == 0) pause</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">!!!if((id &lt;=3 .or. id &gt; 364).and. it == 23 .and. imin == 55) pause</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">!!!if((id &gt;=100 .or. id &lt; 103).and. it == 0 .and. imin == 0) pause</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">! write(*,*) &#39;------------&#39;</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="keyword">END SUBROUTINE </span><a class="code" href="_s_u_e_w_s___calculations_8f95.html#a178f1acf059ccbc65e48be6eb7f37baf">suews_calculations</a></div><div class="ttc" id="namespaceallocatearray_html_a25ebdf393dee2419f983b4ac7d2bf2e9"><div class="ttname"><a href="namespaceallocatearray.html#a25ebdf393dee2419f983b4ac7d2bf2e9">allocatearray::surf</a></div><div class="ttdeci">real(kind(1d0)), dimension(6, nsurf) surf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00196">LUMPS_Module_constants.f95:196</a></div></div>
<div class="ttc" id="namespacesues__data_html_ada5a214d0c4d5da587baa5f8de1da6d9"><div class="ttname"><a href="namespacesues__data.html#ada5a214d0c4d5da587baa5f8de1da6d9">sues_data::soilmoistcap</a></div><div class="ttdeci">real(kind(1d0)) soilmoistcap</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a570d73b34ec4b42f6f6075640a282619"><div class="ttname"><a href="namespaceallocatearray.html#a570d73b34ec4b42f6f6075640a282619">allocatearray::bsoilsurf</a></div><div class="ttdeci">integer bsoilsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="namespacegis__data_html_a59a6c27dbdfd939e15369ac064221241"><div class="ttname"><a href="namespacegis__data.html#a59a6c27dbdfd939e15369ac064221241">gis_data::areazh</a></div><div class="ttdeci">real(kind(1d0)) areazh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespacesues__data_html_a3e74512061da577d1697d50324b5ea28"><div class="ttname"><a href="namespacesues__data.html#a3e74512061da577d1697d50324b5ea28">sues_data::runoff_per_interval</a></div><div class="ttdeci">real(kind(1d0)) runoff_per_interval</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aa072ff6c84e33695ad3f23bc7608a022"><div class="ttname"><a href="namespaceallocatearray.html#aa072ff6c84e33695ad3f23bc7608a022">allocatearray::mw_ind</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) mw_ind</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00324">LUMPS_Module_constants.f95:324</a></div></div>
<div class="ttc" id="namespacemod__z_html_ac1314dbe1ed7b4c92c501ced67f725c3"><div class="ttname"><a href="namespacemod__z.html#ac1314dbe1ed7b4c92c501ced67f725c3">mod_z::zzd</a></div><div class="ttdeci">real(kind(1d0)) zzd</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01198">LUMPS_Module_constants.f95:1198</a></div></div>
<div class="ttc" id="namespacesues__data_html_ae76235b1ac6a388886f63eb27a0905dd"><div class="ttname"><a href="namespacesues__data.html#ae76235b1ac6a388886f63eb27a0905dd">sues_data::h</a></div><div class="ttdeci">real(kind(1d0)) h</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespacedefaultnotused_html"><div class="ttname"><a href="namespacedefaultnotused.html">defaultnotused</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01137">LUMPS_Module_constants.f95:1137</a></div></div>
<div class="ttc" id="_s_u_e_w_s___c_o2_8f95_html_a3d08af1e9ac16a2e04534ba1a9018988"><div class="ttname"><a href="_s_u_e_w_s___c_o2_8f95.html#a3d08af1e9ac16a2e04534ba1a9018988">co2_anthro</a></div><div class="ttdeci">subroutine co2_anthro(id, ih, imin)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___c_o2_8f95_source.html#l00145">SUEWS_CO2.f95:145</a></div></div>
<div class="ttc" id="namespacesues__data_html_a678cac1e19ddb70f811693772c031f0c"><div class="ttname"><a href="namespacesues__data.html#a678cac1e19ddb70f811693772c031f0c">sues_data::resistsurf</a></div><div class="ttdeci">real(kind(1d0)) resistsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01384">LUMPS_Module_constants.f95:1384</a></div></div>
<div class="ttc" id="namespacedata__in_html_a8bc526d8d9a75c1ecef04817aac48046"><div class="ttname"><a href="namespacedata__in.html#a8bc526d8d9a75c1ecef04817aac48046">data_in::fc</a></div><div class="ttdeci">real(kind(1d0)) fc</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacegis__data_html_a2eab7550922ec226bac9160b71203e83"><div class="ttname"><a href="namespacegis__data.html#a2eab7550922ec226bac9160b71203e83">gis_data::evetreeh</a></div><div class="ttdeci">real(kind(1d0)) evetreeh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a414bbbb4213968c827d816bf384610ed"><div class="ttname"><a href="namespaceallocatearray.html#a414bbbb4213968c827d816bf384610ed">allocatearray::grasssurf</a></div><div class="ttdeci">integer grasssurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aa263d396297f85dc10ee06a484ffcde6"><div class="ttname"><a href="namespaceallocatearray.html#aa263d396297f85dc10ee06a484ffcde6">allocatearray::metforcingdata</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:,:), allocatable metforcingdata</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00103">LUMPS_Module_constants.f95:103</a></div></div>
<div class="ttc" id="namespacedata__in_html_a743440f75d11d6596e13e18b78d7f531"><div class="ttname"><a href="namespacedata__in.html#a743440f75d11d6596e13e18b78d7f531">data_in::tsurf</a></div><div class="ttdeci">real(kind(1d0)) tsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_abf271c3057b02dd9183e4442954c9577"><div class="ttname"><a href="namespacedata__in.html#abf271c3057b02dd9183e4442954c9577">data_in::avdens</a></div><div class="ttdeci">real(kind(1d0)) avdens</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacetime_html_a6c4033d0e3f01ba6ea142f00749d0e4e"><div class="ttname"><a href="namespacetime.html#a6c4033d0e3f01ba6ea142f00749d0e4e">time::iy_prev_t</a></div><div class="ttdeci">integer iy_prev_t</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01157">LUMPS_Module_constants.f95:1157</a></div></div>
<div class="ttc" id="namespaceinitial_html"><div class="ttname"><a href="namespaceinitial.html">initial</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00768">LUMPS_Module_constants.f95:768</a></div></div>
<div class="ttc" id="namespacedata__in_html_a3606d0dc641d4f68851d608bec320422"><div class="ttname"><a href="namespacedata__in.html#a3606d0dc641d4f68851d608bec320422">data_in::qf_sahp_heat</a></div><div class="ttdeci">real(kind(1d0)) qf_sahp_heat</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_a2d6b128b5a2c8b851ee4fdd38204a18f"><div class="ttname"><a href="namespacedata__in.html#a2d6b128b5a2c8b851ee4fdd38204a18f">data_in::diagqn</a></div><div class="ttdeci">integer diagqn</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ae1c8dcf595053e7c0c88f68acf975058"><div class="ttname"><a href="namespaceallocatearray.html#ae1c8dcf595053e7c0c88f68acf975058">allocatearray::qn1_ind</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) qn1_ind</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00299">LUMPS_Module_constants.f95:299</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a215dffcb1ced9f49787128f695cbf8d7"><div class="ttname"><a href="namespaceallocatearray.html#a215dffcb1ced9f49787128f695cbf8d7">allocatearray::changsnow</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) changsnow</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00324">LUMPS_Module_constants.f95:324</a></div></div>
<div class="ttc" id="namespacesues__data_html_a0fce415bc7210db0cfe37ded2d8c1ef5"><div class="ttname"><a href="namespacesues__data.html#a0fce415bc7210db0cfe37ded2d8c1ef5">sues_data::runoffwaterbody</a></div><div class="ttdeci">real(kind(1d0)) runoffwaterbody</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ac7b06ad52874f40a2c456863ffa3d262"><div class="ttname"><a href="namespaceallocatearray.html#ac7b06ad52874f40a2c456863ffa3d262">allocatearray::snowdens</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) snowdens</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00324">LUMPS_Module_constants.f95:324</a></div></div>
<div class="ttc" id="namespacemoist_html_aad393ebb822062a86d42176ac76b30ad"><div class="ttname"><a href="namespacemoist.html#aad393ebb822062a86d42176ac76b30ad">moist::vpd_hpa</a></div><div class="ttdeci">real(kind(1d0)) vpd_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacenarp__module_html_ac480c3115a6413b9e79770f601e68895"><div class="ttname"><a href="namespacenarp__module.html#ac480c3115a6413b9e79770f601e68895">narp_module::narp</a></div><div class="ttdeci">subroutine narp(DTIME, ZENITH_deg, kdown, Temp_C, RH, Press_hPa, qn1_obs, SnowAlb, AlbedoChoice, ldown_option, NetRadiationMethod, DiagQN, QSTARall, QSTAR_SF, QSTAR_S, kclear, KUPall, LDown, LUPall, fcld, TSURFall)</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___n_a_r_p__v3_8f95_source.html#l00051">LUMPS_NARP_v3.f95:51</a></div></div>
<div class="ttc" id="namespacesues__data_html_a6e2f669999914372fd2de922c917e6dc"><div class="ttname"><a href="namespacesues__data.html#a6e2f669999914372fd2de922c917e6dc">sues_data::halftimestep</a></div><div class="ttdeci">real(kind(1d0)) halftimestep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01287">LUMPS_Module_constants.f95:1287</a></div></div>
<div class="ttc" id="namespacedata__in_html_a2c6cba95e27ebb1dcb673c457b66325d"><div class="ttname"><a href="namespacedata__in.html#a2c6cba95e27ebb1dcb673c457b66325d">data_in::avrh</a></div><div class="ttdeci">real(kind(1d0)) avrh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacegis__data_html"><div class="ttname"><a href="namespacegis__data.html">gis_data</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01242">LUMPS_Module_constants.f95:1242</a></div></div>
<div class="ttc" id="namespacesues__data_html_a77243f6b1c7d2baecb0d13f5d98b4318"><div class="ttname"><a href="namespacesues__data.html#a77243f6b1c7d2baecb0d13f5d98b4318">sues_data::sp</a></div><div class="ttdeci">real(kind(1d0)) sp</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01398">LUMPS_Module_constants.f95:1398</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ae1fb990049408fe1fa4f557577937ed6"><div class="ttname"><a href="namespaceallocatearray.html#ae1fb990049408fe1fa4f557577937ed6">allocatearray::snowcalcswitch</a></div><div class="ttdeci">integer, dimension(nsurf) snowcalcswitch</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00351">LUMPS_Module_constants.f95:351</a></div></div>
<div class="ttc" id="namespacedata__in_html_a3bdf6ad52d92cd85f212cea607807601"><div class="ttname"><a href="namespacedata__in.html#a3bdf6ad52d92cd85f212cea607807601">data_in::qf_sahp</a></div><div class="ttdeci">real(kind(1d0)) qf_sahp</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedefaultnotused_html_a9ad6683bfdf839485292f0be53501f07"><div class="ttname"><a href="namespacedefaultnotused.html#a9ad6683bfdf839485292f0be53501f07">defaultnotused::nan</a></div><div class="ttdeci">real(kind(1d0)) nan</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01139">LUMPS_Module_constants.f95:1139</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ab6f942b1808c9a62a4628cbd9e7e34a1"><div class="ttname"><a href="namespaceallocatearray.html#ab6f942b1808c9a62a4628cbd9e7e34a1">allocatearray::wuprofa_tstep</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:), allocatable wuprofa_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00123">LUMPS_Module_constants.f95:123</a></div></div>
<div class="ttc" id="namespacesues__data_html_ae3375f2161517eabda778cd0642076c5"><div class="ttname"><a href="namespacesues__data.html#ae3375f2161517eabda778cd0642076c5">sues_data::rss</a></div><div class="ttdeci">real(kind(1d0)) rss</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01384">LUMPS_Module_constants.f95:1384</a></div></div>
<div class="ttc" id="namespacedata__in_html_a2ea729731f7651be567d3392e184bf47"><div class="ttname"><a href="namespacedata__in.html#a2ea729731f7651be567d3392e184bf47">data_in::rainmaxres</a></div><div class="ttdeci">real(kind(1d0)) rainmaxres</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00992">LUMPS_Module_constants.f95:992</a></div></div>
<div class="ttc" id="namespacegis__data_html_a092cc07d2d55535e1995ac1196dac36a"><div class="ttname"><a href="namespacegis__data.html#a092cc07d2d55535e1995ac1196dac36a">gis_data::vegfraction</a></div><div class="ttdeci">real(kind(1d0)) vegfraction</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespacesnowmod_html_a216f7ed83c0474b708443eddfa6c574e"><div class="ttname"><a href="namespacesnowmod.html#a216f7ed83c0474b708443eddfa6c574e">snowmod::swe</a></div><div class="ttdeci">real(kind(1d0)) swe</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a5a6ce5dda0d024d7333d95ba544f38c9"><div class="ttname"><a href="namespaceallocatearray.html#a5a6ce5dda0d024d7333d95ba544f38c9">allocatearray::pavsurf</a></div><div class="ttdeci">integer pavsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a7e6a4164edb43537d8e21816ee3e33e9"><div class="ttname"><a href="namespaceallocatearray.html#a7e6a4164edb43537d8e21816ee3e33e9">allocatearray::dataoutsnow</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:,:), allocatable dataoutsnow</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00111">LUMPS_Module_constants.f95:111</a></div></div>
<div class="ttc" id="namespacedata__in_html_a03109ad2e583af2eb4b59e2e95758a72"><div class="ttname"><a href="namespacedata__in.html#a03109ad2e583af2eb4b59e2e95758a72">data_in::fcld_obs</a></div><div class="ttdeci">real(kind(1d0)) fcld_obs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_a3c13cce56632f598e61b00bccdc94e4a"><div class="ttname"><a href="namespacedata__in.html#a3c13cce56632f598e61b00bccdc94e4a">data_in::fc_build</a></div><div class="ttdeci">real(kind(1d0)) fc_build</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html_af0fed458b1eefc0164c4ffb6d6e2d1a2"><div class="ttname"><a href="namespacesues__data.html#af0fed458b1eefc0164c4ffb6d6e2d1a2">sues_data::addimpervious</a></div><div class="ttdeci">real(kind(1d0)) addimpervious</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesues__data_html_af62ec721dfd084ec5bce9224750e1330"><div class="ttname"><a href="namespacesues__data.html#af62ec721dfd084ec5bce9224750e1330">sues_data::chsnow_per_interval</a></div><div class="ttdeci">real(kind(1d0)) chsnow_per_interval</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacegis__data_html_a9cc38462906e83260e293f5b447c4374"><div class="ttname"><a href="namespacegis__data.html#a9cc38462906e83260e293f5b447c4374">gis_data::veg_type</a></div><div class="ttdeci">integer veg_type</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01266">LUMPS_Module_constants.f95:1266</a></div></div>
<div class="ttc" id="namespacedata__in_html_a446b6dc73d9c2e2518917361d9b526b3"><div class="ttname"><a href="namespacedata__in.html#a446b6dc73d9c2e2518917361d9b526b3">data_in::fc_biogen</a></div><div class="ttdeci">real(kind(1d0)) fc_biogen</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a459c0f2a9b9bf9bf8924b97f81b774b6"><div class="ttname"><a href="namespaceallocatearray.html#a459c0f2a9b9bf9bf8924b97f81b774b6">allocatearray::conifsurf</a></div><div class="ttdeci">integer conifsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="namespacedata__in_html_ae8c7901bd4995fbdec3868c38d2101b1"><div class="ttname"><a href="namespacedata__in.html#ae8c7901bd4995fbdec3868c38d2101b1">data_in::wu_m3</a></div><div class="ttdeci">real(kind(1d0)) wu_m3</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a1b25f9c9a9281958b7ed21d0bb85dde1"><div class="ttname"><a href="namespaceallocatearray.html#a1b25f9c9a9281958b7ed21d0bb85dde1">allocatearray::c_gsg5</a></div><div class="ttdeci">integer c_gsg5</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00476">LUMPS_Module_constants.f95:476</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_abf62bf3e83784366ed95fdfaae1f1d92"><div class="ttname"><a href="namespaceallocatearray.html#abf62bf3e83784366ed95fdfaae1f1d92">allocatearray::c_gsth</a></div><div class="ttdeci">integer c_gsth</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00478">LUMPS_Module_constants.f95:478</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a0cad51c36be0d8e5f907e24f9c391e4e"><div class="ttname"><a href="namespaceallocatearray.html#a0cad51c36be0d8e5f907e24f9c391e4e">allocatearray::a2</a></div><div class="ttdeci">real(kind(1d0)) a2</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00318">LUMPS_Module_constants.f95:318</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a535874e25b1042564b17301e8d84147b"><div class="ttname"><a href="namespaceallocatearray.html#a535874e25b1042564b17301e8d84147b">allocatearray::laimax</a></div><div class="ttdeci">real(kind(1d0)), dimension(nvegsurf) laimax</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00270">LUMPS_Module_constants.f95:270</a></div></div>
<div class="ttc" id="namespacedata__in_html_ae2ab3d89e50ddafe5bdb6f79aeb6d690"><div class="ttname"><a href="namespacedata__in.html#ae2ab3d89e50ddafe5bdb6f79aeb6d690">data_in::runforgrid</a></div><div class="ttdeci">integer runforgrid</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01006">LUMPS_Module_constants.f95:1006</a></div></div>
<div class="ttc" id="namespacedata__in_html_a737780f5cf53c9f2d3048bbfface32cd"><div class="ttname"><a href="namespacedata__in.html#a737780f5cf53c9f2d3048bbfface32cd">data_in::e_mod</a></div><div class="ttdeci">real(kind(1d0)) e_mod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_a8ac4d9de71d52d8c39e04c59635a5e3c"><div class="ttname"><a href="namespacedata__in.html#a8ac4d9de71d52d8c39e04c59635a5e3c">data_in::avkdn</a></div><div class="ttdeci">real(kind(1d0)) avkdn</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacemod__z_html_a64eb68f633930155dd1415ee7f3e9d5c"><div class="ttname"><a href="namespacemod__z.html#a64eb68f633930155dd1415ee7f3e9d5c">mod_z::z</a></div><div class="ttdeci">real(kind(1d0)) z</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01198">LUMPS_Module_constants.f95:1198</a></div></div>
<div class="ttc" id="namespacedata__in_html_a39642f3fc927b3a4394dda8fef2c193b"><div class="ttname"><a href="namespacedata__in.html#a39642f3fc927b3a4394dda8fef2c193b">data_in::fc_photo</a></div><div class="ttdeci">real(kind(1d0)) fc_photo</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="_s_u_e_w_s___diagnostics_8f95_html_aebc4694f2c98d834f1b236f7b49cb4b7"><div class="ttname"><a href="_s_u_e_w_s___diagnostics_8f95.html#aebc4694f2c98d834f1b236f7b49cb4b7">diagsfc</a></div><div class="ttdeci">subroutine diagsfc(xSurf, xFlux, us, VegFraction, xDiag, opt)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___diagnostics_8f95_source.html#l00002">SUEWS_Diagnostics.f95:2</a></div></div>
<div class="ttc" id="namespacesues__data_html_a92f648948ca3627c9bc8442568c4bba1"><div class="ttname"><a href="namespacesues__data.html#a92f648948ca3627c9bc8442568c4bba1">sues_data::runofftowater</a></div><div class="ttdeci">real(kind(1d0)) runofftowater</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aeaa22bcbc221cc3e0ca82aa0ac739fd3"><div class="ttname"><a href="namespaceallocatearray.html#aeaa22bcbc221cc3e0ca82aa0ac739fd3">allocatearray::drain</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) drain</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00169">LUMPS_Module_constants.f95:169</a></div></div>
<div class="ttc" id="namespacedata__in_html_aa277445969a4533d0db8452d45164762"><div class="ttname"><a href="namespacedata__in.html#aa277445969a4533d0db8452d45164762">data_in::diagnose</a></div><div class="ttdeci">integer diagnose</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="_s_u_e_w_s__evap_8f95_html_abb65abdb24905224cba51fe03f61809c"><div class="ttname"><a href="_s_u_e_w_s__evap_8f95.html#abb65abdb24905224cba51fe03f61809c">evap_suews</a></div><div class="ttdeci">subroutine evap_suews(ity, state_is, WetThresh_is, capStore, numPM, s_hPa, psyc_hPa, ResistSurf, sp, ra, rb, tlv, rss, ev, qe)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s__evap_8f95_source.html#l00022">SUEWS_evap.f95:22</a></div></div>
<div class="ttc" id="namespacedata__in_html_ae21258de695f82699606f7ced498693d"><div class="ttname"><a href="namespacedata__in.html#ae21258de695f82699606f7ced498693d">data_in::qn1_s</a></div><div class="ttdeci">real(kind(1d0)) qn1_s</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html_aaec40541d3458d50a5e554aa1ca0848b"><div class="ttname"><a href="namespacesues__data.html#aaec40541d3458d50a5e554aa1ca0848b">sues_data::internalwateruse_h</a></div><div class="ttdeci">real(kind(1d0)) internalwateruse_h</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01411">LUMPS_Module_constants.f95:1411</a></div></div>
<div class="ttc" id="namespacemoist_html_ab898e28f0ece3e6a2c1852fd8fe61bc1"><div class="ttname"><a href="namespacemoist.html#ab898e28f0ece3e6a2c1852fd8fe61bc1">moist::s_hpa</a></div><div class="ttdeci">real(kind(1d0)) s_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacedata__in_html_ac93d21776972756112d04651ac3cbb22"><div class="ttname"><a href="namespacedata__in.html#ac93d21776972756112d04651ac3cbb22">data_in::snow_obs</a></div><div class="ttdeci">real(kind(1d0)) snow_obs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacemoist_html_a38df7531f904d511b341f35b56ab56f3"><div class="ttname"><a href="namespacemoist.html#a38df7531f904d511b341f35b56ab56f3">moist::sice_hpa</a></div><div class="ttdeci">real(kind(1d0)) sice_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aded55272c7c08e6a254c7a9d70546d69"><div class="ttname"><a href="namespaceallocatearray.html#aded55272c7c08e6a254c7a9d70546d69">allocatearray::maxconductance</a></div><div class="ttdeci">real(kind(1d0)), dimension(nvegsurf) maxconductance</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00271">LUMPS_Module_constants.f95:271</a></div></div>
<div class="ttc" id="namespacesues__data_html_a20b9d66de8207bb6709f620aebc98b17"><div class="ttname"><a href="namespacesues__data.html#a20b9d66de8207bb6709f620aebc98b17">sues_data::runoffpipes</a></div><div class="ttdeci">real(kind(1d0)) runoffpipes</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesues__data_html_abdb761c4b6b03cace33c5c54eb3607b2"><div class="ttname"><a href="namespacesues__data.html#abdb761c4b6b03cace33c5c54eb3607b2">sues_data::state_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) state_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacedata__in_html_a6cc0dbee756c4ddc20f395bd37f7ad8f"><div class="ttname"><a href="namespacedata__in.html#a6cc0dbee756c4ddc20f395bd37f7ad8f">data_in::solweiguse</a></div><div class="ttdeci">integer solweiguse</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespacedata__in_html_a333bca61a59b05a5a5db0c7bb9daa2b9"><div class="ttname"><a href="namespacedata__in.html#a333bca61a59b05a5a5db0c7bb9daa2b9">data_in::qh_obs</a></div><div class="ttdeci">real(kind(1d0)) qh_obs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a29c0ea0741af8fff0b282998c49da9a1"><div class="ttname"><a href="namespaceallocatearray.html#a29c0ea0741af8fff0b282998c49da9a1">allocatearray::qn1_s_store</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:), allocatable qn1_s_store</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00319">LUMPS_Module_constants.f95:319</a></div></div>
<div class="ttc" id="namespacedata__in_html_ad753c5f26f6cfaac607edf93d4c2dd1d"><div class="ttname"><a href="namespacedata__in.html#ad753c5f26f6cfaac607edf93d4c2dd1d">data_in::avu10_ms</a></div><div class="ttdeci">real(kind(1d0)) avu10_ms</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_a8afa15b03c067e57c570544bd5562ac1"><div class="ttname"><a href="namespacedata__in.html#a8afa15b03c067e57c570544bd5562ac1">data_in::fcld</a></div><div class="ttdeci">real(kind(1d0)) fcld</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html_a9d58cea1a78af7ae81ee097bde9e0ef4"><div class="ttname"><a href="namespacesues__data.html#a9d58cea1a78af7ae81ee097bde9e0ef4">sues_data::wuareagrass_m2</a></div><div class="ttdeci">real(kind(1d0)) wuareagrass_m2</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a7ded7a35772c822d536989835435a474"><div class="ttname"><a href="namespaceallocatearray.html#a7ded7a35772c822d536989835435a474">allocatearray::bulkalbedo</a></div><div class="ttdeci">real(kind(1d0)) bulkalbedo</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00287">LUMPS_Module_constants.f95:287</a></div></div>
<div class="ttc" id="namespacegis__data_html_a23e18e9f568ef5a47ed3b37826c9f7f3"><div class="ttname"><a href="namespacegis__data.html#a23e18e9f568ef5a47ed3b37826c9f7f3">gis_data::faibldg</a></div><div class="ttdeci">real(kind(1d0)) faibldg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a69cae8cc47b53e83d621a7abe318ff14"><div class="ttname"><a href="namespaceallocatearray.html#a69cae8cc47b53e83d621a7abe318ff14">allocatearray::c_gskmax</a></div><div class="ttdeci">integer c_gskmax</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00482">LUMPS_Module_constants.f95:482</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ad46985325048552753cfa81641ff8b0f"><div class="ttname"><a href="namespaceallocatearray.html#ad46985325048552753cfa81641ff8b0f">allocatearray::a1</a></div><div class="ttdeci">real(kind(1d0)) a1</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00318">LUMPS_Module_constants.f95:318</a></div></div>
<div class="ttc" id="namespacedata__in_html_ad77982daffd6bf19ea51d6635d9d2009"><div class="ttname"><a href="namespacedata__in.html#ad77982daffd6bf19ea51d6635d9d2009">data_in::fc_anthro</a></div><div class="ttdeci">real(kind(1d0)) fc_anthro</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html_ae467db694bf0c56a1afbee403a0d8907"><div class="ttname"><a href="namespacesues__data.html#ae467db694bf0c56a1afbee403a0d8907">sues_data::qeout</a></div><div class="ttdeci">real(kind(1d0)) qeout</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01398">LUMPS_Module_constants.f95:1398</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ae688a4f5497c961baf9c8eecae674ec4"><div class="ttname"><a href="namespaceallocatearray.html#ae688a4f5497c961baf9c8eecae674ec4">allocatearray::soilmoist</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) soilmoist</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00175">LUMPS_Module_constants.f95:175</a></div></div>
<div class="ttc" id="namespacemod__k_html"><div class="ttname"><a href="namespacemod__k.html">mod_k</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01168">LUMPS_Module_constants.f95:1168</a></div></div>
<div class="ttc" id="namespacedata__in_html_add17d78f3c3ee4dde8d1a3d9630068ca"><div class="ttname"><a href="namespacedata__in.html#add17d78f3c3ee4dde8d1a3d9630068ca">data_in::solweigpoi_out</a></div><div class="ttdeci">integer solweigpoi_out</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01006">LUMPS_Module_constants.f95:1006</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ab8971a61a031605df883466bf12f9c11"><div class="ttname"><a href="namespaceallocatearray.html#ab8971a61a031605df883466bf12f9c11">allocatearray::c_gsg6</a></div><div class="ttdeci">integer c_gsg6</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00477">LUMPS_Module_constants.f95:477</a></div></div>
<div class="ttc" id="_s_u_e_w_s__drain_8f95_html_ad457462534fc9fec206ac998199dcb8d"><div class="ttname"><a href="_s_u_e_w_s__drain_8f95.html#ad457462534fc9fec206ac998199dcb8d">drainage</a></div><div class="ttdeci">subroutine drainage(is, state_is, StorCap, DrainEq, DrainCoef1, DrainCoef2, nsh_real, drain_is)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s__drain_8f95_source.html#l00014">SUEWS_drain.f95:14</a></div></div>
<div class="ttc" id="namespacemoist_html_ac54b9750ff8d2f544e3706dc3c7ea73d"><div class="ttname"><a href="namespacemoist.html#ac54b9750ff8d2f544e3706dc3c7ea73d">moist::dq</a></div><div class="ttdeci">real(kind(1d0)) dq</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacemoist_html"><div class="ttname"><a href="namespacemoist.html">moist</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01219">LUMPS_Module_constants.f95:1219</a></div></div>
<div class="ttc" id="namespacedata__in_html_a7be43e97ab4efa32b57c8f6b6b5949b7"><div class="ttname"><a href="namespacedata__in.html#a7be43e97ab4efa32b57c8f6b6b5949b7">data_in::ldown</a></div><div class="ttdeci">real(kind(1d0)) ldown</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacegis__data_html_a16985ccbad5040769f8cd039103c4f15"><div class="ttname"><a href="namespacegis__data.html#a16985ccbad5040769f8cd039103c4f15">gis_data::veg_fr</a></div><div class="ttdeci">real(kind(1d0)) veg_fr</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespacedefaultnotused_html_afd5393d7b0bd5eadd9ebcf66bd974e0d"><div class="ttname"><a href="namespacedefaultnotused.html#afd5393d7b0bd5eadd9ebcf66bd974e0d">defaultnotused::notusedi</a></div><div class="ttdeci">integer notusedi</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01140">LUMPS_Module_constants.f95:1140</a></div></div>
<div class="ttc" id="namespacedata__in_html_a2d5ce0a221d7ee5c42ab2bdb3bf06a8b"><div class="ttname"><a href="namespacedata__in.html#a2d5ce0a221d7ee5c42ab2bdb3bf06a8b">data_in::anthropheatmethod</a></div><div class="ttdeci">integer anthropheatmethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespacedata__in_html_abc95201410a9b25f8d1d2d5a063302c3"><div class="ttname"><a href="namespacedata__in.html#abc95201410a9b25f8d1d2d5a063302c3">data_in::avu1</a></div><div class="ttdeci">real(kind(1d0)) avu1</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html_a7623dce80601c63b78d744b4a5036ad2"><div class="ttname"><a href="namespacesues__data.html#a7623dce80601c63b78d744b4a5036ad2">sues_data::l_mod</a></div><div class="ttdeci">real(kind(1d0)) l_mod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespacetime_html_a0985b09f5d79535bd56787cb3c82cfd0"><div class="ttname"><a href="namespacetime.html#a0985b09f5d79535bd56787cb3c82cfd0">time::dls</a></div><div class="ttdeci">integer dls</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01147">LUMPS_Module_constants.f95:1147</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a6bf4d6d59ed380463ac60fb9d4f382b6"><div class="ttname"><a href="namespaceallocatearray.html#a6bf4d6d59ed380463ac60fb9d4f382b6">allocatearray::ev_snow</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) ev_snow</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00324">LUMPS_Module_constants.f95:324</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a7d2779bd8ecaa17c3f07c18a936d2150"><div class="ttname"><a href="namespaceallocatearray.html#a7d2779bd8ecaa17c3f07c18a936d2150">allocatearray::qn1_s_av_store</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:), allocatable qn1_s_av_store</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00320">LUMPS_Module_constants.f95:320</a></div></div>
<div class="ttc" id="namespacedata__in_html_ab31fbd3fd9d4036fa930706c4de36397"><div class="ttname"><a href="namespacedata__in.html#ab31fbd3fd9d4036fa930706c4de36397">data_in::kclear</a></div><div class="ttdeci">real(kind(1d0)) kclear</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="_l_u_m_p_s___q_h_q_e_8f95_html_af6b781cbbc71c67d4bb5de9dcb066b01"><div class="ttname"><a href="_l_u_m_p_s___q_h_q_e_8f95.html#af6b781cbbc71c67d4bb5de9dcb066b01">lumps_qhqe</a></div><div class="ttdeci">subroutine lumps_qhqe(qn1, qf, qs, Qm, Temp_C, avcp, Press_hPa, lv_J_kg, tlv, DRAINRT, Precip, RainBucket, RainMaxRes, RAINCOVER, Veg_Fr, sfrVeg, laiDay, LAImax, LAImin, nsh_real, veg_type, snowUse, H_mod, E_mod, psyc_hPa, s_hPa, sIce_hpa, TempVeg)</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___q_h_q_e_8f95_source.html#l00011">LUMPS_QHQE.f95:11</a></div></div>
<div class="ttc" id="namespacedata__in_html_a43b72c0ea9c40a969cac5f758c240815"><div class="ttname"><a href="namespacedata__in.html#a43b72c0ea9c40a969cac5f758c240815">data_in::snowuse</a></div><div class="ttdeci">integer snowuse</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespacesolweig__module_html"><div class="ttname"><a href="namespacesolweig__module.html">solweig_module</a></div><div class="ttdef"><b>Definition:</b> <a href="_s_o_l_w_e_i_g__modules_8f95_source.html#l00029">SOLWEIG_modules.f95:29</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a8055e207eb40afdc658bde6493ab319e"><div class="ttname"><a href="namespaceallocatearray.html#a8055e207eb40afdc658bde6493ab319e">allocatearray::kkanohm</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) kkanohm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00372">LUMPS_Module_constants.f95:372</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_acd22f92a06f7e9a2a91426b3dc99fdb0"><div class="ttname"><a href="namespaceallocatearray.html#acd22f92a06f7e9a2a91426b3dc99fdb0">allocatearray::nsurf</a></div><div class="ttdeci">integer, parameter nsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00144">LUMPS_Module_constants.f95:144</a></div></div>
<div class="ttc" id="namespacedata__in_html_a1f542f63d48efee0cd1e356f9f3ea1cf"><div class="ttname"><a href="namespacedata__in.html#a1f542f63d48efee0cd1e356f9f3ea1cf">data_in::alt</a></div><div class="ttdeci">real(kind(1d0)) alt</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_af087b466573effc0552f0a3b2d367db3"><div class="ttname"><a href="namespaceallocatearray.html#af087b466573effc0552f0a3b2d367db3">allocatearray::albgrass</a></div><div class="ttdeci">real(kind(1d0)), dimension(0:ndays) albgrass</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00219">LUMPS_Module_constants.f95:219</a></div></div>
<div class="ttc" id="namespacesues__data_html_ade8fa0a70d4bdc01712ae9438602f21e"><div class="ttname"><a href="namespacesues__data.html#ade8fa0a70d4bdc01712ae9438602f21e">sues_data::sae</a></div><div class="ttdeci">real(kind(1d0)) sae</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01398">LUMPS_Module_constants.f95:1398</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ac17d9365b9163e951de7ce3f5fa21897"><div class="ttname"><a href="namespaceallocatearray.html#ac17d9365b9163e951de7ce3f5fa21897">allocatearray::a3</a></div><div class="ttdeci">real(kind(1d0)) a3</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00318">LUMPS_Module_constants.f95:318</a></div></div>
<div class="ttc" id="namespacesues__data_html_aa6d49b1ef69f02f3bd0334c0d50d9a30"><div class="ttname"><a href="namespacesues__data.html#aa6d49b1ef69f02f3bd0334c0d50d9a30">sues_data::irrfracdecid</a></div><div class="ttdeci">real(kind(1d0)) irrfracdecid</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01411">LUMPS_Module_constants.f95:1411</a></div></div>
<div class="ttc" id="namespacedata__in_html_a332530944dd5c37316f92c3c74350e83"><div class="ttname"><a href="namespacedata__in.html#a332530944dd5c37316f92c3c74350e83">data_in::zenith_deg</a></div><div class="ttdeci">real(kind(1d0)) zenith_deg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_a15dff170cc3ed5a26f5b095eebf80392"><div class="ttname"><a href="namespacedata__in.html#a15dff170cc3ed5a26f5b095eebf80392">data_in::qe</a></div><div class="ttdeci">real(kind(1d0)) qe</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_ade512e4aad4c64404e1c974241c965e7"><div class="ttname"><a href="namespacedata__in.html#ade512e4aad4c64404e1c974241c965e7">data_in::qh</a></div><div class="ttdeci">real(kind(1d0)) qh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacetime_html_a12b68236a1014f7a9cee2fac8b4aa5f0"><div class="ttname"><a href="namespacetime.html#a12b68236a1014f7a9cee2fac8b4aa5f0">time::id_prev_t</a></div><div class="ttdeci">integer id_prev_t</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01157">LUMPS_Module_constants.f95:1157</a></div></div>
<div class="ttc" id="namespacesues__data_html_a6aa0ce59c7eee4b94b9ee86ac5b555d0"><div class="ttname"><a href="namespacesues__data.html#a6aa0ce59c7eee4b94b9ee86ac5b555d0">sues_data::wu_evetr</a></div><div class="ttdeci">real(kind(1d0)) wu_evetr</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aa11ae08cca1b320e3e176e06ac0daa50"><div class="ttname"><a href="namespaceallocatearray.html#aa11ae08cca1b320e3e176e06ac0daa50">allocatearray::c_gstl</a></div><div class="ttdeci">integer c_gstl</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00479">LUMPS_Module_constants.f95:479</a></div></div>
<div class="ttc" id="namespacedata__in_html_a95db274f3821ba4b3b2799481c2484f7"><div class="ttname"><a href="namespacedata__in.html#a95db274f3821ba4b3b2799481c2484f7">data_in::albedochoice</a></div><div class="ttdeci">integer albedochoice</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00881">LUMPS_Module_constants.f95:881</a></div></div>
<div class="ttc" id="_s_u_e_w_s__water_use_8f95_html_a2de7209275154fbb61e2f22a1d4a1d38"><div class="ttname"><a href="_s_u_e_w_s__water_use_8f95.html#a2de7209275154fbb61e2f22a1d4a1d38">wateruse</a></div><div class="ttdeci">subroutine wateruse(nsh_real, SurfaceArea, sfr, IrrFracConif, IrrFracDecid, IrrFracGrass, DayofWeek_id, WUProfA_tstep, WUProfM_tstep, InternalWaterUse_h, HDD_id, WU_Day_id, WaterUseMethod, ConifSurf, DecidSurf, GrassSurf, NSH, it, imin, DLS, nsurf, OverUse, WUAreaEveTr_m2, WUAreaDecTr_m2, WUAreaGrass_m2, WUAreaTotal_m2, wu_EveTr, wu_DecTr, wu_Grass, wu_m3, int_wu, ext_wu)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s__water_use_8f95_source.html#l00047">SUEWS_waterUse.f95:47</a></div></div>
<div class="ttc" id="namespacedata__in_html_a4bb1b5c9961c3b92df299792352bed5b"><div class="ttname"><a href="namespacedata__in.html#a4bb1b5c9961c3b92df299792352bed5b">data_in::t2_c</a></div><div class="ttdeci">real(kind(1d0)) t2_c</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="_b_l_u_e_w_s___c_b_l_8f95_html_acde23a276c692f0ec2a493dc9720471c"><div class="ttname"><a href="_b_l_u_e_w_s___c_b_l_8f95.html#acde23a276c692f0ec2a493dc9720471c">cbl</a></div><div class="ttdeci">subroutine cbl(ifirst, iMB, Gridiv)</div><div class="ttdef"><b>Definition:</b> <a href="_b_l_u_e_w_s___c_b_l_8f95_source.html#l00009">BLUEWS_CBL.f95:9</a></div></div>
<div class="ttc" id="namespacesues__data_html_aafce3a183c34dd4df5268cdbfc8aea24"><div class="ttname"><a href="namespacesues__data.html#aafce3a183c34dd4df5268cdbfc8aea24">sues_data::ra</a></div><div class="ttdeci">real(kind(1d0)) ra</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespacedata__in_html_a56c3960c55d29dadfd4d6be5ec53cc3c"><div class="ttname"><a href="namespacedata__in.html#a56c3960c55d29dadfd4d6be5ec53cc3c">data_in::q2_gkg</a></div><div class="ttdeci">real(kind(1d0)) q2_gkg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html"><div class="ttname"><a href="namespacesues__data.html">sues_data</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01273">LUMPS_Module_constants.f95:1273</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ab660d7e4ca340b0b677a74ecb8bb34f4"><div class="ttname"><a href="namespaceallocatearray.html#ab660d7e4ca340b0b677a74ecb8bb34f4">allocatearray::lai</a></div><div class="ttdeci">real(kind(1d0)), dimension(-4:ndays, nvegsurf) lai</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00211">LUMPS_Module_constants.f95:211</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a91095edf69a936902a3586fe9ef958a3"><div class="ttname"><a href="namespaceallocatearray.html#a91095edf69a936902a3586fe9ef958a3">allocatearray::evap</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) evap</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00170">LUMPS_Module_constants.f95:170</a></div></div>
<div class="ttc" id="namespacesues__data_html_a56bf7a98188b09dfcd2c9daed991f1b0"><div class="ttname"><a href="namespacesues__data.html#a56bf7a98188b09dfcd2c9daed991f1b0">sues_data::runoffagimpervious_m3</a></div><div class="ttdeci">real(kind(1d0)) runoffagimpervious_m3</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a1c0a391fbf8e63a46d93cae2c6c11049"><div class="ttname"><a href="namespaceallocatearray.html#a1c0a391fbf8e63a46d93cae2c6c11049">allocatearray::soilstorecap</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) soilstorecap</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00190">LUMPS_Module_constants.f95:190</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_afbbcbdfd67c32839a537f74d1bc6ff5a"><div class="ttname"><a href="namespaceallocatearray.html#afbbcbdfd67c32839a537f74d1bc6ff5a">allocatearray::bldgsurf</a></div><div class="ttdeci">integer bldgsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="_s_u_e_w_s___c_o2_8f95_html_a32784914a86ccd9e508a6f20eff62b59"><div class="ttname"><a href="_s_u_e_w_s___c_o2_8f95.html#a32784914a86ccd9e508a6f20eff62b59">co2_biogen</a></div><div class="ttdeci">subroutine co2_biogen</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___c_o2_8f95_source.html#l00003">SUEWS_CO2.f95:3</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_abe02f0b83f99a74be1c1133b86872599"><div class="ttname"><a href="namespaceallocatearray.html#abe02f0b83f99a74be1c1133b86872599">allocatearray::lup_ind</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) lup_ind</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00296">LUMPS_Module_constants.f95:296</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a2c176341a882c22aab3f1b01844f4fa0"><div class="ttname"><a href="namespaceallocatearray.html#a2c176341a882c22aab3f1b01844f4fa0">allocatearray::chang</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) chang</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00168">LUMPS_Module_constants.f95:168</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a808db51d4a8ed78af7b4ea759da827a2"><div class="ttname"><a href="namespaceallocatearray.html#a808db51d4a8ed78af7b4ea759da827a2">allocatearray::ivconif</a></div><div class="ttdeci">integer ivconif</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="namespacedata__in_html_a491ee3189141ae36fd29fde5cc020b53"><div class="ttname"><a href="namespacedata__in.html#a491ee3189141ae36fd29fde5cc020b53">data_in::year</a></div><div class="ttdeci">real(kind(1d0)) year</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacegis__data_html_a33f200820c4bd251ccc75f2cf5ca8f04"><div class="ttname"><a href="namespacegis__data.html#a33f200820c4bd251ccc75f2cf5ca8f04">gis_data::nonwaterfraction</a></div><div class="ttdeci">real(kind(1d0)) nonwaterfraction</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespacesues__data_html_afa546047f4e8bd032736a6915fe1cffd"><div class="ttname"><a href="namespacesues__data.html#afa546047f4e8bd032736a6915fe1cffd">sues_data::soilstate</a></div><div class="ttdeci">real(kind(1d0)) soilstate</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesues__data_html_a1780a57f30571faa7263e9cd248a8dd0"><div class="ttname"><a href="namespacesues__data.html#a1780a57f30571faa7263e9cd248a8dd0">sues_data::aerodynamicresistancemethod</a></div><div class="ttdeci">integer aerodynamicresistancemethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01298">LUMPS_Module_constants.f95:1298</a></div></div>
<div class="ttc" id="_s_u_e_w_s___s_a_h_p_8f95_html_aee8fa1098c2995bf57f8bc65e5be7ed2"><div class="ttname"><a href="_s_u_e_w_s___s_a_h_p_8f95.html#aee8fa1098c2995bf57f8bc65e5be7ed2">sahp_2</a></div><div class="ttdeci">subroutine sahp_2(QF_o, QF_o_base, QF_o_heat, id, ih, imin)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___s_a_h_p_8f95_source.html#l00059">SUEWS_SAHP.f95:59</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a7d0c9b91506a6be29f8c45bbb9a0411c"><div class="ttname"><a href="namespaceallocatearray.html#a7d0c9b91506a6be29f8c45bbb9a0411c">allocatearray::waterdist</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf+1, nsurf-1) waterdist</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00193">LUMPS_Module_constants.f95:193</a></div></div>
<div class="ttc" id="namespacegis__data_html_a78a214dccb2ce0e8d532e514bd05927f"><div class="ttname"><a href="namespacegis__data.html#a78a214dccb2ce0e8d532e514bd05927f">gis_data::faievetree</a></div><div class="ttdeci">real(kind(1d0)) faievetree</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespacedata__in_html_ad5a6e580db1d91b3cbb617a2bbee8d93"><div class="ttname"><a href="namespacedata__in.html#ad5a6e580db1d91b3cbb617a2bbee8d93">data_in::ldown_obs</a></div><div class="ttdeci">real(kind(1d0)) ldown_obs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ac0727c70a30d09ad8597e7b6456b619f"><div class="ttname"><a href="namespaceallocatearray.html#ac0727c70a30d09ad8597e7b6456b619f">allocatearray::rss_nsurf</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) rss_nsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00180">LUMPS_Module_constants.f95:180</a></div></div>
<div class="ttc" id="namespacedata__in_html_af9683d39e50e85ff167afd46236c7643"><div class="ttname"><a href="namespacedata__in.html#af9683d39e50e85ff167afd46236c7643">data_in::lai_obs</a></div><div class="ttdeci">real(kind(1d0)) lai_obs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesnowmod_html_a269fc9eb4dcd8dc77888c370c046a3c2"><div class="ttname"><a href="namespacesnowmod.html#a269fc9eb4dcd8dc77888c370c046a3c2">snowmod::snowalb</a></div><div class="ttdeci">real(kind(1d0)) snowalb</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespacesnowmod_html_a8cda7b30a924d03ee30f2bde6c9e41bc"><div class="ttname"><a href="namespacesnowmod.html#a8cda7b30a924d03ee30f2bde6c9e41bc">snowmod::waterholdcapfrac</a></div><div class="ttdeci">real(kind(1d0)) waterholdcapfrac</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespacesues__data_html_a030c38cf6a2cc1b2121491399a0353a5"><div class="ttname"><a href="namespacesues__data.html#a030c38cf6a2cc1b2121491399a0353a5">sues_data::runoffagveg_m3</a></div><div class="ttdeci">real(kind(1d0)) runoffagveg_m3</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacemod__z_html"><div class="ttname"><a href="namespacemod__z.html">mod_z</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01197">LUMPS_Module_constants.f95:1197</a></div></div>
<div class="ttc" id="namespacedata__in_html_a71e2da70dfd1593a6a4770f164bcc146"><div class="ttname"><a href="namespacedata__in.html#a71e2da70dfd1593a6a4770f164bcc146">data_in::ity</a></div><div class="ttdeci">integer ity</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00881">LUMPS_Module_constants.f95:881</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a7a8427e580d0969440e13673f28c5104"><div class="ttname"><a href="namespaceallocatearray.html#a7a8427e580d0969440e13673f28c5104">allocatearray::sathydraulicconduct</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) sathydraulicconduct</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00188">LUMPS_Module_constants.f95:188</a></div></div>
<div class="ttc" id="namespacedata__in_html_a959499405172092dfb8d49b61bfec809"><div class="ttname"><a href="namespacedata__in.html#a959499405172092dfb8d49b61bfec809">data_in::rainbucket</a></div><div class="ttdeci">real(kind(1d0)) rainbucket</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00992">LUMPS_Module_constants.f95:992</a></div></div>
<div class="ttc" id="_s_u_e_w_s___snow_8f95_html_a2035fba82c9957964a34a3e537c5de1e"><div class="ttname"><a href="_s_u_e_w_s___snow_8f95.html#a2035fba82c9957964a34a3e537c5de1e">snowcalc</a></div><div class="ttdeci">subroutine snowcalc</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___snow_8f95_source.html#l00211">SUEWS_Snow.f95:211</a></div></div>
<div class="ttc" id="namespacedata__in_html_aaa77ae828595f5b1e1bec4237020dfbc"><div class="ttname"><a href="namespacedata__in.html#aaa77ae828595f5b1e1bec4237020dfbc">data_in::h_mod</a></div><div class="ttdeci">real(kind(1d0)) h_mod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html_aa2d35158f50e5437170a36712c99a891"><div class="ttname"><a href="namespacesues__data.html#aa2d35158f50e5437170a36712c99a891">sues_data::pin</a></div><div class="ttdeci">real(kind(1d0)) pin</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a66a859de2b0cea378b18814cdb0438ba"><div class="ttname"><a href="namespaceallocatearray.html#a66a859de2b0cea378b18814cdb0438ba">allocatearray::statelimit</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) statelimit</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00183">LUMPS_Module_constants.f95:183</a></div></div>
<div class="ttc" id="namespacedata__in_html_a2202e62dbdf6e4d935d472a09af97460"><div class="ttname"><a href="namespacedata__in.html#a2202e62dbdf6e4d935d472a09af97460">data_in::diagqs</a></div><div class="ttdeci">integer diagqs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespacetime_html_abc3475e9770d0639f41dad7382bcb6d0"><div class="ttname"><a href="namespacetime.html#abc3475e9770d0639f41dad7382bcb6d0">time::id</a></div><div class="ttdeci">integer id</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01147">LUMPS_Module_constants.f95:1147</a></div></div>
<div class="ttc" id="_s_u_e_w_s___s_a_h_p_8f95_html_a2afb7b9da3c248277f05791a04feb468"><div class="ttname"><a href="_s_u_e_w_s___s_a_h_p_8f95.html#a2afb7b9da3c248277f05791a04feb468">sahp_3</a></div><div class="ttdeci">subroutine sahp_3(QF_o, id, ih, imin)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___s_a_h_p_8f95_source.html#l00108">SUEWS_SAHP.f95:108</a></div></div>
<div class="ttc" id="namespacesues__data_html_a06a4500745768a4bcf4886312a028e0c"><div class="ttname"><a href="namespacesues__data.html#a06a4500745768a4bcf4886312a028e0c">sues_data::numpm</a></div><div class="ttdeci">real(kind(1d0)) numpm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01398">LUMPS_Module_constants.f95:1398</a></div></div>
<div class="ttc" id="_l_u_m_p_s__atmos__functions__stab_8f95_html_a1783dde883ce9c28084bad6ce0af4b7d"><div class="ttname"><a href="_l_u_m_p_s__atmos__functions__stab_8f95.html#a1783dde883ce9c28084bad6ce0af4b7d">stab_lumps</a></div><div class="ttdeci">subroutine stab_lumps(StabilityMethod, dectime, zzd, z0M, zdm, avU1, Temp_C, L, Tstar, USTAR, h, psim)</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s__atmos__functions__stab_8f95_source.html#l00031">LUMPS_atmos_functions_stab.f95:31</a></div></div>
<div class="ttc" id="namespacesues__data_html_a1848f093a3dd5ebdc1da775e9cda8509"><div class="ttname"><a href="namespacesues__data.html#a1848f093a3dd5ebdc1da775e9cda8509">sues_data::surf_chang_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) surf_chang_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceanohm__module_html_a12150b343f1a4a8c3210e499cb9db9d9"><div class="ttname"><a href="namespaceanohm__module.html#a12150b343f1a4a8c3210e499cb9db9d9">anohm_module::anohm</a></div><div class="ttdeci">subroutine anohm(qn1, qn1_store, qn1_av_store, MetForcingData_grid, moist_surf, alb, emis, cp, kk, ch, sfr, nsurf, nsh, AnthropHeatMethod, id, a1, a2, a3, qs)</div><div class="ttdoc">High level wrapper for AnOHM calculation. </div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___an_o_h_m_8f95_source.html#l00033">SUEWS_AnOHM.f95:33</a></div></div>
<div class="ttc" id="namespacesues__data_html_a79ed0c9098d69fcbc6ad9a95fddaf013"><div class="ttname"><a href="namespacesues__data.html#a79ed0c9098d69fcbc6ad9a95fddaf013">sues_data::ch_per_interval</a></div><div class="ttdeci">real(kind(1d0)) ch_per_interval</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="_s_u_e_w_s___daily_state_8f95_html_a29739ac43530dcb073d83e8c57f81778"><div class="ttname"><a href="_s_u_e_w_s___daily_state_8f95.html#a29739ac43530dcb073d83e8c57f81778">dailystate</a></div><div class="ttdeci">subroutine dailystate(Gridiv)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___daily_state_8f95_source.html#l00045">SUEWS_DailyState.f95:45</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a2aa940f81b7bfe5c4815dd2d15e5c734"><div class="ttname"><a href="namespaceallocatearray.html#a2aa940f81b7bfe5c4815dd2d15e5c734">allocatearray::snowdepth</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) snowdepth</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00324">LUMPS_Module_constants.f95:324</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a4f4900cf0725d3239c9973fc7c48e5ba"><div class="ttname"><a href="namespaceallocatearray.html#a4f4900cf0725d3239c9973fc7c48e5ba">allocatearray::ivgrass</a></div><div class="ttdeci">integer ivgrass</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="namespacedata__in_html_aaac1000f5b2d5c88466c307795518d4c"><div class="ttname"><a href="namespacedata__in.html#aaac1000f5b2d5c88466c307795518d4c">data_in::temp_c</a></div><div class="ttdeci">real(kind(1d0)) temp_c</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html_ab35a12f588d9dfb72d0ec039e806d3bb"><div class="ttname"><a href="namespacesues__data.html#ab35a12f588d9dfb72d0ec039e806d3bb">sues_data::psim</a></div><div class="ttdeci">real(kind(1d0)) psim</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespacesnowmod_html_a67018a3202a62ad0d4e7715dbfcf5e50"><div class="ttname"><a href="namespacesnowmod.html#a67018a3202a62ad0d4e7715dbfcf5e50">snowmod::fwh</a></div><div class="ttdeci">real(kind(1d0)) fwh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ad6779574483b9977e34962301653f997"><div class="ttname"><a href="namespaceallocatearray.html#ad6779574483b9977e34962301653f997">allocatearray::porosity</a></div><div class="ttdeci">real(kind(1d0)), dimension(0:ndays) porosity</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00215">LUMPS_Module_constants.f95:215</a></div></div>
<div class="ttc" id="namespacesues__data_html_a2553d0e5b7218422246f2078b379fed5"><div class="ttname"><a href="namespacesues__data.html#a2553d0e5b7218422246f2078b379fed5">sues_data::addveg</a></div><div class="ttdeci">real(kind(1d0)) addveg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_af79468bbe3d4485e8a4f27d33c674864"><div class="ttname"><a href="namespaceallocatearray.html#af79468bbe3d4485e8a4f27d33c674864">allocatearray::c_gss2</a></div><div class="ttdeci">integer c_gss2</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00481">LUMPS_Module_constants.f95:481</a></div></div>
<div class="ttc" id="namespaceanohm__module_html"><div class="ttname"><a href="namespaceanohm__module.html">anohm_module</a></div><div class="ttdoc">AnOHM: Analytical Objective Hysteresis Model. </div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___an_o_h_m_8f95_source.html#l00015">SUEWS_AnOHM.f95:15</a></div></div>
<div class="ttc" id="namespacesues__data_html_ab2dc1363710dd5d250384fe643279fd7"><div class="ttname"><a href="namespacesues__data.html#ab2dc1363710dd5d250384fe643279fd7">sues_data::pipecapacity</a></div><div class="ttdeci">real(kind(1d0)) pipecapacity</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespacesues__data_html_a3422c30d52ea500ca138d13670403a50"><div class="ttname"><a href="namespacesues__data.html#a3422c30d52ea500ca138d13670403a50">sues_data::ustar</a></div><div class="ttdeci">real(kind(1d0)) ustar</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespacetime_html_a9be08cae4e706325fe3524f4370754cc"><div class="ttname"><a href="namespacetime.html#a9be08cae4e706325fe3524f4370754cc">time::imin</a></div><div class="ttdeci">integer imin</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01147">LUMPS_Module_constants.f95:1147</a></div></div>
<div class="ttc" id="namespacemoist_html_a4572c899e5e83d9647c7ed9f16901c24"><div class="ttname"><a href="namespacemoist.html#a4572c899e5e83d9647c7ed9f16901c24">moist::tlv</a></div><div class="ttdeci">real(kind(1d0)) tlv</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacetime_html"><div class="ttname"><a href="namespacetime.html">time</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01146">LUMPS_Module_constants.f95:1146</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ac655e803ebc3ca4bbd2e53835293f4f2"><div class="ttname"><a href="namespaceallocatearray.html#ac655e803ebc3ca4bbd2e53835293f4f2">allocatearray::dataout</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:,:), allocatable dataout</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00108">LUMPS_Module_constants.f95:108</a></div></div>
<div class="ttc" id="namespacesnowmod_html_aa988f82274f056c6d2f7ed3d37457b24"><div class="ttname"><a href="namespacesnowmod.html#aa988f82274f056c6d2f7ed3d37457b24">snowmod::lvs_j_kg</a></div><div class="ttdeci">real(kind(1d0)) lvs_j_kg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a10d39115371a0bd3c9a9fc9d4bc7fb2f"><div class="ttname"><a href="namespaceallocatearray.html#a10d39115371a0bd3c9a9fc9d4bc7fb2f">allocatearray::chanohm</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) chanohm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00373">LUMPS_Module_constants.f95:373</a></div></div>
<div class="ttc" id="namespacesnowmod_html_a9c7d574d109596d16542b38123065e66"><div class="ttname"><a href="namespacesnowmod.html#a9c7d574d109596d16542b38123065e66">snowmod::snowremoval</a></div><div class="ttdeci">real(kind(1d0)), dimension(2) snowremoval</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01128">LUMPS_Module_constants.f95:1128</a></div></div>
<div class="ttc" id="namespacesues__data_html_a79ee74466d17ed05bb20f195934f383b"><div class="ttname"><a href="namespacesues__data.html#a79ee74466d17ed05bb20f195934f383b">sues_data::vdrc</a></div><div class="ttdeci">real(kind(1d0)) vdrc</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01398">LUMPS_Module_constants.f95:1398</a></div></div>
<div class="ttc" id="namespacesues__data_html_aa314ccdf6d41a3901fa922504f030203"><div class="ttname"><a href="namespacesues__data.html#aa314ccdf6d41a3901fa922504f030203">sues_data::addwaterbody</a></div><div class="ttdeci">real(kind(1d0)) addwaterbody</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacemoist_html_a86e17481beeffe41b498ff747fc52360"><div class="ttname"><a href="namespacemoist.html#a86e17481beeffe41b498ff747fc52360">moist::dens_dry</a></div><div class="ttdeci">real(kind(1d0)) dens_dry</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="_s_u_e_w_s___snow_8f95_html_ab4ce449365f2ed93c920c5629a3ca469"><div class="ttname"><a href="_s_u_e_w_s___snow_8f95.html#ab4ce449365f2ed93c920c5629a3ca469">meltheat</a></div><div class="ttdeci">subroutine meltheat</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___snow_8f95_source.html#l00023">SUEWS_Snow.f95:23</a></div></div>
<div class="ttc" id="namespacedata__in_html_a0abb9aefbb8c1dc5ac6ff2f770da7faa"><div class="ttname"><a href="namespacedata__in.html#a0abb9aefbb8c1dc5ac6ff2f770da7faa">data_in::azimuth</a></div><div class="ttdeci">real(kind(1d0)) azimuth</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacegis__data_html_a4f60c63599a3076e7b8ffabbcaa57405"><div class="ttname"><a href="namespacegis__data.html#a4f60c63599a3076e7b8ffabbcaa57405">gis_data::dectreeh</a></div><div class="ttdeci">real(kind(1d0)) dectreeh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespacesues__data_html_ac5a856a3cdf4ba0b3a9150f2a08bb13d"><div class="ttname"><a href="namespacesues__data.html#ac5a856a3cdf4ba0b3a9150f2a08bb13d">sues_data::runoffpipes_m3</a></div><div class="ttdeci">real(kind(1d0)) runoffpipes_m3</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ac2b3eb71556f66b5cb4a91b0b0e8d6d3"><div class="ttname"><a href="namespaceallocatearray.html#ac2b3eb71556f66b5cb4a91b0b0e8d6d3">allocatearray::albdectr</a></div><div class="ttdeci">real(kind(1d0)), dimension(0:ndays) albdectr</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00217">LUMPS_Module_constants.f95:217</a></div></div>
<div class="ttc" id="namespacesues__data_html_a90293da57db1b1a3a4bc0979d2005640"><div class="ttname"><a href="namespacesues__data.html#a90293da57db1b1a3a4bc0979d2005640">sues_data::rb</a></div><div class="ttdeci">real(kind(1d0)) rb</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesues__data_html_a15eb03975ee429099b923fc02a2577ca"><div class="ttname"><a href="namespacesues__data.html#a15eb03975ee429099b923fc02a2577ca">sues_data::runoff_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) runoff_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacedata__in_html_abc838b310998f8cef4246fd9d724e903"><div class="ttname"><a href="namespacedata__in.html#abc838b310998f8cef4246fd9d724e903">data_in::drainrt</a></div><div class="ttdeci">real(kind(1d0)) drainrt</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00992">LUMPS_Module_constants.f95:992</a></div></div>
<div class="ttc" id="namespacedata__in_html_a3c3027e7975cd18122a58ae965ee0f86"><div class="ttname"><a href="namespacedata__in.html#a3c3027e7975cd18122a58ae965ee0f86">data_in::laicalcyes</a></div><div class="ttdeci">integer laicalcyes</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00881">LUMPS_Module_constants.f95:881</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a55c401506715656db25c4f3ea8d44956"><div class="ttname"><a href="namespaceallocatearray.html#a55c401506715656db25c4f3ea8d44956">allocatearray::albevetr</a></div><div class="ttdeci">real(kind(1d0)), dimension(0:ndays) albevetr</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00218">LUMPS_Module_constants.f95:218</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a5780572b4c9bdc7bbf20e4ee9d72010e"><div class="ttname"><a href="namespaceallocatearray.html#a5780572b4c9bdc7bbf20e4ee9d72010e">allocatearray::emis</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) emis</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00285">LUMPS_Module_constants.f95:285</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ab4a2c7e53ba41245b200baa41aed6137"><div class="ttname"><a href="namespaceallocatearray.html#ab4a2c7e53ba41245b200baa41aed6137">allocatearray::ncolumnsdataoutsnow</a></div><div class="ttdeci">integer, parameter ncolumnsdataoutsnow</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00042">LUMPS_Module_constants.f95:42</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a243033c7c16c825a30417c6bd4ea9f4e"><div class="ttname"><a href="namespaceallocatearray.html#a243033c7c16c825a30417c6bd4ea9f4e">allocatearray::soildepth</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) soildepth</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00189">LUMPS_Module_constants.f95:189</a></div></div>
<div class="ttc" id="namespacesues__data_html_ac09560182eb4e8e83479a33c9ea2f52b"><div class="ttname"><a href="namespacesues__data.html#ac09560182eb4e8e83479a33c9ea2f52b">sues_data::irrfracgrass</a></div><div class="ttdeci">real(kind(1d0)) irrfracgrass</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01411">LUMPS_Module_constants.f95:1411</a></div></div>
<div class="ttc" id="namespacemod__z_html_afd15a8bab419b8b576ccd3fa639d546f"><div class="ttname"><a href="namespacemod__z.html#afd15a8bab419b8b576ccd3fa639d546f">mod_z::z0m</a></div><div class="ttdeci">real(kind(1d0)) z0m</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01198">LUMPS_Module_constants.f95:1198</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a7bc9ecd33459d391cf70ea0bb83dce0f"><div class="ttname"><a href="namespaceallocatearray.html#a7bc9ecd33459d391cf70ea0bb83dce0f">allocatearray::dayofweek</a></div><div class="ttdeci">integer, dimension(0:ndays, 3) dayofweek</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00260">LUMPS_Module_constants.f95:260</a></div></div>
<div class="ttc" id="namespacewherewhen_html"><div class="ttname"><a href="namespacewherewhen.html">wherewhen</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l02097">LUMPS_Module_constants.f95:2097</a></div></div>
<div class="ttc" id="_s_u_e_w_s___roughness_parameters_8f95_html_af045b298f2d6ed45fbb8ba93a81d9568"><div class="ttname"><a href="_s_u_e_w_s___roughness_parameters_8f95.html#af045b298f2d6ed45fbb8ba93a81d9568">roughnessparameters</a></div><div class="ttdeci">subroutine roughnessparameters(RoughLenMomMethod, nsurf, PavSurf, BldgSurf, WaterSurf, ConifSurf, BSoilSurf, DecidSurf, GrassSurf, sfr, areaZh, bldgH, EveTreeH, DecTreeH, porosity_id, FAIBldg, FAIEveTree, FAIDecTree, Z, planF, Zh, Z0m, Zdm, ZZD)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___roughness_parameters_8f95_source.html#l00026">SUEWS_RoughnessParameters.f95:26</a></div></div>
<div class="ttc" id="namespacedata__in_html_aade22df4a22fe3872701ac9b6f7fed21"><div class="ttname"><a href="namespacedata__in.html#aade22df4a22fe3872701ac9b6f7fed21">data_in::qs</a></div><div class="ttdeci">real(kind(1d0)) qs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_a9fcca4951f8282ad10df290f8a025387"><div class="ttname"><a href="namespacedata__in.html#a9fcca4951f8282ad10df290f8a025387">data_in::fc_traff</a></div><div class="ttdeci">real(kind(1d0)) fc_traff</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_af270ed598adad800b8338f7a0700183f"><div class="ttname"><a href="namespacedata__in.html#af270ed598adad800b8338f7a0700183f">data_in::qn1_sf</a></div><div class="ttdeci">real(kind(1d0)) qn1_sf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a70972d48cf32e2ae2f264134371657eb"><div class="ttname"><a href="namespaceallocatearray.html#a70972d48cf32e2ae2f264134371657eb">allocatearray::c_gsg3</a></div><div class="ttdeci">integer c_gsg3</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00474">LUMPS_Module_constants.f95:474</a></div></div>
<div class="ttc" id="namespacedata__in_html_a717a1dc537f7b213fc70eb8f51819542"><div class="ttname"><a href="namespacedata__in.html#a717a1dc537f7b213fc70eb8f51819542">data_in::qf_sahp_base</a></div><div class="ttdeci">real(kind(1d0)) qf_sahp_base</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_a8a79043a75a7cba200c72ec10044bcd3"><div class="ttname"><a href="namespacedata__in.html#a8a79043a75a7cba200c72ec10044bcd3">data_in::raincover</a></div><div class="ttdeci">real(kind(1d0)) raincover</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00992">LUMPS_Module_constants.f95:992</a></div></div>
<div class="ttc" id="namespacedata__in_html_ae357494342c4cf48a962c4361d7c4459"><div class="ttname"><a href="namespacedata__in.html#ae357494342c4cf48a962c4361d7c4459">data_in::qn1_obs</a></div><div class="ttdeci">real(kind(1d0)) qn1_obs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacetime_html_a7dd4adda8e1403aee1caa796036c7204"><div class="ttname"><a href="namespacetime.html#a7dd4adda8e1403aee1caa796036c7204">time::iy</a></div><div class="ttdeci">integer iy</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01147">LUMPS_Module_constants.f95:1147</a></div></div>
<div class="ttc" id="namespacesues__data_html_a2c84a8e635e90b198dc0fd4c93c51ba4"><div class="ttname"><a href="namespacesues__data.html#a2c84a8e635e90b198dc0fd4c93c51ba4">sues_data::additionalwater</a></div><div class="ttdeci">real(kind(1d0)) additionalwater</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ac4a521fdb896dece1a1412de6892e77c"><div class="ttname"><a href="namespaceallocatearray.html#ac4a521fdb896dece1a1412de6892e77c">allocatearray::stateout</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) stateout</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00178">LUMPS_Module_constants.f95:178</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_afddcfa297d34e2f62378a4de75940afb"><div class="ttname"><a href="namespaceallocatearray.html#afddcfa297d34e2f62378a4de75940afb">allocatearray::snowfrac</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) snowfrac</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00324">LUMPS_Module_constants.f95:324</a></div></div>
<div class="ttc" id="namespacemod__z_html_a85318ac2a4eb1313fc10432ff860214e"><div class="ttname"><a href="namespacemod__z.html#a85318ac2a4eb1313fc10432ff860214e">mod_z::zdm</a></div><div class="ttdeci">real(kind(1d0)) zdm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01198">LUMPS_Module_constants.f95:1198</a></div></div>
<div class="ttc" id="_s_u_e_w_s__translate_8f95_html_abf8ea565715e31244a76de2908c9fc4b"><div class="ttname"><a href="_s_u_e_w_s__translate_8f95.html#abf8ea565715e31244a76de2908c9fc4b">suews_translate</a></div><div class="ttdeci">subroutine suews_translate(Gridiv, ir, iMB)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s__translate_8f95_source.html#l00037">SUEWS_translate.f95:37</a></div></div>
<div class="ttc" id="namespacedata__in_html_a22f13004f0c25b6603cceb88897eaee5"><div class="ttname"><a href="namespacedata__in.html#a22f13004f0c25b6603cceb88897eaee5">data_in::xsmd</a></div><div class="ttdeci">real(kind(1d0)) xsmd</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesues__data_html_ac93567a8ca56d05105523626613f5cc4"><div class="ttname"><a href="namespacesues__data.html#ac93567a8ca56d05105523626613f5cc4">sues_data::surpluswaterbody</a></div><div class="ttdeci">real(kind(1d0)) surpluswaterbody</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesues__data_html_affbedb6f34d747605bf529fd2d80d4c7"><div class="ttname"><a href="namespacesues__data.html#affbedb6f34d747605bf529fd2d80d4c7">sues_data::int_wu</a></div><div class="ttdeci">real(kind(1d0)) int_wu</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01411">LUMPS_Module_constants.f95:1411</a></div></div>
<div class="ttc" id="namespacesues__data_html_a2333d97226ad99ef4b17125ad7c3b205"><div class="ttname"><a href="namespacesues__data.html#a2333d97226ad99ef4b17125ad7c3b205">sues_data::qh_choice</a></div><div class="ttdeci">integer qh_choice</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01408">LUMPS_Module_constants.f95:1408</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a56dec28d9173b960574b82696b82f7a2"><div class="ttname"><a href="namespaceallocatearray.html#a56dec28d9173b960574b82696b82f7a2">allocatearray::runoffsoil</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) runoffsoil</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00172">LUMPS_Module_constants.f95:172</a></div></div>
<div class="ttc" id="namespacesues__data_html_a2a84935439f246e72f5de7bd752888f1"><div class="ttname"><a href="namespacesues__data.html#a2a84935439f246e72f5de7bd752888f1">sues_data::rasnow</a></div><div class="ttdeci">real(kind(1d0)) rasnow</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespacesues__data_html_a9dff10e1f001cc8241e5d1d72a4beeb2"><div class="ttname"><a href="namespacesues__data.html#a9dff10e1f001cc8241e5d1d72a4beeb2">sues_data::roughlenheatmethod</a></div><div class="ttdeci">integer roughlenheatmethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01290">LUMPS_Module_constants.f95:1290</a></div></div>
<div class="ttc" id="namespacesues__data_html_abc5b5ae18f30abb3a858e2e24e1e99d7"><div class="ttname"><a href="namespacesues__data.html#abc5b5ae18f30abb3a858e2e24e1e99d7">sues_data::runoffwaterbody_m3</a></div><div class="ttdeci">real(kind(1d0)) runoffwaterbody_m3</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="_s_u_e_w_s___horizontal_soil_water_8f95_html_aa5c24f37e4b3d33a10399364e652cab0"><div class="ttname"><a href="_s_u_e_w_s___horizontal_soil_water_8f95.html#aa5c24f37e4b3d33a10399364e652cab0">horizontalsoilwater</a></div><div class="ttdeci">subroutine horizontalsoilwater(nsurf, sfr, SoilStoreCap, SoilDepth, SatHydraulicConduct, SurfaceArea, NonWaterFraction, tstep_real, SoilMoist, runoffSoil, runoffSoil_per_tstep)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___horizontal_soil_water_8f95_source.html#l00019">SUEWS_HorizontalSoilWater.f95:19</a></div></div>
<div class="ttc" id="namespacesues__data_html_a879c9f9f7cf8597fe30edea62a95bcdd"><div class="ttname"><a href="namespacesues__data.html#a879c9f9f7cf8597fe30edea62a95bcdd">sues_data::ev</a></div><div class="ttdeci">real(kind(1d0)) ev</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01398">LUMPS_Module_constants.f95:1398</a></div></div>
<div class="ttc" id="namespacesues__data_html_a81a241a978fdd040dee716c4e68dc786"><div class="ttname"><a href="namespacesues__data.html#a81a241a978fdd040dee716c4e68dc786">sues_data::tstep_real</a></div><div class="ttdeci">real(kind(1d0)) tstep_real</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01283">LUMPS_Module_constants.f95:1283</a></div></div>
<div class="ttc" id="namespacesues__data_html_a9a093b62067234bd553e776c06ac4df9"><div class="ttname"><a href="namespacesues__data.html#a9a093b62067234bd553e776c06ac4df9">sues_data::nwstate_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) nwstate_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacedata__in_html_afff1f4919ba95d947fa5e34493cc9fa3"><div class="ttname"><a href="namespacedata__in.html#afff1f4919ba95d947fa5e34493cc9fa3">data_in::tempveg</a></div><div class="ttdeci">real(kind(1d0)) tempveg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00992">LUMPS_Module_constants.f95:992</a></div></div>
<div class="ttc" id="namespacegis__data_html_ae57a4a8a22280d3953006ba6e242c5be"><div class="ttname"><a href="namespacegis__data.html#ae57a4a8a22280d3953006ba6e242c5be">gis_data::faidectree</a></div><div class="ttdeci">real(kind(1d0)) faidectree</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a332b5e58530f77936db6b394822768c9"><div class="ttname"><a href="namespaceallocatearray.html#a332b5e58530f77936db6b394822768c9">allocatearray::smd_nsurfout</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) smd_nsurfout</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00174">LUMPS_Module_constants.f95:174</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ab3f65c4c4c46b200d0e63121b457d7c4"><div class="ttname"><a href="namespaceallocatearray.html#ab3f65c4c4c46b200d0e63121b457d7c4">allocatearray::laimin</a></div><div class="ttdeci">real(kind(1d0)), dimension(nvegsurf) laimin</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00269">LUMPS_Module_constants.f95:269</a></div></div>
<div class="ttc" id="namespacesues__data_html_aec92653b01eece5fbbb4f1cdfa3575cf"><div class="ttname"><a href="namespacesues__data.html#aec92653b01eece5fbbb4f1cdfa3575cf">sues_data::irrfracconif</a></div><div class="ttdeci">real(kind(1d0)) irrfracconif</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01411">LUMPS_Module_constants.f95:1411</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_abb987c3b35dd321963fd53d38f10236f"><div class="ttname"><a href="namespaceallocatearray.html#abb987c3b35dd321963fd53d38f10236f">allocatearray::nvegsurf</a></div><div class="ttdeci">integer, parameter nvegsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00145">LUMPS_Module_constants.f95:145</a></div></div>
<div class="ttc" id="namespacesues__data_html_a738f60744a0e91f90a050542ad946898"><div class="ttname"><a href="namespacesues__data.html#a738f60744a0e91f90a050542ad946898">sues_data::zh</a></div><div class="ttdeci">real(kind(1d0)) zh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ade77725040669c18c67ee2a4891b2711"><div class="ttname"><a href="namespaceallocatearray.html#ade77725040669c18c67ee2a4891b2711">allocatearray::wetthresh</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) wetthresh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00182">LUMPS_Module_constants.f95:182</a></div></div>
<div class="ttc" id="namespacesues__data_html_a08451f44609cb386788368a9136432c7"><div class="ttname"><a href="namespacesues__data.html#a08451f44609cb386788368a9136432c7">sues_data::qeforcbl</a></div><div class="ttdeci">real(kind(1d0)), dimension(:), allocatable qeforcbl</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01407">LUMPS_Module_constants.f95:1407</a></div></div>
<div class="ttc" id="namespacegis__data_html_aafb1e051dfaaf0a04760dc14acf4b053"><div class="ttname"><a href="namespacegis__data.html#aafb1e051dfaaf0a04760dc14acf4b053">gis_data::pervfraction</a></div><div class="ttdeci">real(kind(1d0)) pervfraction</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespacedata__in_html_a8676790950975f07daf8d24b503ef952"><div class="ttname"><a href="namespacedata__in.html#a8676790950975f07daf8d24b503ef952">data_in::fc_metab</a></div><div class="ttdeci">real(kind(1d0)) fc_metab</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="_s_o_l_w_e_i_g__2014a__core_8f95_html_a16c0a3ea3be2afe58b9d3308aa479d8f"><div class="ttname"><a href="_s_o_l_w_e_i_g__2014a__core_8f95.html#a16c0a3ea3be2afe58b9d3308aa479d8f">solweig_2014a_core</a></div><div class="ttdeci">subroutine solweig_2014a_core(iMBi)</div><div class="ttdef"><b>Definition:</b> <a href="_s_o_l_w_e_i_g__2014a__core_8f95_source.html#l00012">SOLWEIG_2014a_core.f95:12</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a21359b000cf1cea64f86412e4336b957"><div class="ttname"><a href="namespaceallocatearray.html#a21359b000cf1cea64f86412e4336b957">allocatearray::soilmoistold</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) soilmoistold</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00176">LUMPS_Module_constants.f95:176</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aef0f065addcafc27e8adbf9c9f9f867f"><div class="ttname"><a href="namespaceallocatearray.html#aef0f065addcafc27e8adbf9c9f9f867f">allocatearray::qn1_store</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:), allocatable qn1_store</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00319">LUMPS_Module_constants.f95:319</a></div></div>
<div class="ttc" id="namespacesues__data_html_a3b42551207483efdea0f50bba253afe4"><div class="ttname"><a href="namespacesues__data.html#a3b42551207483efdea0f50bba253afe4">sues_data::runoffsoil_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) runoffsoil_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesnowmod_html_a1d7e7d0b8974783e0320cde393e09594"><div class="ttname"><a href="namespacesnowmod.html#a1d7e7d0b8974783e0320cde393e09594">snowmod::qm</a></div><div class="ttdeci">real(kind(1d0)) qm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespacesues__data_html_ac73de7c829233718bfd143f4346adf70"><div class="ttname"><a href="namespacesues__data.html#ac73de7c829233718bfd143f4346adf70">sues_data::smd</a></div><div class="ttdeci">real(kind(1d0)) smd</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01384">LUMPS_Module_constants.f95:1384</a></div></div>
<div class="ttc" id="namespacedata__in_html_a4c71a7e3c5a99b333e25a1876a3968b1"><div class="ttname"><a href="namespacedata__in.html#a4c71a7e3c5a99b333e25a1876a3968b1">data_in::qsestm</a></div><div class="ttdeci">real(kind(1d0)) qsestm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aca62321fa80aef03d41d2ed66f3ade3a"><div class="ttname"><a href="namespaceallocatearray.html#aca62321fa80aef03d41d2ed66f3ade3a">allocatearray::deltaqi</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) deltaqi</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00324">LUMPS_Module_constants.f95:324</a></div></div>
<div class="ttc" id="namespaceallocatearray_html"><div class="ttname"><a href="namespaceallocatearray.html">allocatearray</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00016">LUMPS_Module_constants.f95:16</a></div></div>
<div class="ttc" id="namespacesues__data_html_a3dd16ee1aeeae265f322b0982f33a321"><div class="ttname"><a href="namespacesues__data.html#a3dd16ee1aeeae265f322b0982f33a321">sues_data::wuareadectr_m2</a></div><div class="ttdeci">real(kind(1d0)) wuareadectr_m2</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a417b9ff3eb6479963b494b8c50d661c2"><div class="ttname"><a href="namespaceallocatearray.html#a417b9ff3eb6479963b494b8c50d661c2">allocatearray::stateold</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) stateold</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00179">LUMPS_Module_constants.f95:179</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aae45e57c1b2d211392c5f98300524ee8"><div class="ttname"><a href="namespaceallocatearray.html#aae45e57c1b2d211392c5f98300524ee8">allocatearray::hdd</a></div><div class="ttdeci">real(kind(1d0)), dimension(-4:ndays, 6) hdd</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00209">LUMPS_Module_constants.f95:209</a></div></div>
<div class="ttc" id="namespacedata__in_html_a0baf7befb79fdeb3a9b4a5107f64d25c"><div class="ttname"><a href="namespacedata__in.html#a0baf7befb79fdeb3a9b4a5107f64d25c">data_in::cbluse</a></div><div class="ttdeci">integer cbluse</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespacesues__data_html_a96e76d9edd6c97fcdbc8f73047e189f3"><div class="ttname"><a href="namespacesues__data.html#a96e76d9edd6c97fcdbc8f73047e189f3">sues_data::drain_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) drain_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesues__data_html_aafb79a529ff89254c1399e96d77a5fe0"><div class="ttname"><a href="namespacesues__data.html#aafb79a529ff89254c1399e96d77a5fe0">sues_data::flowchange</a></div><div class="ttdeci">real(kind(1d0)) flowchange</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="_s_u_e_w_s___o_h_m_8f95_html_ab185f57c5ea6cf2099e1287a56748702"><div class="ttname"><a href="_s_u_e_w_s___o_h_m_8f95.html#ab185f57c5ea6cf2099e1287a56748702">ohm</a></div><div class="ttdeci">subroutine ohm(qn1, qn1_store, qn1_av_store, qn1_S, qn1_S_store, qn1_S_av_store, nsh, sfr, nsurf, HDDday, OHM_coef, OHM_threshSW, OHM_threshWD, soilmoist, soilstoreCap, state, BldgSurf, WaterSurf, SnowUse, SnowFrac, DiagQS, qs, deltaQi)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___o_h_m_8f95_source.html#l00024">SUEWS_OHM.f95:24</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a2b115354208d6b09535bda0cee499316"><div class="ttname"><a href="namespaceallocatearray.html#a2b115354208d6b09535bda0cee499316">allocatearray::c_gsg2</a></div><div class="ttdeci">integer c_gsg2</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00473">LUMPS_Module_constants.f95:473</a></div></div>
<div class="ttc" id="namespacemoist_html_a59a8f410cf3ebfe343d9c01b5dbb2cf8"><div class="ttname"><a href="namespacemoist.html#a59a8f410cf3ebfe343d9c01b5dbb2cf8">moist::lv_j_kg</a></div><div class="ttdeci">real(kind(1d0)) lv_j_kg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="_s_u_e_w_s___calculations_8f95_html_a178f1acf059ccbc65e48be6eb7f37baf"><div class="ttname"><a href="_s_u_e_w_s___calculations_8f95.html#a178f1acf059ccbc65e48be6eb7f37baf">suews_calculations</a></div><div class="ttdeci">subroutine suews_calculations(Gridiv, ir, iMB, irMax)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___calculations_8f95_source.html#l00036">SUEWS_Calculations.f95:36</a></div></div>
<div class="ttc" id="namespacesues__data_html_a56315a7303bf70155e92ead9b64493c2"><div class="ttname"><a href="namespacesues__data.html#a56315a7303bf70155e92ead9b64493c2">sues_data::wu_grass</a></div><div class="ttdeci">real(kind(1d0)) wu_grass</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespacesnowmod_html_ab1cf232aa719c4c447ac11c210889e66"><div class="ttname"><a href="namespacesnowmod.html#ab1cf232aa719c4c447ac11c210889e66">snowmod::zf</a></div><div class="ttdeci">real(kind(1d0)) zf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespacesues__data_html_a38a6478771abe06a6cf4334fe858c0ef"><div class="ttname"><a href="namespacesues__data.html#a38a6478771abe06a6cf4334fe858c0ef">sues_data::is</a></div><div class="ttdeci">integer is</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01295">LUMPS_Module_constants.f95:1295</a></div></div>
<div class="ttc" id="namespacedata__in_html_a7ee5c5c530300f6627f86b6cbde2d5b9"><div class="ttname"><a href="namespacedata__in.html#a7ee5c5c530300f6627f86b6cbde2d5b9">data_in::ldown_option</a></div><div class="ttdeci">integer ldown_option</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00893">LUMPS_Module_constants.f95:893</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ade39cdbf936049001075bb06589629d8"><div class="ttname"><a href="namespaceallocatearray.html#ade39cdbf936049001075bb06589629d8">allocatearray::c_gsg4</a></div><div class="ttdeci">integer c_gsg4</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00475">LUMPS_Module_constants.f95:475</a></div></div>
<div class="ttc" id="namespacedata__in_html_a7144dc07db9d95f72aedabd88c44bf99"><div class="ttname"><a href="namespacedata__in.html#a7144dc07db9d95f72aedabd88c44bf99">data_in::qh_r</a></div><div class="ttdeci">real(kind(1d0)) qh_r</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a24bcde513a65db1cd23573a243901f6a"><div class="ttname"><a href="namespaceallocatearray.html#a24bcde513a65db1cd23573a243901f6a">allocatearray::cpanohm</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) cpanohm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00371">LUMPS_Module_constants.f95:371</a></div></div>
<div class="ttc" id="namespacesues__data_html_ad2e4c4ffe627921b28183c9f4d8789fd"><div class="ttname"><a href="namespacesues__data.html#ad2e4c4ffe627921b28183c9f4d8789fd">sues_data::ext_wu</a></div><div class="ttdeci">real(kind(1d0)) ext_wu</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01411">LUMPS_Module_constants.f95:1411</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ae2de5706788fcce82e02bb4d8f512988"><div class="ttname"><a href="namespaceallocatearray.html#ae2de5706788fcce82e02bb4d8f512988">allocatearray::watersurf</a></div><div class="ttdeci">integer watersurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="namespacesues__data_html_a891cda3d0ef1f628e7dd9a185f00fc6c"><div class="ttname"><a href="namespacesues__data.html#a891cda3d0ef1f628e7dd9a185f00fc6c">sues_data::qhforcbl</a></div><div class="ttdeci">real(kind(1d0)), dimension(:), allocatable qhforcbl</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01407">LUMPS_Module_constants.f95:1407</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a5a9854768fde92cc3ec838f8729f5d42"><div class="ttname"><a href="namespaceallocatearray.html#a5a9854768fde92cc3ec838f8729f5d42">allocatearray::wu_day</a></div><div class="ttdeci">real(kind(1d0)), dimension(0:ndays, 9) wu_day</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00210">LUMPS_Module_constants.f95:210</a></div></div>
<div class="ttc" id="namespacedata__in_html_a306f10a44e3e8097152fc6a9c0403f6b"><div class="ttname"><a href="namespacedata__in.html#a306f10a44e3e8097152fc6a9c0403f6b">data_in::smdmethod</a></div><div class="ttdeci">integer smdmethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespacesues__data_html_ac2654954c97c2cbba667e51f44850250"><div class="ttname"><a href="namespacesues__data.html#ac2654954c97c2cbba667e51f44850250">sues_data::runoffagveg</a></div><div class="ttdeci">real(kind(1d0)) runoffagveg</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacedata__in_html_aa192321c93659ded79b2485baaa901b3"><div class="ttname"><a href="namespacedata__in.html#aa192321c93659ded79b2485baaa901b3">data_in::outinterval</a></div><div class="ttdeci">integer outinterval</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01006">LUMPS_Module_constants.f95:1006</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a01b956e9e6112af17136ffd957d4c481"><div class="ttname"><a href="namespaceallocatearray.html#a01b956e9e6112af17136ffd957d4c481">allocatearray::addwater</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) addwater</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00165">LUMPS_Module_constants.f95:165</a></div></div>
<div class="ttc" id="namespacedata__in_html_a27bd8e1db530bad815c128979003c184"><div class="ttname"><a href="namespacedata__in.html#a27bd8e1db530bad815c128979003c184">data_in::ohmincqf</a></div><div class="ttdeci">integer ohmincqf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a0c3675a79f0c6c3921beb95eb4d9d48f"><div class="ttname"><a href="namespaceallocatearray.html#a0c3675a79f0c6c3921beb95eb4d9d48f">allocatearray::snowpack</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) snowpack</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00349">LUMPS_Module_constants.f95:349</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a8b9a218b05df6fa11170f787d62e5ed4"><div class="ttname"><a href="namespaceallocatearray.html#a8b9a218b05df6fa11170f787d62e5ed4">allocatearray::ohm_threshsw</a></div><div class="ttdeci">real(kind(1d0)), dimension(9) ohm_threshsw</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00317">LUMPS_Module_constants.f95:317</a></div></div>
<div class="ttc" id="namespacedefaultnotused_html_abe169835df07a0da3ef05d9386ac49e8"><div class="ttname"><a href="namespacedefaultnotused.html#abe169835df07a0da3ef05d9386ac49e8">defaultnotused::pnan</a></div><div class="ttdeci">real(kind(1d0)) pnan</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01139">LUMPS_Module_constants.f95:1139</a></div></div>
<div class="ttc" id="namespacesues__data_html_a9d6a1e2ae7fe7c36fb4aaa9e2e3c2137"><div class="ttname"><a href="namespacesues__data.html#a9d6a1e2ae7fe7c36fb4aaa9e2e3c2137">sues_data::surfacearea</a></div><div class="ttdeci">real(kind(1d0)) surfacearea</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="_s_u_e_w_s___surface_resistance_8f95_html_a4da071a736ca3e2e388c9f1f3b3e6ea7"><div class="ttname"><a href="_s_u_e_w_s___surface_resistance_8f95.html#a4da071a736ca3e2e388c9f1f3b3e6ea7">surfaceresistance</a></div><div class="ttdeci">subroutine surfaceresistance(id, it, SMDMethod, ConifSurf, DecidSurf, GrassSurf, WaterSurf, snowFrac, sfr, nsurf, avkdn, Temp_C, dq, xsmd, vsmd, MaxConductance, LaiMax, lai_id, gsModel, Kmax, G1, G2, G3, G4, G5, G6, TH, TL, S1, S2, gsc, ResistSurf)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___surface_resistance_8f95_source.html#l00047">SUEWS_SurfaceResistance.f95:47</a></div></div>
<div class="ttc" id="namespacesues__data_html_adfce8b9e1538d8a1629df9963a7a6df0"><div class="ttname"><a href="namespacesues__data.html#adfce8b9e1538d8a1629df9963a7a6df0">sues_data::vsmd</a></div><div class="ttdeci">real(kind(1d0)) vsmd</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01384">LUMPS_Module_constants.f95:1384</a></div></div>
<div class="ttc" id="namespacedata__in_html_a5d6aae5bf11940a5ff7437dfec30cd4f"><div class="ttname"><a href="namespacedata__in.html#a5d6aae5bf11940a5ff7437dfec30cd4f">data_in::fc_respi</a></div><div class="ttdeci">real(kind(1d0)) fc_respi</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ad99e95bac5bad1e8fd7ae73daf74933e"><div class="ttname"><a href="namespaceallocatearray.html#ad99e95bac5bad1e8fd7ae73daf74933e">allocatearray::runoffsnow</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) runoffsnow</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00324">LUMPS_Module_constants.f95:324</a></div></div>
<div class="ttc" id="namespacedata__in_html_a3604b533bd06593307e185fbbee27efb"><div class="ttname"><a href="namespacedata__in.html#a3604b533bd06593307e185fbbee27efb">data_in::lng</a></div><div class="ttdeci">real(kind(1d0)) lng</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a138caba870c7f698f4b833e019b2c794"><div class="ttname"><a href="namespaceallocatearray.html#a138caba870c7f698f4b833e019b2c794">allocatearray::ohm_threshwd</a></div><div class="ttdeci">real(kind(1d0)), dimension(9) ohm_threshwd</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00317">LUMPS_Module_constants.f95:317</a></div></div>
<div class="ttc" id="namespacedata__in_html"><div class="ttname"><a href="namespacedata__in.html">data_in</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00813">LUMPS_Module_constants.f95:813</a></div></div>
<div class="ttc" id="namespacedata__in_html_a364ff1ce2a4c78ea431e4dacbd66d6b4"><div class="ttname"><a href="namespacedata__in.html#a364ff1ce2a4c78ea431e4dacbd66d6b4">data_in::lat</a></div><div class="ttdeci">real(kind(1d0)) lat</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a22ef94e8f1becc739e9945560050c844"><div class="ttname"><a href="namespaceallocatearray.html#a22ef94e8f1becc739e9945560050c844">allocatearray::sfr</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) sfr</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00161">LUMPS_Module_constants.f95:161</a></div></div>
<div class="ttc" id="_s_u_e_w_s__translate_8f95_html_a5c6d5265e5c9daebbaaff8999791406e"><div class="ttname"><a href="_s_u_e_w_s__translate_8f95.html#a5c6d5265e5c9daebbaaff8999791406e">suews_translateback</a></div><div class="ttdeci">subroutine suews_translateback(Gridiv, ir, irMax)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s__translate_8f95_source.html#l01152">SUEWS_translate.f95:1152</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aee67f7f4bcae37b7727fdeeb7570e7de"><div class="ttname"><a href="namespaceallocatearray.html#aee67f7f4bcae37b7727fdeeb7570e7de">allocatearray::c_gss1</a></div><div class="ttdeci">integer c_gss1</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00480">LUMPS_Module_constants.f95:480</a></div></div>
<div class="ttc" id="_s_u_e_w_s___s_a_h_p_8f95_html_ab568d02ff4d86576ac4294ee0d16a0d8"><div class="ttname"><a href="_s_u_e_w_s___s_a_h_p_8f95.html#ab568d02ff4d86576ac4294ee0d16a0d8">sahp_1</a></div><div class="ttdeci">subroutine sahp_1(QF_o, QF_o_base, QF_o_heat, id, ih, imin)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___s_a_h_p_8f95_source.html#l00021">SUEWS_SAHP.f95:21</a></div></div>
<div class="ttc" id="namespacesues__data_html_a08d117cca68ee0e84a8b286a038434c6"><div class="ttname"><a href="namespacesues__data.html#a08d117cca68ee0e84a8b286a038434c6">sues_data::surplusevap</a></div><div class="ttdeci">real(kind(1d0)), dimension(2) surplusevap</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01303">LUMPS_Module_constants.f95:1303</a></div></div>
<div class="ttc" id="namespacedefaultnotused_html_a71e2d536a1c83e98103c3ed183c303cd"><div class="ttname"><a href="namespacedefaultnotused.html#a71e2d536a1c83e98103c3ed183c303cd">defaultnotused::notused</a></div><div class="ttdeci">real(kind(1d0)) notused</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01139">LUMPS_Module_constants.f95:1139</a></div></div>
<div class="ttc" id="namespacedata__in_html_a0b433ad2361360f657c537b128e4a5f7"><div class="ttname"><a href="namespacedata__in.html#a0b433ad2361360f657c537b128e4a5f7">data_in::netradiationmethod</a></div><div class="ttdeci">integer netradiationmethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_adb237729df78f011f8ea814ee43f1703"><div class="ttname"><a href="namespaceallocatearray.html#adb237729df78f011f8ea814ee43f1703">allocatearray::wuprofm_tstep</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:), allocatable wuprofm_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00123">LUMPS_Module_constants.f95:123</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aa390fe06fd3fcecf38ff94ac0367e04c"><div class="ttname"><a href="namespaceallocatearray.html#aa390fe06fd3fcecf38ff94ac0367e04c">allocatearray::addwaterrunoff</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) addwaterrunoff</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00166">LUMPS_Module_constants.f95:166</a></div></div>
<div class="ttc" id="_s_u_e_w_s___aerodynamic_resistance_8f95_html_a04f1fea7666166223b4895686e96bcbf"><div class="ttname"><a href="_s_u_e_w_s___aerodynamic_resistance_8f95.html#a04f1fea7666166223b4895686e96bcbf">aerodynamicresistance</a></div><div class="ttdeci">subroutine aerodynamicresistance(ZZD, z0m, AVU1, L_mod, Ustar, VegFraction, AerodynamicResistanceMethod, StabilityMethod, RoughLenHeatMethod, RA)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___aerodynamic_resistance_8f95_source.html#l00015">SUEWS_AerodynamicResistance.f95:15</a></div></div>
<div class="ttc" id="namespacesues__data_html_a11bc80be13a121686d39d355d6c98aa9"><div class="ttname"><a href="namespacesues__data.html#a11bc80be13a121686d39d355d6c98aa9">sues_data::ev_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) ev_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesues__data_html_ab2070158f8b88b8f7835232841061718"><div class="ttname"><a href="namespacesues__data.html#ab2070158f8b88b8f7835232841061718">sues_data::nsh_real</a></div><div class="ttdeci">real(kind(1d0)) nsh_real</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01283">LUMPS_Module_constants.f95:1283</a></div></div>
<div class="ttc" id="namespacedata__in_html_ae0baee62dbc6ad6a70c51f5eb1c1882b"><div class="ttname"><a href="namespacedata__in.html#ae0baee62dbc6ad6a70c51f5eb1c1882b">data_in::roughlenmommethod</a></div><div class="ttdeci">integer roughlenmommethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="_s_u_e_w_s___e_s_t_m__v2016_8f95_html_a76f075c3b84d1ab8aac9844ba11dbd3e"><div class="ttname"><a href="_s_u_e_w_s___e_s_t_m__v2016_8f95.html#a76f075c3b84d1ab8aac9844ba11dbd3e">estm_v2016</a></div><div class="ttdeci">subroutine estm_v2016(QSnet, Gridiv, ir)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___e_s_t_m__v2016_8f95_source.html#l00003">SUEWS_ESTM_v2016.f95:3</a></div></div>
<div class="ttc" id="namespacedata__in_html_ab3b82014d0bd4e04ce70642a274dd0dc"><div class="ttname"><a href="namespacedata__in.html#ab3b82014d0bd4e04ce70642a274dd0dc">data_in::waterusemethod</a></div><div class="ttdeci">integer waterusemethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespacesues__data_html_a6d0dd8d535aa36ca406b9c4ba99caef6"><div class="ttname"><a href="namespacesues__data.html#a6d0dd8d535aa36ca406b9c4ba99caef6">sues_data::tstar</a></div><div class="ttdeci">real(kind(1d0)) tstar</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01373">LUMPS_Module_constants.f95:1373</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a1dcc99b13956867bdc2a58c234193a2e"><div class="ttname"><a href="namespaceallocatearray.html#a1dcc99b13956867bdc2a58c234193a2e">allocatearray::smd_nsurf</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) smd_nsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00173">LUMPS_Module_constants.f95:173</a></div></div>
<div class="ttc" id="namespacedata__in_html_a89bbf8e5d0059c1005799182e4f5f703"><div class="ttname"><a href="namespacedata__in.html#a89bbf8e5d0059c1005799182e4f5f703">data_in::qe_obs</a></div><div class="ttdeci">real(kind(1d0)) qe_obs</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_ae7c74e8cbd3c208e00306eafe50a98c0"><div class="ttname"><a href="namespacedata__in.html#ae7c74e8cbd3c208e00306eafe50a98c0">data_in::timezone</a></div><div class="ttdeci">real(kind(1d0)) timezone</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00904">LUMPS_Module_constants.f95:904</a></div></div>
<div class="ttc" id="namespacesnowmod_html_a35fe883b6ebd9767f44c27354160afd3"><div class="ttname"><a href="namespacesnowmod.html#a35fe883b6ebd9767f44c27354160afd3">snowmod::qmrain</a></div><div class="ttdeci">real(kind(1d0)) qmrain</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespacedata__in_html_aaacec9be1e147ab0d69fee857ecd57cd"><div class="ttname"><a href="namespacedata__in.html#aaacec9be1e147ab0d69fee857ecd57cd">data_in::rainres</a></div><div class="ttdeci">real(kind(1d0)) rainres</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00992">LUMPS_Module_constants.f95:992</a></div></div>
<div class="ttc" id="namespacesues__data_html_ac376fe6389c7367c307fce12d816009c"><div class="ttname"><a href="namespacesues__data.html#ac376fe6389c7367c307fce12d816009c">sues_data::runoffagimpervious</a></div><div class="ttdeci">real(kind(1d0)) runoffagimpervious</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacegis__data_html_a2a0cc85bf87fdf807e528acb5c7b0740"><div class="ttname"><a href="namespacegis__data.html#a2a0cc85bf87fdf807e528acb5c7b0740">gis_data::bldgh</a></div><div class="ttdeci">real(kind(1d0)) bldgh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01245">LUMPS_Module_constants.f95:1245</a></div></div>
<div class="ttc" id="namespacetime_html_a88a6c141593462330d65da0397b9b71d"><div class="ttname"><a href="namespacetime.html#a88a6c141593462330d65da0397b9b71d">time::it</a></div><div class="ttdeci">integer it</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01147">LUMPS_Module_constants.f95:1147</a></div></div>
<div class="ttc" id="namespacedata__in_html_a5d9f4f79563d2e000333219a4d2f4c99"><div class="ttname"><a href="namespacedata__in.html#a5d9f4f79563d2e000333219a4d2f4c99">data_in::kup</a></div><div class="ttdeci">real(kind(1d0)) kup</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesnowmod_html_affe56e4e5f1d5df5d7f4bbae7ae22541"><div class="ttname"><a href="namespacesnowmod.html#affe56e4e5f1d5df5d7f4bbae7ae22541">snowmod::mwstore</a></div><div class="ttdeci">real(kind(1d0)) mwstore</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespacemoist_html_a8a8d0c665be356954056ed6c102b953b"><div class="ttname"><a href="namespacemoist.html#a8a8d0c665be356954056ed6c102b953b">moist::psyc_hpa</a></div><div class="ttdeci">real(kind(1d0)) psyc_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacetime_html_acf0bd1b102769fcbe36a171b4b9e2a25"><div class="ttname"><a href="namespacetime.html#acf0bd1b102769fcbe36a171b4b9e2a25">time::dectime</a></div><div class="ttdeci">real(kind(1d0)) dectime</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01153">LUMPS_Module_constants.f95:1153</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a2949f0a79f6170fceeef0c4b023e219d"><div class="ttname"><a href="namespaceallocatearray.html#a2949f0a79f6170fceeef0c4b023e219d">allocatearray::surfacechar</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:), allocatable surfacechar</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00102">LUMPS_Module_constants.f95:102</a></div></div>
<div class="ttc" id="namespacedata__in_html_a13eb3e18ed56b78668ba6c47d11ba155"><div class="ttname"><a href="namespacedata__in.html#a13eb3e18ed56b78668ba6c47d11ba155">data_in::qf</a></div><div class="ttdeci">real(kind(1d0)) qf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ad49963261e823b38b1d9e6dad29978bd"><div class="ttname"><a href="namespaceallocatearray.html#ad49963261e823b38b1d9e6dad29978bd">allocatearray::alb</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) alb</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00284">LUMPS_Module_constants.f95:284</a></div></div>
<div class="ttc" id="namespacemoist_html_a19f55d056cfde820ca8beafe774a0688"><div class="ttname"><a href="namespacemoist.html#a19f55d056cfde820ca8beafe774a0688">moist::ea_hpa</a></div><div class="ttdeci">real(kind(1d0)) ea_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacesnowmod_html_adbb58215814d438f2486f880958737be"><div class="ttname"><a href="namespacesnowmod.html#adbb58215814d438f2486f880958737be">snowmod::qmfreez</a></div><div class="ttdeci">real(kind(1d0)) qmfreez</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ad5f385f647d84ed863fbfe5ae0754b28"><div class="ttname"><a href="namespaceallocatearray.html#ad5f385f647d84ed863fbfe5ae0754b28">allocatearray::qn1_av_store</a></div><div class="ttdeci">real(kind(1d0)), dimension(:,:), allocatable qn1_av_store</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00320">LUMPS_Module_constants.f95:320</a></div></div>
<div class="ttc" id="namespacesues__data_html_a087f298012279c621f24a283b360d592"><div class="ttname"><a href="namespacesues__data.html#a087f298012279c621f24a283b360d592">sues_data::wu_dectr</a></div><div class="ttdeci">real(kind(1d0)) wu_dectr</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespacemoist_html_ab97dbf8fcbd5d11d712712430254200c"><div class="ttname"><a href="namespacemoist.html#ab97dbf8fcbd5d11d712712430254200c">moist::avcp</a></div><div class="ttdeci">real(kind(1d0)) avcp</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacedata__in_html_a03eea39f7275fe19868636524b857b6d"><div class="ttname"><a href="namespacedata__in.html#a03eea39f7275fe19868636524b857b6d">data_in::press_hpa</a></div><div class="ttdeci">real(kind(1d0)) press_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a1573a7ac84781a2f33ba27e9b4fd7fc4"><div class="ttname"><a href="namespaceallocatearray.html#a1573a7ac84781a2f33ba27e9b4fd7fc4">allocatearray::state</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) state</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00177">LUMPS_Module_constants.f95:177</a></div></div>
<div class="ttc" id="namespacedata__in_html_a5a2c23ecc11fe337a954cca86be6e0ce"><div class="ttname"><a href="namespacedata__in.html#a5a2c23ecc11fe337a954cca86be6e0ce">data_in::lup</a></div><div class="ttdeci">real(kind(1d0)) lup</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacedata__in_html_aba572e9ad5577e14bcd393849b1fcdf3"><div class="ttname"><a href="namespacedata__in.html#aba572e9ad5577e14bcd393849b1fcdf3">data_in::storageheatmethod</a></div><div class="ttdeci">integer storageheatmethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00842">LUMPS_Module_constants.f95:842</a></div></div>
<div class="ttc" id="namespacesues__data_html_a1005846b0d388b51d731e6d5e404e2d6"><div class="ttname"><a href="namespacesues__data.html#a1005846b0d388b51d731e6d5e404e2d6">sues_data::stabilitymethod</a></div><div class="ttdeci">integer stabilitymethod</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01290">LUMPS_Module_constants.f95:1290</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_abf84199761d02e1a9304d1d7a2c00eba"><div class="ttname"><a href="namespaceallocatearray.html#abf84199761d02e1a9304d1d7a2c00eba">allocatearray::runoff</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) runoff</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00171">LUMPS_Module_constants.f95:171</a></div></div>
<div class="ttc" id="_s_u_e_w_s___b_l___resist_8f95_html_a1892d7a5ef6383934b4530b744268d15"><div class="ttname"><a href="_s_u_e_w_s___b_l___resist_8f95.html#a1892d7a5ef6383934b4530b744268d15">boundarylayerresistance</a></div><div class="ttdeci">subroutine boundarylayerresistance(zzd, z0M, avU1, USTAR, rb)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___b_l___resist_8f95_source.html#l00011">SUEWS_BL_Resist.f95:11</a></div></div>
<div class="ttc" id="namespacesues__data_html_a0aca98063df71052382d5ab58c2f0d19"><div class="ttname"><a href="namespacesues__data.html#a0aca98063df71052382d5ab58c2f0d19">sues_data::gsc</a></div><div class="ttdeci">real(kind(1d0)) gsc</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01384">LUMPS_Module_constants.f95:1384</a></div></div>
<div class="ttc" id="namespacesues__data_html_a82ac11b95b008fb43921aac3b503efad"><div class="ttname"><a href="namespacesues__data.html#a82ac11b95b008fb43921aac3b503efad">sues_data::tot_chang_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) tot_chang_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a73c64b6d041d6c9bb27a54bd87fcb9b9"><div class="ttname"><a href="namespaceallocatearray.html#a73c64b6d041d6c9bb27a54bd87fcb9b9">allocatearray::decidcap</a></div><div class="ttdeci">real(kind(1d0)), dimension(0:ndays) decidcap</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00214">LUMPS_Module_constants.f95:214</a></div></div>
<div class="ttc" id="namespacesues__data_html_a8506404b27e8b0ded77802f2ab475928"><div class="ttname"><a href="namespacesues__data.html#a8506404b27e8b0ded77802f2ab475928">sues_data::qe_per_tstep</a></div><div class="ttdeci">real(kind(1d0)) qe_per_tstep</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a7d7cb2bf89442acf85652779a9f82c2d"><div class="ttname"><a href="namespaceallocatearray.html#a7d7cb2bf89442acf85652779a9f82c2d">allocatearray::decidsurf</a></div><div class="ttdeci">integer decidsurf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00148">LUMPS_Module_constants.f95:148</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_ad56cceda5c3f4f010df2d55ce5a8e031"><div class="ttname"><a href="namespaceallocatearray.html#ad56cceda5c3f4f010df2d55ce5a8e031">allocatearray::kup_ind</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) kup_ind</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00293">LUMPS_Module_constants.f95:293</a></div></div>
<div class="ttc" id="namespacesues__data_html_a0489c46c970c2dd6ecdf0af0e11dee21"><div class="ttname"><a href="namespacesues__data.html#a0489c46c970c2dd6ecdf0af0e11dee21">sues_data::planf</a></div><div class="ttdeci">real(kind(1d0)) planf</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="_s_u_e_w_s___re_distribute_water_8f95_html_a7dd364785adedd079304b29447c701d3"><div class="ttname"><a href="_s_u_e_w_s___re_distribute_water_8f95.html#a7dd364785adedd079304b29447c701d3">redistributewater</a></div><div class="ttdeci">subroutine redistributewater(nsurf, WaterSurf, snowUse, WaterDist, sfr, Drain, AddWaterRunoff, addWater)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s___re_distribute_water_8f95_source.html#l00013">SUEWS_ReDistributeWater.f95:13</a></div></div>
<div class="ttc" id="namespacemoist_html_a86ab3b130c4af24cd94e0859a73c58e6"><div class="ttname"><a href="namespacemoist.html#a86ab3b130c4af24cd94e0859a73c58e6">moist::vpd_pa</a></div><div class="ttdeci">real(kind(1d0)) vpd_pa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="namespacemoist_html_a711adf6d19a4bb7b9a6c55d39dd5357b"><div class="ttname"><a href="namespacemoist.html#a711adf6d19a4bb7b9a6c55d39dd5357b">moist::es_hpa</a></div><div class="ttdeci">real(kind(1d0)) es_hpa</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01222">LUMPS_Module_constants.f95:1222</a></div></div>
<div class="ttc" id="_s_u_e_w_s__error_8f95_html_ac54090fb3ca221d8f45ec0a2a714e6c9"><div class="ttname"><a href="_s_u_e_w_s__error_8f95.html#ac54090fb3ca221d8f45ec0a2a714e6c9">errorhint</a></div><div class="ttdeci">subroutine errorhint(errh, ProblemFile, VALUE, value2, valueI)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s__error_8f95_source.html#l00002">SUEWS_error.f95:2</a></div></div>
<div class="ttc" id="namespacesues__data_html_ae3658e6cd4c5115a1a9f8ea57cf6f6b1"><div class="ttname"><a href="namespacesues__data.html#ae3658e6cd4c5115a1a9f8ea57cf6f6b1">sues_data::runoffsoil_per_interval</a></div><div class="ttdeci">real(kind(1d0)) runoffsoil_per_interval</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="_s_u_e_w_s__store_8f95_html_ab8fa354f6cb05440dc295f8d7f099306"><div class="ttname"><a href="_s_u_e_w_s__store_8f95.html#ab8fa354f6cb05440dc295f8d7f099306">soilstore</a></div><div class="ttdeci">subroutine soilstore(nsurf, is, PavSurf, BldgSurf, WaterSurf, ConifSurf, BSoilSurf, DecidSurf, GrassSurf, sfr, PipeCapacity, RunoffToWater, pin, wu_EveTr, wu_DecTr, wu_Grass, AddWater, addImpervious, nsh_real, stateOld, AddWaterRunoff, PervFraction, addVeg, soilstoreCap, addWaterBody, FlowChange, StateLimit, runoffAGimpervious, surplusWaterBody, runoffAGveg, runoffPipes, ev, soilmoist, SurplusEvap, runoffWaterBody, runoff_per_interval, p_mm, chang, runoff, drain, state)</div><div class="ttdef"><b>Definition:</b> <a href="_s_u_e_w_s__store_8f95_source.html#l00049">SUEWS_store.f95:49</a></div></div>
<div class="ttc" id="namespacesnowmod_html"><div class="ttname"><a href="namespacesnowmod.html">snowmod</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01093">LUMPS_Module_constants.f95:1093</a></div></div>
<div class="ttc" id="namespacedata__in_html_a7c4bf0a5d9721f577e74c835d3513036"><div class="ttname"><a href="namespacedata__in.html#a7c4bf0a5d9721f577e74c835d3513036">data_in::qn1_bup</a></div><div class="ttdeci">real(kind(1d0)) qn1_bup</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_aa455ec06de0d5f8b24b5a991a07b32c1"><div class="ttname"><a href="namespaceallocatearray.html#aa455ec06de0d5f8b24b5a991a07b32c1">allocatearray::ohm_coef</a></div><div class="ttdeci">real(kind(1d0)), dimension(9, 4, 3) ohm_coef</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00316">LUMPS_Module_constants.f95:316</a></div></div>
<div class="ttc" id="_n_a_r_p__sun__position__v2_8f95_html_a2b388ff5a9cd5447020b0ef32065c86b"><div class="ttname"><a href="_n_a_r_p__sun__position__v2_8f95.html#a2b388ff5a9cd5447020b0ef32065c86b">sun_position</a></div><div class="ttdeci">subroutine sun_position(year, idectime, UTC, locationlatitude, locationlongitude, locationaltitude, sunazimuth, sunzenith)</div><div class="ttdef"><b>Definition:</b> <a href="_n_a_r_p__sun__position__v2_8f95_source.html#l00002">NARP_sun_position_v2.f95:2</a></div></div>
<div class="ttc" id="namespacesues__data_html_a9ddcc1842e650815dfc06fa4a3bf6a78"><div class="ttname"><a href="namespacesues__data.html#a9ddcc1842e650815dfc06fa4a3bf6a78">sues_data::p_mm</a></div><div class="ttdeci">real(kind(1d0)) p_mm</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacenarp__module_html"><div class="ttname"><a href="namespacenarp__module.html">narp_module</a></div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___n_a_r_p__v3_8f95_source.html#l00001">LUMPS_NARP_v3.f95:1</a></div></div>
<div class="ttc" id="namespacesues__data_html_a167fa54ed7df9e23b3dac81232961fa3"><div class="ttname"><a href="namespacesues__data.html#a167fa54ed7df9e23b3dac81232961fa3">sues_data::wuareaevetr_m2</a></div><div class="ttdeci">real(kind(1d0)) wuareaevetr_m2</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespacedata__in_html_ae6fa09bb6b28e70653d0957e003b6f57"><div class="ttname"><a href="namespacedata__in.html#ae6fa09bb6b28e70653d0957e003b6f57">data_in::qn1</a></div><div class="ttdeci">real(kind(1d0)) qn1</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a0372ecc61cfb88ee683fac861aab87ac"><div class="ttname"><a href="namespaceallocatearray.html#a0372ecc61cfb88ee683fac861aab87ac">allocatearray::c_gsmodel</a></div><div class="ttdeci">integer c_gsmodel</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00483">LUMPS_Module_constants.f95:483</a></div></div>
<div class="ttc" id="namespacesues__data_html_ab28124e60c813d253c9b095050fe3ebe"><div class="ttname"><a href="namespacesues__data.html#ab28124e60c813d253c9b095050fe3ebe">sues_data::nsh</a></div><div class="ttdeci">integer nsh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01276">LUMPS_Module_constants.f95:1276</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a8ff59bff050fb421cbb0626422a102c6"><div class="ttname"><a href="namespaceallocatearray.html#a8ff59bff050fb421cbb0626422a102c6">allocatearray::tsurf_ind</a></div><div class="ttdeci">real(kind(1d0)), dimension(nsurf) tsurf_ind</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00290">LUMPS_Module_constants.f95:290</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a10397ddbe69224c2751100ffad7d60ed"><div class="ttname"><a href="namespaceallocatearray.html#a10397ddbe69224c2751100ffad7d60ed">allocatearray::c_gsg1</a></div><div class="ttdeci">integer c_gsg1</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00472">LUMPS_Module_constants.f95:472</a></div></div>
<div class="ttc" id="namespacesues__data_html_a58a8108dff93f602ad2ef840fef9395f"><div class="ttname"><a href="namespacesues__data.html#a58a8108dff93f602ad2ef840fef9395f">sues_data::addpipes</a></div><div class="ttdeci">real(kind(1d0)) addpipes</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespaceallocatearray_html_a9408900bed6c87ed095d2c688c1506a0"><div class="ttname"><a href="namespaceallocatearray.html#a9408900bed6c87ed095d2c688c1506a0">allocatearray::ncolumnsdataout</a></div><div class="ttdeci">integer, parameter ncolumnsdataout</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00042">LUMPS_Module_constants.f95:42</a></div></div>
<div class="ttc" id="namespacedata__in_html_affc86dfcf91974ff6d1768ff3b4406c3"><div class="ttname"><a href="namespacedata__in.html#affc86dfcf91974ff6d1768ff3b4406c3">data_in::precip</a></div><div class="ttdeci">real(kind(1d0)) precip</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l00908">LUMPS_Module_constants.f95:908</a></div></div>
<div class="ttc" id="namespacesnowmod_html_a7e8123e5b32bedfb676ea5c6ca62272a"><div class="ttname"><a href="namespacesnowmod.html#a7e8123e5b32bedfb676ea5c6ca62272a">snowmod::mwh</a></div><div class="ttdeci">real(kind(1d0)) mwh</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01096">LUMPS_Module_constants.f95:1096</a></div></div>
<div class="ttc" id="namespacesues__data_html_aa663cd30d361709a541de0a9d406557e"><div class="ttname"><a href="namespacesues__data.html#aa663cd30d361709a541de0a9d406557e">sues_data::overuse</a></div><div class="ttdeci">real(kind(1d0)) overuse</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01327">LUMPS_Module_constants.f95:1327</a></div></div>
<div class="ttc" id="namespacesues__data_html_a4145456981d7aaa8f5b19ab3ea5f1781"><div class="ttname"><a href="namespacesues__data.html#a4145456981d7aaa8f5b19ab3ea5f1781">sues_data::wuareatotal_m2</a></div><div class="ttdeci">real(kind(1d0)) wuareatotal_m2</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s___module__constants_8f95_source.html#l01307">LUMPS_Module_constants.f95:1307</a></div></div>
<div class="ttc" id="namespacesolweig__module_html_a466d8cf9dd423b05c00deaf1ac231f2c"><div class="ttname"><a href="namespacesolweig__module.html#a466d8cf9dd423b05c00deaf1ac231f2c">solweig_module::solweigcount</a></div><div class="ttdeci">integer solweigcount</div><div class="ttdef"><b>Definition:</b> <a href="_s_o_l_w_e_i_g__modules_8f95_source.html#l00046">SOLWEIG_modules.f95:46</a></div></div>
<div class="ttc" id="_l_u_m_p_s__atmos__functions__moist_8f95_html_ae6aae41b4a8fe866a54025d8fbc439d2"><div class="ttname"><a href="_l_u_m_p_s__atmos__functions__moist_8f95.html#ae6aae41b4a8fe866a54025d8fbc439d2">atmos_moist_lumps</a></div><div class="ttdeci">subroutine atmos_moist_lumps(Temp_C, Press_hPa, avRh, dectime, lv_J_kg, lvS_J_kg, es_hPa, Ea_hPa, VPd_hpa, VPD_Pa, dq, dens_dry, avcp, air_dens)</div><div class="ttdef"><b>Definition:</b> <a href="_l_u_m_p_s__atmos__functions__moist_8f95_source.html#l00017">LUMPS_atmos_functions_moist.f95:17</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
